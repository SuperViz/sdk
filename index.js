var SS=Object.create;var Wi=Object.defineProperty,TS=Object.defineProperties,Yd=Object.getOwnPropertyDescriptor,CS=Object.getOwnPropertyDescriptors,OS=Object.getOwnPropertyNames,ws=Object.getOwnPropertySymbols,wS=Object.getPrototypeOf,Lu=Object.prototype.hasOwnProperty,Qd=Object.prototype.propertyIsEnumerable;var Xd=Math.pow,qd=(s,t,n)=>t in s?Wi(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,dt=(s,t)=>{for(var n in t||(t={}))Lu.call(t,n)&&qd(s,n,t[n]);if(ws)for(var n of ws(t))Qd.call(t,n)&&qd(s,n,t[n]);return s},oe=(s,t)=>TS(s,CS(t));var Du=(s,t)=>{var n={};for(var i in s)Lu.call(s,i)&&t.indexOf(i)<0&&(n[i]=s[i]);if(s!=null&&ws)for(var i of ws(s))t.indexOf(i)<0&&Qd.call(s,i)&&(n[i]=s[i]);return n};var Nu=(s,t)=>()=>(s&&(t=s(s=0)),t);var me=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports),th=(s,t)=>{for(var n in t)Wi(s,n,{get:t[n],enumerable:!0})},IS=(s,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of OS(t))!Lu.call(s,o)&&o!==n&&Wi(s,o,{get:()=>t[o],enumerable:!(i=Yd(t,o))||i.enumerable});return s};var Pn=(s,t,n)=>(n=s!=null?SS(wS(s)):{},IS(t||!s||!s.__esModule?Wi(n,"default",{value:s,enumerable:!0}):n,s));var Ht=(s,t,n,i)=>{for(var o=i>1?void 0:i?Yd(t,n):t,l=s.length-1,c;l>=0;l--)(c=s[l])&&(o=(i?c(t,n,o):c(o))||o);return i&&o&&Wi(t,n,o),o};var Lt=(s,t,n)=>new Promise((i,o)=>{var l=f=>{try{u(n.next(f))}catch(m){o(m)}},c=f=>{try{u(n.throw(f))}catch(m){o(m)}},u=f=>f.done?i(f.value):Promise.resolve(f.value).then(l,c);u((n=n.apply(s,t)).next())});var tt,k=Nu(()=>{tt={}});var nh=me((HO,eh)=>{k();var Yr=1e3,Qr=Yr*60,Xr=Qr*60,dr=Xr*24,RS=dr*7,MS=dr*365.25;eh.exports=function(s,t){t=t||{};var n=typeof s;if(n==="string"&&s.length>0)return _S(s);if(n==="number"&&isFinite(s))return t.long?LS(s):PS(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function _S(s){if(s=String(s),!(s.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!!t){var n=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*MS;case"weeks":case"week":case"w":return n*RS;case"days":case"day":case"d":return n*dr;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Xr;case"minutes":case"minute":case"mins":case"min":case"m":return n*Qr;case"seconds":case"second":case"secs":case"sec":case"s":return n*Yr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function PS(s){var t=Math.abs(s);return t>=dr?Math.round(s/dr)+"d":t>=Xr?Math.round(s/Xr)+"h":t>=Qr?Math.round(s/Qr)+"m":t>=Yr?Math.round(s/Yr)+"s":s+"ms"}function LS(s){var t=Math.abs(s);return t>=dr?Ms(s,t,dr,"day"):t>=Xr?Ms(s,t,Xr,"hour"):t>=Qr?Ms(s,t,Qr,"minute"):t>=Yr?Ms(s,t,Yr,"second"):s+" ms"}function Ms(s,t,n,i){var o=t>=n*1.5;return Math.round(s/n)+" "+i+(o?"s":"")}});var ih=me((WO,rh)=>{k();function DS(s){n.debug=n,n.default=n,n.coerce=f,n.disable=l,n.enable=o,n.enabled=c,n.humanize=nh(),n.destroy=m,Object.keys(s).forEach(E=>{n[E]=s[E]}),n.names=[],n.skips=[],n.formatters={};function t(E){let O=0;for(let d=0;d<E.length;d++)O=(O<<5)-O+E.charCodeAt(d),O|=0;return n.colors[Math.abs(O)%n.colors.length]}n.selectColor=t;function n(E){let O,d=null,A,I;function M(...C){if(!M.enabled)return;let S=M,w=Number(new Date),p=w-(O||w);S.diff=p,S.prev=O,S.curr=w,O=w,C[0]=n.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let y=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(v,h)=>{if(v==="%%")return"%";y++;let T=n.formatters[h];if(typeof T=="function"){let x=C[y];v=T.call(S,x),C.splice(y,1),y--}return v}),n.formatArgs.call(S,C),(S.log||n.log).apply(S,C)}return M.namespace=E,M.useColors=n.useColors(),M.color=n.selectColor(E),M.extend=i,M.destroy=n.destroy,Object.defineProperty(M,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(A!==n.namespaces&&(A=n.namespaces,I=n.enabled(E)),I),set:C=>{d=C}}),typeof n.init=="function"&&n.init(M),M}function i(E,O){let d=n(this.namespace+(typeof O=="undefined"?":":O)+E);return d.log=this.log,d}function o(E){n.save(E),n.namespaces=E,n.names=[],n.skips=[];let O,d=(typeof E=="string"?E:"").split(/[\s,]+/),A=d.length;for(O=0;O<A;O++)!d[O]||(E=d[O].replace(/\*/g,".*?"),E[0]==="-"?n.skips.push(new RegExp("^"+E.slice(1)+"$")):n.names.push(new RegExp("^"+E+"$")))}function l(){let E=[...n.names.map(u),...n.skips.map(u).map(O=>"-"+O)].join(",");return n.enable(""),E}function c(E){if(E[E.length-1]==="*")return!0;let O,d;for(O=0,d=n.skips.length;O<d;O++)if(n.skips[O].test(E))return!1;for(O=0,d=n.names.length;O<d;O++)if(n.names[O].test(E))return!0;return!1}function u(E){return E.toString().substring(2,E.toString().length-2).replace(/\.\*\?$/,"*")}function f(E){return E instanceof Error?E.stack||E.message:E}function m(){}return n.enable(n.load()),n}rh.exports=DS});var Uu=me((Ke,_s)=>{k();Ke.formatArgs=FS;Ke.save=US;Ke.load=BS;Ke.useColors=NS;Ke.storage=kS();Ke.destroy=(()=>{let s=!1;return()=>{s||(s=!0)}})();Ke.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function NS(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function FS(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+_s.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;s.splice(1,0,t,"color: inherit");let n=0,i=0;s[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(n++,o==="%c"&&(i=n))}),s.splice(i,0,t)}Ke.log=console.debug||console.log||(()=>{});function US(s){try{s?Ke.storage.setItem("debug",s):Ke.storage.removeItem("debug")}catch(t){}}function BS(){let s;try{s=Ke.storage.getItem("debug")}catch(t){}return!s&&typeof process!="undefined"&&"env"in process&&(s=tt.DEBUG),s}function kS(){try{return localStorage}catch(s){}}_s.exports=ih()(Ke);var{formatters:GS}=_s.exports;GS.j=function(s){try{return JSON.stringify(s)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Ps=me(($O,sh)=>{k();function HS(s){var t=typeof s;return s!=null&&(t=="object"||t=="function")}sh.exports=HS});var uh=me((VO,ah)=>{k();var WS=typeof global=="object"&&global&&global.Object===Object&&global;ah.exports=WS});var Bu=me((jO,lh)=>{k();var zS=uh(),$S=typeof self=="object"&&self&&self.Object===Object&&self,VS=zS||$S||Function("return this")();lh.exports=VS});var fh=me((KO,ch)=>{k();var jS=Bu(),KS=function(){return jS.Date.now()};ch.exports=KS});var hh=me((JO,dh)=>{k();var JS=/\s/;function ZS(s){for(var t=s.length;t--&&JS.test(s.charAt(t)););return t}dh.exports=ZS});var mh=me((ZO,ph)=>{k();var qS=hh(),YS=/^\s+/;function QS(s){return s&&s.slice(0,qS(s)+1).replace(YS,"")}ph.exports=QS});var ku=me((qO,gh)=>{k();var XS=Bu(),tT=XS.Symbol;gh.exports=tT});var Eh=me((YO,bh)=>{k();var vh=ku(),yh=Object.prototype,eT=yh.hasOwnProperty,nT=yh.toString,ji=vh?vh.toStringTag:void 0;function rT(s){var t=eT.call(s,ji),n=s[ji];try{s[ji]=void 0;var i=!0}catch(l){}var o=nT.call(s);return i&&(t?s[ji]=n:delete s[ji]),o}bh.exports=rT});var Sh=me((QO,Ah)=>{k();var iT=Object.prototype,oT=iT.toString;function sT(s){return oT.call(s)}Ah.exports=sT});var wh=me((XO,Oh)=>{k();var Th=ku(),aT=Eh(),uT=Sh(),lT="[object Null]",cT="[object Undefined]",Ch=Th?Th.toStringTag:void 0;function fT(s){return s==null?s===void 0?cT:lT:Ch&&Ch in Object(s)?aT(s):uT(s)}Oh.exports=fT});var xh=me((t1,Ih)=>{k();function dT(s){return s!=null&&typeof s=="object"}Ih.exports=dT});var Mh=me((e1,Rh)=>{k();var hT=wh(),pT=xh(),mT="[object Symbol]";function gT(s){return typeof s=="symbol"||pT(s)&&hT(s)==mT}Rh.exports=gT});var Dh=me((n1,Lh)=>{k();var vT=mh(),_h=Ps(),yT=Mh(),Ph=0/0,bT=/^[-+]0x[0-9a-f]+$/i,ET=/^0b[01]+$/i,AT=/^0o[0-7]+$/i,ST=parseInt;function TT(s){if(typeof s=="number")return s;if(yT(s))return Ph;if(_h(s)){var t=typeof s.valueOf=="function"?s.valueOf():s;s=_h(t)?t+"":t}if(typeof s!="string")return s===0?s:+s;s=vT(s);var n=ET.test(s);return n||AT.test(s)?ST(s.slice(2),n?2:8):bT.test(s)?Ph:+s}Lh.exports=TT});var Uh=me((r1,Fh)=>{k();var CT=Ps(),Gu=fh(),Nh=Dh(),OT="Expected a function",wT=Math.max,IT=Math.min;function xT(s,t,n){var i,o,l,c,u,f,m=0,E=!1,O=!1,d=!0;if(typeof s!="function")throw new TypeError(OT);t=Nh(t)||0,CT(n)&&(E=!!n.leading,O="maxWait"in n,l=O?wT(Nh(n.maxWait)||0,t):l,d="trailing"in n?!!n.trailing:d);function A(v){var h=i,T=o;return i=o=void 0,m=v,c=s.apply(T,h),c}function I(v){return m=v,u=setTimeout(S,t),E?A(v):c}function M(v){var h=v-f,T=v-m,x=t-h;return O?IT(x,l-T):x}function C(v){var h=v-f,T=v-m;return f===void 0||h>=t||h<0||O&&T>=l}function S(){var v=Gu();if(C(v))return w(v);u=setTimeout(S,M(v))}function w(v){return u=void 0,d&&i?A(v):(i=o=void 0,c)}function p(){u!==void 0&&clearTimeout(u),m=0,i=f=o=u=void 0}function y(){return u===void 0?c:w(Gu())}function g(){var v=Gu(),h=C(v);if(i=arguments,o=this,f=v,h){if(u===void 0)return I(f);if(O)return clearTimeout(u),u=setTimeout(S,t),A(f)}return u===void 0&&(u=setTimeout(S,t)),c}return g.cancel=p,g.flush=y,g}Fh.exports=xT});var Hu=me((i1,Bh)=>{k();var RT=Uh(),MT=Ps(),_T="Expected a function";function PT(s,t,n){var i=!0,o=!0;if(typeof s!="function")throw new TypeError(_T);return MT(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),RT(s,t,{leading:i,maxWait:t,trailing:o})}Bh.exports=PT});var Ls=me((ti,Ki)=>{k();(function(){var s,t="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",u=500,f="__lodash_placeholder__",m=1,E=2,O=4,d=1,A=2,I=1,M=2,C=4,S=8,w=16,p=32,y=64,g=128,v=256,h=512,T=30,x="...",L=800,z=16,H=1,F=2,R=3,P=1/0,$=9007199254740991,W=17976931348623157e292,Z=0/0,et=4294967295,Y=et-1,G=et>>>1,N=[["ary",g],["bind",I],["bindKey",M],["curry",S],["curryRight",w],["flip",h],["partial",p],["partialRight",y],["rearg",v]],U="[object Arguments]",K="[object Array]",j="[object AsyncFunction]",nt="[object Boolean]",ct="[object Date]",Et="[object DOMException]",bt="[object Error]",_t="[object Function]",Kt="[object GeneratorFunction]",pt="[object Map]",Vt="[object Number]",Se="[object Null]",Xt="[object Object]",se="[object Promise]",Ne="[object Proxy]",X="[object RegExp]",ot="[object Set]",lt="[object String]",gt="[object Symbol]",Dt="[object Undefined]",ge="[object WeakMap]",er="[object WeakSet]",wi="[object ArrayBuffer]",Ur="[object DataView]",da="[object Float32Array]",ha="[object Float64Array]",pa="[object Int8Array]",ma="[object Int16Array]",ga="[object Int32Array]",va="[object Uint8Array]",ya="[object Uint8ClampedArray]",ba="[object Uint16Array]",Ea="[object Uint32Array]",zm=/\b__p \+= '';/g,$m=/\b(__p \+=) '' \+/g,Vm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ec=/&(?:amp|lt|gt|quot|#39);/g,Ac=/[&<>"']/g,jm=RegExp(Ec.source),Km=RegExp(Ac.source),Jm=/<%-([\s\S]+?)%>/g,Zm=/<%([\s\S]+?)%>/g,Sc=/<%=([\s\S]+?)%>/g,qm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ym=/^\w*$/,Qm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Aa=/[\\^$.*+?()[\]{}|]/g,Xm=RegExp(Aa.source),Sa=/^\s+/,tg=/\s/,eg=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ng=/\{\n\/\* \[wrapped with (.+)\] \*/,rg=/,? & /,ig=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,og=/[()=,{}\[\]\/\s]/,sg=/\\(\\)?/g,ag=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tc=/\w*$/,ug=/^[-+]0x[0-9a-f]+$/i,lg=/^0b[01]+$/i,cg=/^\[object .+?Constructor\]$/,fg=/^0o[0-7]+$/i,dg=/^(?:0|[1-9]\d*)$/,hg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bo=/($^)/,pg=/['\n\r\u2028\u2029\\]/g,ko="\\ud800-\\udfff",mg="\\u0300-\\u036f",gg="\\ufe20-\\ufe2f",vg="\\u20d0-\\u20ff",Cc=mg+gg+vg,Oc="\\u2700-\\u27bf",wc="a-z\\xdf-\\xf6\\xf8-\\xff",yg="\\xac\\xb1\\xd7\\xf7",bg="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Eg="\\u2000-\\u206f",Ag=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ic="A-Z\\xc0-\\xd6\\xd8-\\xde",xc="\\ufe0e\\ufe0f",Rc=yg+bg+Eg+Ag,Ta="['\u2019]",Sg="["+ko+"]",Mc="["+Rc+"]",Go="["+Cc+"]",_c="\\d+",Tg="["+Oc+"]",Pc="["+wc+"]",Lc="[^"+ko+Rc+_c+Oc+wc+Ic+"]",Ca="\\ud83c[\\udffb-\\udfff]",Cg="(?:"+Go+"|"+Ca+")",Dc="[^"+ko+"]",Oa="(?:\\ud83c[\\udde6-\\uddff]){2}",wa="[\\ud800-\\udbff][\\udc00-\\udfff]",Br="["+Ic+"]",Nc="\\u200d",Fc="(?:"+Pc+"|"+Lc+")",Og="(?:"+Br+"|"+Lc+")",Uc="(?:"+Ta+"(?:d|ll|m|re|s|t|ve))?",Bc="(?:"+Ta+"(?:D|LL|M|RE|S|T|VE))?",kc=Cg+"?",Gc="["+xc+"]?",wg="(?:"+Nc+"(?:"+[Dc,Oa,wa].join("|")+")"+Gc+kc+")*",Ig="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hc=Gc+kc+wg,Rg="(?:"+[Tg,Oa,wa].join("|")+")"+Hc,Mg="(?:"+[Dc+Go+"?",Go,Oa,wa,Sg].join("|")+")",_g=RegExp(Ta,"g"),Pg=RegExp(Go,"g"),Ia=RegExp(Ca+"(?="+Ca+")|"+Mg+Hc,"g"),Lg=RegExp([Br+"?"+Pc+"+"+Uc+"(?="+[Mc,Br,"$"].join("|")+")",Og+"+"+Bc+"(?="+[Mc,Br+Fc,"$"].join("|")+")",Br+"?"+Fc+"+"+Uc,Br+"+"+Bc,xg,Ig,_c,Rg].join("|"),"g"),Dg=RegExp("["+Nc+ko+Cc+xc+"]"),Ng=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ug=-1,ie={};ie[da]=ie[ha]=ie[pa]=ie[ma]=ie[ga]=ie[va]=ie[ya]=ie[ba]=ie[Ea]=!0,ie[U]=ie[K]=ie[wi]=ie[nt]=ie[Ur]=ie[ct]=ie[bt]=ie[_t]=ie[pt]=ie[Vt]=ie[Xt]=ie[X]=ie[ot]=ie[lt]=ie[ge]=!1;var ne={};ne[U]=ne[K]=ne[wi]=ne[Ur]=ne[nt]=ne[ct]=ne[da]=ne[ha]=ne[pa]=ne[ma]=ne[ga]=ne[pt]=ne[Vt]=ne[Xt]=ne[X]=ne[ot]=ne[lt]=ne[gt]=ne[va]=ne[ya]=ne[ba]=ne[Ea]=!0,ne[bt]=ne[_t]=ne[ge]=!1;var Bg={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},kg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Hg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Wg=parseFloat,zg=parseInt,Wc=typeof global=="object"&&global&&global.Object===Object&&global,$g=typeof self=="object"&&self&&self.Object===Object&&self,Te=Wc||$g||Function("return this")(),xa=typeof ti=="object"&&ti&&!ti.nodeType&&ti,nr=xa&&typeof Ki=="object"&&Ki&&!Ki.nodeType&&Ki,zc=nr&&nr.exports===xa,Ra=zc&&Wc.process,Ze=function(){try{var q=nr&&nr.require&&nr.require("util").types;return q||Ra&&Ra.binding&&Ra.binding("util")}catch(it){}}(),$c=Ze&&Ze.isArrayBuffer,Vc=Ze&&Ze.isDate,jc=Ze&&Ze.isMap,Kc=Ze&&Ze.isRegExp,Jc=Ze&&Ze.isSet,Zc=Ze&&Ze.isTypedArray;function He(q,it,rt){switch(rt.length){case 0:return q.call(it);case 1:return q.call(it,rt[0]);case 2:return q.call(it,rt[0],rt[1]);case 3:return q.call(it,rt[0],rt[1],rt[2])}return q.apply(it,rt)}function Vg(q,it,rt,mt){for(var wt=-1,Jt=q==null?0:q.length;++wt<Jt;){var ye=q[wt];it(mt,ye,rt(ye),q)}return mt}function qe(q,it){for(var rt=-1,mt=q==null?0:q.length;++rt<mt&&it(q[rt],rt,q)!==!1;);return q}function jg(q,it){for(var rt=q==null?0:q.length;rt--&&it(q[rt],rt,q)!==!1;);return q}function qc(q,it){for(var rt=-1,mt=q==null?0:q.length;++rt<mt;)if(!it(q[rt],rt,q))return!1;return!0}function kn(q,it){for(var rt=-1,mt=q==null?0:q.length,wt=0,Jt=[];++rt<mt;){var ye=q[rt];it(ye,rt,q)&&(Jt[wt++]=ye)}return Jt}function Ho(q,it){var rt=q==null?0:q.length;return!!rt&&kr(q,it,0)>-1}function Ma(q,it,rt){for(var mt=-1,wt=q==null?0:q.length;++mt<wt;)if(rt(it,q[mt]))return!0;return!1}function ae(q,it){for(var rt=-1,mt=q==null?0:q.length,wt=Array(mt);++rt<mt;)wt[rt]=it(q[rt],rt,q);return wt}function Gn(q,it){for(var rt=-1,mt=it.length,wt=q.length;++rt<mt;)q[wt+rt]=it[rt];return q}function _a(q,it,rt,mt){var wt=-1,Jt=q==null?0:q.length;for(mt&&Jt&&(rt=q[++wt]);++wt<Jt;)rt=it(rt,q[wt],wt,q);return rt}function Kg(q,it,rt,mt){var wt=q==null?0:q.length;for(mt&&wt&&(rt=q[--wt]);wt--;)rt=it(rt,q[wt],wt,q);return rt}function Pa(q,it){for(var rt=-1,mt=q==null?0:q.length;++rt<mt;)if(it(q[rt],rt,q))return!0;return!1}var Jg=La("length");function Zg(q){return q.split("")}function qg(q){return q.match(ig)||[]}function Yc(q,it,rt){var mt;return rt(q,function(wt,Jt,ye){if(it(wt,Jt,ye))return mt=Jt,!1}),mt}function Wo(q,it,rt,mt){for(var wt=q.length,Jt=rt+(mt?1:-1);mt?Jt--:++Jt<wt;)if(it(q[Jt],Jt,q))return Jt;return-1}function kr(q,it,rt){return it===it?uv(q,it,rt):Wo(q,Qc,rt)}function Yg(q,it,rt,mt){for(var wt=rt-1,Jt=q.length;++wt<Jt;)if(mt(q[wt],it))return wt;return-1}function Qc(q){return q!==q}function Xc(q,it){var rt=q==null?0:q.length;return rt?Na(q,it)/rt:Z}function La(q){return function(it){return it==null?s:it[q]}}function Da(q){return function(it){return q==null?s:q[it]}}function tf(q,it,rt,mt,wt){return wt(q,function(Jt,ye,te){rt=mt?(mt=!1,Jt):it(rt,Jt,ye,te)}),rt}function Qg(q,it){var rt=q.length;for(q.sort(it);rt--;)q[rt]=q[rt].value;return q}function Na(q,it){for(var rt,mt=-1,wt=q.length;++mt<wt;){var Jt=it(q[mt]);Jt!==s&&(rt=rt===s?Jt:rt+Jt)}return rt}function Fa(q,it){for(var rt=-1,mt=Array(q);++rt<q;)mt[rt]=it(rt);return mt}function Xg(q,it){return ae(it,function(rt){return[rt,q[rt]]})}function ef(q){return q&&q.slice(0,sf(q)+1).replace(Sa,"")}function We(q){return function(it){return q(it)}}function Ua(q,it){return ae(it,function(rt){return q[rt]})}function Ii(q,it){return q.has(it)}function nf(q,it){for(var rt=-1,mt=q.length;++rt<mt&&kr(it,q[rt],0)>-1;);return rt}function rf(q,it){for(var rt=q.length;rt--&&kr(it,q[rt],0)>-1;);return rt}function tv(q,it){for(var rt=q.length,mt=0;rt--;)q[rt]===it&&++mt;return mt}var ev=Da(Bg),nv=Da(kg);function rv(q){return"\\"+Hg[q]}function iv(q,it){return q==null?s:q[it]}function Gr(q){return Dg.test(q)}function ov(q){return Ng.test(q)}function sv(q){for(var it,rt=[];!(it=q.next()).done;)rt.push(it.value);return rt}function Ba(q){var it=-1,rt=Array(q.size);return q.forEach(function(mt,wt){rt[++it]=[wt,mt]}),rt}function of(q,it){return function(rt){return q(it(rt))}}function Hn(q,it){for(var rt=-1,mt=q.length,wt=0,Jt=[];++rt<mt;){var ye=q[rt];(ye===it||ye===f)&&(q[rt]=f,Jt[wt++]=rt)}return Jt}function zo(q){var it=-1,rt=Array(q.size);return q.forEach(function(mt){rt[++it]=mt}),rt}function av(q){var it=-1,rt=Array(q.size);return q.forEach(function(mt){rt[++it]=[mt,mt]}),rt}function uv(q,it,rt){for(var mt=rt-1,wt=q.length;++mt<wt;)if(q[mt]===it)return mt;return-1}function lv(q,it,rt){for(var mt=rt+1;mt--;)if(q[mt]===it)return mt;return mt}function Hr(q){return Gr(q)?fv(q):Jg(q)}function an(q){return Gr(q)?dv(q):Zg(q)}function sf(q){for(var it=q.length;it--&&tg.test(q.charAt(it)););return it}var cv=Da(Gg);function fv(q){for(var it=Ia.lastIndex=0;Ia.test(q);)++it;return it}function dv(q){return q.match(Ia)||[]}function hv(q){return q.match(Lg)||[]}var pv=function q(it){it=it==null?Te:Wn.defaults(Te.Object(),it,Wn.pick(Te,Fg));var rt=it.Array,mt=it.Date,wt=it.Error,Jt=it.Function,ye=it.Math,te=it.Object,ka=it.RegExp,mv=it.String,Ye=it.TypeError,$o=rt.prototype,gv=Jt.prototype,Wr=te.prototype,Vo=it["__core-js_shared__"],jo=gv.toString,Qt=Wr.hasOwnProperty,vv=0,af=function(){var e=/[^.]+$/.exec(Vo&&Vo.keys&&Vo.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ko=Wr.toString,yv=jo.call(te),bv=Te._,Ev=ka("^"+jo.call(Qt).replace(Aa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jo=zc?it.Buffer:s,zn=it.Symbol,Zo=it.Uint8Array,uf=Jo?Jo.allocUnsafe:s,qo=of(te.getPrototypeOf,te),lf=te.create,cf=Wr.propertyIsEnumerable,Yo=$o.splice,ff=zn?zn.isConcatSpreadable:s,xi=zn?zn.iterator:s,rr=zn?zn.toStringTag:s,Qo=function(){try{var e=ur(te,"defineProperty");return e({},"",{}),e}catch(r){}}(),Av=it.clearTimeout!==Te.clearTimeout&&it.clearTimeout,Sv=mt&&mt.now!==Te.Date.now&&mt.now,Tv=it.setTimeout!==Te.setTimeout&&it.setTimeout,Xo=ye.ceil,ts=ye.floor,Ga=te.getOwnPropertySymbols,Cv=Jo?Jo.isBuffer:s,df=it.isFinite,Ov=$o.join,wv=of(te.keys,te),be=ye.max,Me=ye.min,Iv=mt.now,xv=it.parseInt,hf=ye.random,Rv=$o.reverse,Ha=ur(it,"DataView"),Ri=ur(it,"Map"),Wa=ur(it,"Promise"),zr=ur(it,"Set"),Mi=ur(it,"WeakMap"),_i=ur(te,"create"),es=Mi&&new Mi,$r={},Mv=lr(Ha),_v=lr(Ri),Pv=lr(Wa),Lv=lr(zr),Dv=lr(Mi),ns=zn?zn.prototype:s,Pi=ns?ns.valueOf:s,pf=ns?ns.toString:s;function D(e){if(de(e)&&!It(e)&&!(e instanceof Gt)){if(e instanceof Qe)return e;if(Qt.call(e,"__wrapped__"))return md(e)}return new Qe(e)}var Vr=function(){function e(){}return function(r){if(!ue(r))return{};if(lf)return lf(r);e.prototype=r;var a=new e;return e.prototype=s,a}}();function rs(){}function Qe(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=s}D.templateSettings={escape:Jm,evaluate:Zm,interpolate:Sc,variable:"",imports:{_:D}},D.prototype=rs.prototype,D.prototype.constructor=D,Qe.prototype=Vr(rs.prototype),Qe.prototype.constructor=Qe;function Gt(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=et,this.__views__=[]}function Nv(){var e=new Gt(this.__wrapped__);return e.__actions__=Fe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Fe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Fe(this.__views__),e}function Fv(){if(this.__filtered__){var e=new Gt(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Uv(){var e=this.__wrapped__.value(),r=this.__dir__,a=It(e),b=r<0,_=a?e.length:0,B=Zy(0,_,this.__views__),V=B.start,J=B.end,Q=J-V,st=b?J:V-1,at=this.__iteratees__,ut=at.length,ft=0,vt=Me(Q,this.__takeCount__);if(!a||!b&&_==Q&&vt==Q)return Bf(e,this.__actions__);var Tt=[];t:for(;Q--&&ft<vt;){st+=r;for(var Nt=-1,Ct=e[st];++Nt<ut;){var kt=at[Nt],zt=kt.iteratee,Ve=kt.type,De=zt(Ct);if(Ve==F)Ct=De;else if(!De){if(Ve==H)continue t;break t}}Tt[ft++]=Ct}return Tt}Gt.prototype=Vr(rs.prototype),Gt.prototype.constructor=Gt;function ir(e){var r=-1,a=e==null?0:e.length;for(this.clear();++r<a;){var b=e[r];this.set(b[0],b[1])}}function Bv(){this.__data__=_i?_i(null):{},this.size=0}function kv(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function Gv(e){var r=this.__data__;if(_i){var a=r[e];return a===c?s:a}return Qt.call(r,e)?r[e]:s}function Hv(e){var r=this.__data__;return _i?r[e]!==s:Qt.call(r,e)}function Wv(e,r){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=_i&&r===s?c:r,this}ir.prototype.clear=Bv,ir.prototype.delete=kv,ir.prototype.get=Gv,ir.prototype.has=Hv,ir.prototype.set=Wv;function Tn(e){var r=-1,a=e==null?0:e.length;for(this.clear();++r<a;){var b=e[r];this.set(b[0],b[1])}}function zv(){this.__data__=[],this.size=0}function $v(e){var r=this.__data__,a=is(r,e);if(a<0)return!1;var b=r.length-1;return a==b?r.pop():Yo.call(r,a,1),--this.size,!0}function Vv(e){var r=this.__data__,a=is(r,e);return a<0?s:r[a][1]}function jv(e){return is(this.__data__,e)>-1}function Kv(e,r){var a=this.__data__,b=is(a,e);return b<0?(++this.size,a.push([e,r])):a[b][1]=r,this}Tn.prototype.clear=zv,Tn.prototype.delete=$v,Tn.prototype.get=Vv,Tn.prototype.has=jv,Tn.prototype.set=Kv;function Cn(e){var r=-1,a=e==null?0:e.length;for(this.clear();++r<a;){var b=e[r];this.set(b[0],b[1])}}function Jv(){this.size=0,this.__data__={hash:new ir,map:new(Ri||Tn),string:new ir}}function Zv(e){var r=gs(this,e).delete(e);return this.size-=r?1:0,r}function qv(e){return gs(this,e).get(e)}function Yv(e){return gs(this,e).has(e)}function Qv(e,r){var a=gs(this,e),b=a.size;return a.set(e,r),this.size+=a.size==b?0:1,this}Cn.prototype.clear=Jv,Cn.prototype.delete=Zv,Cn.prototype.get=qv,Cn.prototype.has=Yv,Cn.prototype.set=Qv;function or(e){var r=-1,a=e==null?0:e.length;for(this.__data__=new Cn;++r<a;)this.add(e[r])}function Xv(e){return this.__data__.set(e,c),this}function ty(e){return this.__data__.has(e)}or.prototype.add=or.prototype.push=Xv,or.prototype.has=ty;function un(e){var r=this.__data__=new Tn(e);this.size=r.size}function ey(){this.__data__=new Tn,this.size=0}function ny(e){var r=this.__data__,a=r.delete(e);return this.size=r.size,a}function ry(e){return this.__data__.get(e)}function iy(e){return this.__data__.has(e)}function oy(e,r){var a=this.__data__;if(a instanceof Tn){var b=a.__data__;if(!Ri||b.length<n-1)return b.push([e,r]),this.size=++a.size,this;a=this.__data__=new Cn(b)}return a.set(e,r),this.size=a.size,this}un.prototype.clear=ey,un.prototype.delete=ny,un.prototype.get=ry,un.prototype.has=iy,un.prototype.set=oy;function mf(e,r){var a=It(e),b=!a&&cr(e),_=!a&&!b&&Jn(e),B=!a&&!b&&!_&&Zr(e),V=a||b||_||B,J=V?Fa(e.length,mv):[],Q=J.length;for(var st in e)(r||Qt.call(e,st))&&!(V&&(st=="length"||_&&(st=="offset"||st=="parent")||B&&(st=="buffer"||st=="byteLength"||st=="byteOffset")||xn(st,Q)))&&J.push(st);return J}function gf(e){var r=e.length;return r?e[Xa(0,r-1)]:s}function sy(e,r){return vs(Fe(e),sr(r,0,e.length))}function ay(e){return vs(Fe(e))}function za(e,r,a){(a!==s&&!ln(e[r],a)||a===s&&!(r in e))&&On(e,r,a)}function Li(e,r,a){var b=e[r];(!(Qt.call(e,r)&&ln(b,a))||a===s&&!(r in e))&&On(e,r,a)}function is(e,r){for(var a=e.length;a--;)if(ln(e[a][0],r))return a;return-1}function uy(e,r,a,b){return $n(e,function(_,B,V){r(b,_,a(_),V)}),b}function vf(e,r){return e&&gn(r,Ce(r),e)}function ly(e,r){return e&&gn(r,Be(r),e)}function On(e,r,a){r=="__proto__"&&Qo?Qo(e,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[r]=a}function $a(e,r){for(var a=-1,b=r.length,_=rt(b),B=e==null;++a<b;)_[a]=B?s:Cu(e,r[a]);return _}function sr(e,r,a){return e===e&&(a!==s&&(e=e<=a?e:a),r!==s&&(e=e>=r?e:r)),e}function Xe(e,r,a,b,_,B){var V,J=r&m,Q=r&E,st=r&O;if(a&&(V=_?a(e,b,_,B):a(e)),V!==s)return V;if(!ue(e))return e;var at=It(e);if(at){if(V=Yy(e),!J)return Fe(e,V)}else{var ut=_e(e),ft=ut==_t||ut==Kt;if(Jn(e))return Hf(e,J);if(ut==Xt||ut==U||ft&&!_){if(V=Q||ft?{}:sd(e),!J)return Q?Gy(e,ly(V,e)):ky(e,vf(V,e))}else{if(!ne[ut])return _?e:{};V=Qy(e,ut,J)}}B||(B=new un);var vt=B.get(e);if(vt)return vt;B.set(e,V),Nd(e)?e.forEach(function(Ct){V.add(Xe(Ct,r,a,Ct,e,B))}):Ld(e)&&e.forEach(function(Ct,kt){V.set(kt,Xe(Ct,r,a,kt,e,B))});var Tt=st?Q?cu:lu:Q?Be:Ce,Nt=at?s:Tt(e);return qe(Nt||e,function(Ct,kt){Nt&&(kt=Ct,Ct=e[kt]),Li(V,kt,Xe(Ct,r,a,kt,e,B))}),V}function cy(e){var r=Ce(e);return function(a){return yf(a,e,r)}}function yf(e,r,a){var b=a.length;if(e==null)return!b;for(e=te(e);b--;){var _=a[b],B=r[_],V=e[_];if(V===s&&!(_ in e)||!B(V))return!1}return!0}function bf(e,r,a){if(typeof e!="function")throw new Ye(o);return Gi(function(){e.apply(s,a)},r)}function Di(e,r,a,b){var _=-1,B=Ho,V=!0,J=e.length,Q=[],st=r.length;if(!J)return Q;a&&(r=ae(r,We(a))),b?(B=Ma,V=!1):r.length>=n&&(B=Ii,V=!1,r=new or(r));t:for(;++_<J;){var at=e[_],ut=a==null?at:a(at);if(at=b||at!==0?at:0,V&&ut===ut){for(var ft=st;ft--;)if(r[ft]===ut)continue t;Q.push(at)}else B(r,ut,b)||Q.push(at)}return Q}var $n=jf(mn),Ef=jf(ja,!0);function fy(e,r){var a=!0;return $n(e,function(b,_,B){return a=!!r(b,_,B),a}),a}function os(e,r,a){for(var b=-1,_=e.length;++b<_;){var B=e[b],V=r(B);if(V!=null&&(J===s?V===V&&!$e(V):a(V,J)))var J=V,Q=B}return Q}function dy(e,r,a,b){var _=e.length;for(a=Pt(a),a<0&&(a=-a>_?0:_+a),b=b===s||b>_?_:Pt(b),b<0&&(b+=_),b=a>b?0:Ud(b);a<b;)e[a++]=r;return e}function Af(e,r){var a=[];return $n(e,function(b,_,B){r(b,_,B)&&a.push(b)}),a}function xe(e,r,a,b,_){var B=-1,V=e.length;for(a||(a=t0),_||(_=[]);++B<V;){var J=e[B];r>0&&a(J)?r>1?xe(J,r-1,a,b,_):Gn(_,J):b||(_[_.length]=J)}return _}var Va=Kf(),Sf=Kf(!0);function mn(e,r){return e&&Va(e,r,Ce)}function ja(e,r){return e&&Sf(e,r,Ce)}function ss(e,r){return kn(r,function(a){return Rn(e[a])})}function ar(e,r){r=jn(r,e);for(var a=0,b=r.length;e!=null&&a<b;)e=e[vn(r[a++])];return a&&a==b?e:s}function Tf(e,r,a){var b=r(e);return It(e)?b:Gn(b,a(e))}function Pe(e){return e==null?e===s?Dt:Se:rr&&rr in te(e)?Jy(e):a0(e)}function Ka(e,r){return e>r}function hy(e,r){return e!=null&&Qt.call(e,r)}function py(e,r){return e!=null&&r in te(e)}function my(e,r,a){return e>=Me(r,a)&&e<be(r,a)}function Ja(e,r,a){for(var b=a?Ma:Ho,_=e[0].length,B=e.length,V=B,J=rt(B),Q=1/0,st=[];V--;){var at=e[V];V&&r&&(at=ae(at,We(r))),Q=Me(at.length,Q),J[V]=!a&&(r||_>=120&&at.length>=120)?new or(V&&at):s}at=e[0];var ut=-1,ft=J[0];t:for(;++ut<_&&st.length<Q;){var vt=at[ut],Tt=r?r(vt):vt;if(vt=a||vt!==0?vt:0,!(ft?Ii(ft,Tt):b(st,Tt,a))){for(V=B;--V;){var Nt=J[V];if(!(Nt?Ii(Nt,Tt):b(e[V],Tt,a)))continue t}ft&&ft.push(Tt),st.push(vt)}}return st}function gy(e,r,a,b){return mn(e,function(_,B,V){r(b,a(_),B,V)}),b}function Ni(e,r,a){r=jn(r,e),e=cd(e,r);var b=e==null?e:e[vn(en(r))];return b==null?s:He(b,e,a)}function Cf(e){return de(e)&&Pe(e)==U}function vy(e){return de(e)&&Pe(e)==wi}function yy(e){return de(e)&&Pe(e)==ct}function Fi(e,r,a,b,_){return e===r?!0:e==null||r==null||!de(e)&&!de(r)?e!==e&&r!==r:by(e,r,a,b,Fi,_)}function by(e,r,a,b,_,B){var V=It(e),J=It(r),Q=V?K:_e(e),st=J?K:_e(r);Q=Q==U?Xt:Q,st=st==U?Xt:st;var at=Q==Xt,ut=st==Xt,ft=Q==st;if(ft&&Jn(e)){if(!Jn(r))return!1;V=!0,at=!1}if(ft&&!at)return B||(B=new un),V||Zr(e)?rd(e,r,a,b,_,B):jy(e,r,Q,a,b,_,B);if(!(a&d)){var vt=at&&Qt.call(e,"__wrapped__"),Tt=ut&&Qt.call(r,"__wrapped__");if(vt||Tt){var Nt=vt?e.value():e,Ct=Tt?r.value():r;return B||(B=new un),_(Nt,Ct,a,b,B)}}return ft?(B||(B=new un),Ky(e,r,a,b,_,B)):!1}function Ey(e){return de(e)&&_e(e)==pt}function Za(e,r,a,b){var _=a.length,B=_,V=!b;if(e==null)return!B;for(e=te(e);_--;){var J=a[_];if(V&&J[2]?J[1]!==e[J[0]]:!(J[0]in e))return!1}for(;++_<B;){J=a[_];var Q=J[0],st=e[Q],at=J[1];if(V&&J[2]){if(st===s&&!(Q in e))return!1}else{var ut=new un;if(b)var ft=b(st,at,Q,e,r,ut);if(!(ft===s?Fi(at,st,d|A,b,ut):ft))return!1}}return!0}function Of(e){if(!ue(e)||n0(e))return!1;var r=Rn(e)?Ev:cg;return r.test(lr(e))}function Ay(e){return de(e)&&Pe(e)==X}function Sy(e){return de(e)&&_e(e)==ot}function Ty(e){return de(e)&&Ts(e.length)&&!!ie[Pe(e)]}function wf(e){return typeof e=="function"?e:e==null?ke:typeof e=="object"?It(e)?Rf(e[0],e[1]):xf(e):Jd(e)}function qa(e){if(!ki(e))return wv(e);var r=[];for(var a in te(e))Qt.call(e,a)&&a!="constructor"&&r.push(a);return r}function Cy(e){if(!ue(e))return s0(e);var r=ki(e),a=[];for(var b in e)b=="constructor"&&(r||!Qt.call(e,b))||a.push(b);return a}function Ya(e,r){return e<r}function If(e,r){var a=-1,b=Ue(e)?rt(e.length):[];return $n(e,function(_,B,V){b[++a]=r(_,B,V)}),b}function xf(e){var r=du(e);return r.length==1&&r[0][2]?ud(r[0][0],r[0][1]):function(a){return a===e||Za(a,e,r)}}function Rf(e,r){return pu(e)&&ad(r)?ud(vn(e),r):function(a){var b=Cu(a,e);return b===s&&b===r?Ou(a,e):Fi(r,b,d|A)}}function as(e,r,a,b,_){e!==r&&Va(r,function(B,V){if(_||(_=new un),ue(B))Oy(e,r,V,a,as,b,_);else{var J=b?b(gu(e,V),B,V+"",e,r,_):s;J===s&&(J=B),za(e,V,J)}},Be)}function Oy(e,r,a,b,_,B,V){var J=gu(e,a),Q=gu(r,a),st=V.get(Q);if(st){za(e,a,st);return}var at=B?B(J,Q,a+"",e,r,V):s,ut=at===s;if(ut){var ft=It(Q),vt=!ft&&Jn(Q),Tt=!ft&&!vt&&Zr(Q);at=Q,ft||vt||Tt?It(J)?at=J:he(J)?at=Fe(J):vt?(ut=!1,at=Hf(Q,!0)):Tt?(ut=!1,at=Wf(Q,!0)):at=[]:Hi(Q)||cr(Q)?(at=J,cr(J)?at=Bd(J):(!ue(J)||Rn(J))&&(at=sd(Q))):ut=!1}ut&&(V.set(Q,at),_(at,Q,b,B,V),V.delete(Q)),za(e,a,at)}function Mf(e,r){var a=e.length;if(!!a)return r+=r<0?a:0,xn(r,a)?e[r]:s}function _f(e,r,a){r.length?r=ae(r,function(B){return It(B)?function(V){return ar(V,B.length===1?B[0]:B)}:B}):r=[ke];var b=-1;r=ae(r,We(St()));var _=If(e,function(B,V,J){var Q=ae(r,function(st){return st(B)});return{criteria:Q,index:++b,value:B}});return Qg(_,function(B,V){return By(B,V,a)})}function wy(e,r){return Pf(e,r,function(a,b){return Ou(e,b)})}function Pf(e,r,a){for(var b=-1,_=r.length,B={};++b<_;){var V=r[b],J=ar(e,V);a(J,V)&&Ui(B,jn(V,e),J)}return B}function Iy(e){return function(r){return ar(r,e)}}function Qa(e,r,a,b){var _=b?Yg:kr,B=-1,V=r.length,J=e;for(e===r&&(r=Fe(r)),a&&(J=ae(e,We(a)));++B<V;)for(var Q=0,st=r[B],at=a?a(st):st;(Q=_(J,at,Q,b))>-1;)J!==e&&Yo.call(J,Q,1),Yo.call(e,Q,1);return e}function Lf(e,r){for(var a=e?r.length:0,b=a-1;a--;){var _=r[a];if(a==b||_!==B){var B=_;xn(_)?Yo.call(e,_,1):nu(e,_)}}return e}function Xa(e,r){return e+ts(hf()*(r-e+1))}function xy(e,r,a,b){for(var _=-1,B=be(Xo((r-e)/(a||1)),0),V=rt(B);B--;)V[b?B:++_]=e,e+=a;return V}function tu(e,r){var a="";if(!e||r<1||r>$)return a;do r%2&&(a+=e),r=ts(r/2),r&&(e+=e);while(r);return a}function Bt(e,r){return vu(ld(e,r,ke),e+"")}function Ry(e){return gf(qr(e))}function My(e,r){var a=qr(e);return vs(a,sr(r,0,a.length))}function Ui(e,r,a,b){if(!ue(e))return e;r=jn(r,e);for(var _=-1,B=r.length,V=B-1,J=e;J!=null&&++_<B;){var Q=vn(r[_]),st=a;if(Q==="__proto__"||Q==="constructor"||Q==="prototype")return e;if(_!=V){var at=J[Q];st=b?b(at,Q,J):s,st===s&&(st=ue(at)?at:xn(r[_+1])?[]:{})}Li(J,Q,st),J=J[Q]}return e}var Df=es?function(e,r){return es.set(e,r),e}:ke,_y=Qo?function(e,r){return Qo(e,"toString",{configurable:!0,enumerable:!1,value:Iu(r),writable:!0})}:ke;function Py(e){return vs(qr(e))}function tn(e,r,a){var b=-1,_=e.length;r<0&&(r=-r>_?0:_+r),a=a>_?_:a,a<0&&(a+=_),_=r>a?0:a-r>>>0,r>>>=0;for(var B=rt(_);++b<_;)B[b]=e[b+r];return B}function Ly(e,r){var a;return $n(e,function(b,_,B){return a=r(b,_,B),!a}),!!a}function us(e,r,a){var b=0,_=e==null?b:e.length;if(typeof r=="number"&&r===r&&_<=G){for(;b<_;){var B=b+_>>>1,V=e[B];V!==null&&!$e(V)&&(a?V<=r:V<r)?b=B+1:_=B}return _}return eu(e,r,ke,a)}function eu(e,r,a,b){var _=0,B=e==null?0:e.length;if(B===0)return 0;r=a(r);for(var V=r!==r,J=r===null,Q=$e(r),st=r===s;_<B;){var at=ts((_+B)/2),ut=a(e[at]),ft=ut!==s,vt=ut===null,Tt=ut===ut,Nt=$e(ut);if(V)var Ct=b||Tt;else st?Ct=Tt&&(b||ft):J?Ct=Tt&&ft&&(b||!vt):Q?Ct=Tt&&ft&&!vt&&(b||!Nt):vt||Nt?Ct=!1:Ct=b?ut<=r:ut<r;Ct?_=at+1:B=at}return Me(B,Y)}function Nf(e,r){for(var a=-1,b=e.length,_=0,B=[];++a<b;){var V=e[a],J=r?r(V):V;if(!a||!ln(J,Q)){var Q=J;B[_++]=V===0?0:V}}return B}function Ff(e){return typeof e=="number"?e:$e(e)?Z:+e}function ze(e){if(typeof e=="string")return e;if(It(e))return ae(e,ze)+"";if($e(e))return pf?pf.call(e):"";var r=e+"";return r=="0"&&1/e==-P?"-0":r}function Vn(e,r,a){var b=-1,_=Ho,B=e.length,V=!0,J=[],Q=J;if(a)V=!1,_=Ma;else if(B>=n){var st=r?null:$y(e);if(st)return zo(st);V=!1,_=Ii,Q=new or}else Q=r?[]:J;t:for(;++b<B;){var at=e[b],ut=r?r(at):at;if(at=a||at!==0?at:0,V&&ut===ut){for(var ft=Q.length;ft--;)if(Q[ft]===ut)continue t;r&&Q.push(ut),J.push(at)}else _(Q,ut,a)||(Q!==J&&Q.push(ut),J.push(at))}return J}function nu(e,r){return r=jn(r,e),e=cd(e,r),e==null||delete e[vn(en(r))]}function Uf(e,r,a,b){return Ui(e,r,a(ar(e,r)),b)}function ls(e,r,a,b){for(var _=e.length,B=b?_:-1;(b?B--:++B<_)&&r(e[B],B,e););return a?tn(e,b?0:B,b?B+1:_):tn(e,b?B+1:0,b?_:B)}function Bf(e,r){var a=e;return a instanceof Gt&&(a=a.value()),_a(r,function(b,_){return _.func.apply(_.thisArg,Gn([b],_.args))},a)}function ru(e,r,a){var b=e.length;if(b<2)return b?Vn(e[0]):[];for(var _=-1,B=rt(b);++_<b;)for(var V=e[_],J=-1;++J<b;)J!=_&&(B[_]=Di(B[_]||V,e[J],r,a));return Vn(xe(B,1),r,a)}function kf(e,r,a){for(var b=-1,_=e.length,B=r.length,V={};++b<_;){var J=b<B?r[b]:s;a(V,e[b],J)}return V}function iu(e){return he(e)?e:[]}function ou(e){return typeof e=="function"?e:ke}function jn(e,r){return It(e)?e:pu(e,r)?[e]:pd(qt(e))}var Dy=Bt;function Kn(e,r,a){var b=e.length;return a=a===s?b:a,!r&&a>=b?e:tn(e,r,a)}var Gf=Av||function(e){return Te.clearTimeout(e)};function Hf(e,r){if(r)return e.slice();var a=e.length,b=uf?uf(a):new e.constructor(a);return e.copy(b),b}function su(e){var r=new e.constructor(e.byteLength);return new Zo(r).set(new Zo(e)),r}function Ny(e,r){var a=r?su(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function Fy(e){var r=new e.constructor(e.source,Tc.exec(e));return r.lastIndex=e.lastIndex,r}function Uy(e){return Pi?te(Pi.call(e)):{}}function Wf(e,r){var a=r?su(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function zf(e,r){if(e!==r){var a=e!==s,b=e===null,_=e===e,B=$e(e),V=r!==s,J=r===null,Q=r===r,st=$e(r);if(!J&&!st&&!B&&e>r||B&&V&&Q&&!J&&!st||b&&V&&Q||!a&&Q||!_)return 1;if(!b&&!B&&!st&&e<r||st&&a&&_&&!b&&!B||J&&a&&_||!V&&_||!Q)return-1}return 0}function By(e,r,a){for(var b=-1,_=e.criteria,B=r.criteria,V=_.length,J=a.length;++b<V;){var Q=zf(_[b],B[b]);if(Q){if(b>=J)return Q;var st=a[b];return Q*(st=="desc"?-1:1)}}return e.index-r.index}function $f(e,r,a,b){for(var _=-1,B=e.length,V=a.length,J=-1,Q=r.length,st=be(B-V,0),at=rt(Q+st),ut=!b;++J<Q;)at[J]=r[J];for(;++_<V;)(ut||_<B)&&(at[a[_]]=e[_]);for(;st--;)at[J++]=e[_++];return at}function Vf(e,r,a,b){for(var _=-1,B=e.length,V=-1,J=a.length,Q=-1,st=r.length,at=be(B-J,0),ut=rt(at+st),ft=!b;++_<at;)ut[_]=e[_];for(var vt=_;++Q<st;)ut[vt+Q]=r[Q];for(;++V<J;)(ft||_<B)&&(ut[vt+a[V]]=e[_++]);return ut}function Fe(e,r){var a=-1,b=e.length;for(r||(r=rt(b));++a<b;)r[a]=e[a];return r}function gn(e,r,a,b){var _=!a;a||(a={});for(var B=-1,V=r.length;++B<V;){var J=r[B],Q=b?b(a[J],e[J],J,a,e):s;Q===s&&(Q=e[J]),_?On(a,J,Q):Li(a,J,Q)}return a}function ky(e,r){return gn(e,hu(e),r)}function Gy(e,r){return gn(e,id(e),r)}function cs(e,r){return function(a,b){var _=It(a)?Vg:uy,B=r?r():{};return _(a,e,St(b,2),B)}}function jr(e){return Bt(function(r,a){var b=-1,_=a.length,B=_>1?a[_-1]:s,V=_>2?a[2]:s;for(B=e.length>3&&typeof B=="function"?(_--,B):s,V&&Le(a[0],a[1],V)&&(B=_<3?s:B,_=1),r=te(r);++b<_;){var J=a[b];J&&e(r,J,b,B)}return r})}function jf(e,r){return function(a,b){if(a==null)return a;if(!Ue(a))return e(a,b);for(var _=a.length,B=r?_:-1,V=te(a);(r?B--:++B<_)&&b(V[B],B,V)!==!1;);return a}}function Kf(e){return function(r,a,b){for(var _=-1,B=te(r),V=b(r),J=V.length;J--;){var Q=V[e?J:++_];if(a(B[Q],Q,B)===!1)break}return r}}function Hy(e,r,a){var b=r&I,_=Bi(e);function B(){var V=this&&this!==Te&&this instanceof B?_:e;return V.apply(b?a:this,arguments)}return B}function Jf(e){return function(r){r=qt(r);var a=Gr(r)?an(r):s,b=a?a[0]:r.charAt(0),_=a?Kn(a,1).join(""):r.slice(1);return b[e]()+_}}function Kr(e){return function(r){return _a(jd(Vd(r).replace(_g,"")),e,"")}}function Bi(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var a=Vr(e.prototype),b=e.apply(a,r);return ue(b)?b:a}}function Wy(e,r,a){var b=Bi(e);function _(){for(var B=arguments.length,V=rt(B),J=B,Q=Jr(_);J--;)V[J]=arguments[J];var st=B<3&&V[0]!==Q&&V[B-1]!==Q?[]:Hn(V,Q);if(B-=st.length,B<a)return Xf(e,r,fs,_.placeholder,s,V,st,s,s,a-B);var at=this&&this!==Te&&this instanceof _?b:e;return He(at,this,V)}return _}function Zf(e){return function(r,a,b){var _=te(r);if(!Ue(r)){var B=St(a,3);r=Ce(r),a=function(J){return B(_[J],J,_)}}var V=e(r,a,b);return V>-1?_[B?r[V]:V]:s}}function qf(e){return In(function(r){var a=r.length,b=a,_=Qe.prototype.thru;for(e&&r.reverse();b--;){var B=r[b];if(typeof B!="function")throw new Ye(o);if(_&&!V&&ms(B)=="wrapper")var V=new Qe([],!0)}for(b=V?b:a;++b<a;){B=r[b];var J=ms(B),Q=J=="wrapper"?fu(B):s;Q&&mu(Q[0])&&Q[1]==(g|S|p|v)&&!Q[4].length&&Q[9]==1?V=V[ms(Q[0])].apply(V,Q[3]):V=B.length==1&&mu(B)?V[J]():V.thru(B)}return function(){var st=arguments,at=st[0];if(V&&st.length==1&&It(at))return V.plant(at).value();for(var ut=0,ft=a?r[ut].apply(this,st):at;++ut<a;)ft=r[ut].call(this,ft);return ft}})}function fs(e,r,a,b,_,B,V,J,Q,st){var at=r&g,ut=r&I,ft=r&M,vt=r&(S|w),Tt=r&h,Nt=ft?s:Bi(e);function Ct(){for(var kt=arguments.length,zt=rt(kt),Ve=kt;Ve--;)zt[Ve]=arguments[Ve];if(vt)var De=Jr(Ct),je=tv(zt,De);if(b&&(zt=$f(zt,b,_,vt)),B&&(zt=Vf(zt,B,V,vt)),kt-=je,vt&&kt<st){var pe=Hn(zt,De);return Xf(e,r,fs,Ct.placeholder,a,zt,pe,J,Q,st-kt)}var cn=ut?a:this,_n=ft?cn[e]:e;return kt=zt.length,J?zt=u0(zt,J):Tt&&kt>1&&zt.reverse(),at&&Q<kt&&(zt.length=Q),this&&this!==Te&&this instanceof Ct&&(_n=Nt||Bi(_n)),_n.apply(cn,zt)}return Ct}function Yf(e,r){return function(a,b){return gy(a,e,r(b),{})}}function ds(e,r){return function(a,b){var _;if(a===s&&b===s)return r;if(a!==s&&(_=a),b!==s){if(_===s)return b;typeof a=="string"||typeof b=="string"?(a=ze(a),b=ze(b)):(a=Ff(a),b=Ff(b)),_=e(a,b)}return _}}function au(e){return In(function(r){return r=ae(r,We(St())),Bt(function(a){var b=this;return e(r,function(_){return He(_,b,a)})})})}function hs(e,r){r=r===s?" ":ze(r);var a=r.length;if(a<2)return a?tu(r,e):r;var b=tu(r,Xo(e/Hr(r)));return Gr(r)?Kn(an(b),0,e).join(""):b.slice(0,e)}function zy(e,r,a,b){var _=r&I,B=Bi(e);function V(){for(var J=-1,Q=arguments.length,st=-1,at=b.length,ut=rt(at+Q),ft=this&&this!==Te&&this instanceof V?B:e;++st<at;)ut[st]=b[st];for(;Q--;)ut[st++]=arguments[++J];return He(ft,_?a:this,ut)}return V}function Qf(e){return function(r,a,b){return b&&typeof b!="number"&&Le(r,a,b)&&(a=b=s),r=Mn(r),a===s?(a=r,r=0):a=Mn(a),b=b===s?r<a?1:-1:Mn(b),xy(r,a,b,e)}}function ps(e){return function(r,a){return typeof r=="string"&&typeof a=="string"||(r=nn(r),a=nn(a)),e(r,a)}}function Xf(e,r,a,b,_,B,V,J,Q,st){var at=r&S,ut=at?V:s,ft=at?s:V,vt=at?B:s,Tt=at?s:B;r|=at?p:y,r&=~(at?y:p),r&C||(r&=~(I|M));var Nt=[e,r,_,vt,ut,Tt,ft,J,Q,st],Ct=a.apply(s,Nt);return mu(e)&&fd(Ct,Nt),Ct.placeholder=b,dd(Ct,e,r)}function uu(e){var r=ye[e];return function(a,b){if(a=nn(a),b=b==null?0:Me(Pt(b),292),b&&df(a)){var _=(qt(a)+"e").split("e"),B=r(_[0]+"e"+(+_[1]+b));return _=(qt(B)+"e").split("e"),+(_[0]+"e"+(+_[1]-b))}return r(a)}}var $y=zr&&1/zo(new zr([,-0]))[1]==P?function(e){return new zr(e)}:Mu;function td(e){return function(r){var a=_e(r);return a==pt?Ba(r):a==ot?av(r):Xg(r,e(r))}}function wn(e,r,a,b,_,B,V,J){var Q=r&M;if(!Q&&typeof e!="function")throw new Ye(o);var st=b?b.length:0;if(st||(r&=~(p|y),b=_=s),V=V===s?V:be(Pt(V),0),J=J===s?J:Pt(J),st-=_?_.length:0,r&y){var at=b,ut=_;b=_=s}var ft=Q?s:fu(e),vt=[e,r,a,b,_,at,ut,B,V,J];if(ft&&o0(vt,ft),e=vt[0],r=vt[1],a=vt[2],b=vt[3],_=vt[4],J=vt[9]=vt[9]===s?Q?0:e.length:be(vt[9]-st,0),!J&&r&(S|w)&&(r&=~(S|w)),!r||r==I)var Tt=Hy(e,r,a);else r==S||r==w?Tt=Wy(e,r,J):(r==p||r==(I|p))&&!_.length?Tt=zy(e,r,a,b):Tt=fs.apply(s,vt);var Nt=ft?Df:fd;return dd(Nt(Tt,vt),e,r)}function ed(e,r,a,b){return e===s||ln(e,Wr[a])&&!Qt.call(b,a)?r:e}function nd(e,r,a,b,_,B){return ue(e)&&ue(r)&&(B.set(r,e),as(e,r,s,nd,B),B.delete(r)),e}function Vy(e){return Hi(e)?s:e}function rd(e,r,a,b,_,B){var V=a&d,J=e.length,Q=r.length;if(J!=Q&&!(V&&Q>J))return!1;var st=B.get(e),at=B.get(r);if(st&&at)return st==r&&at==e;var ut=-1,ft=!0,vt=a&A?new or:s;for(B.set(e,r),B.set(r,e);++ut<J;){var Tt=e[ut],Nt=r[ut];if(b)var Ct=V?b(Nt,Tt,ut,r,e,B):b(Tt,Nt,ut,e,r,B);if(Ct!==s){if(Ct)continue;ft=!1;break}if(vt){if(!Pa(r,function(kt,zt){if(!Ii(vt,zt)&&(Tt===kt||_(Tt,kt,a,b,B)))return vt.push(zt)})){ft=!1;break}}else if(!(Tt===Nt||_(Tt,Nt,a,b,B))){ft=!1;break}}return B.delete(e),B.delete(r),ft}function jy(e,r,a,b,_,B,V){switch(a){case Ur:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case wi:return!(e.byteLength!=r.byteLength||!B(new Zo(e),new Zo(r)));case nt:case ct:case Vt:return ln(+e,+r);case bt:return e.name==r.name&&e.message==r.message;case X:case lt:return e==r+"";case pt:var J=Ba;case ot:var Q=b&d;if(J||(J=zo),e.size!=r.size&&!Q)return!1;var st=V.get(e);if(st)return st==r;b|=A,V.set(e,r);var at=rd(J(e),J(r),b,_,B,V);return V.delete(e),at;case gt:if(Pi)return Pi.call(e)==Pi.call(r)}return!1}function Ky(e,r,a,b,_,B){var V=a&d,J=lu(e),Q=J.length,st=lu(r),at=st.length;if(Q!=at&&!V)return!1;for(var ut=Q;ut--;){var ft=J[ut];if(!(V?ft in r:Qt.call(r,ft)))return!1}var vt=B.get(e),Tt=B.get(r);if(vt&&Tt)return vt==r&&Tt==e;var Nt=!0;B.set(e,r),B.set(r,e);for(var Ct=V;++ut<Q;){ft=J[ut];var kt=e[ft],zt=r[ft];if(b)var Ve=V?b(zt,kt,ft,r,e,B):b(kt,zt,ft,e,r,B);if(!(Ve===s?kt===zt||_(kt,zt,a,b,B):Ve)){Nt=!1;break}Ct||(Ct=ft=="constructor")}if(Nt&&!Ct){var De=e.constructor,je=r.constructor;De!=je&&"constructor"in e&&"constructor"in r&&!(typeof De=="function"&&De instanceof De&&typeof je=="function"&&je instanceof je)&&(Nt=!1)}return B.delete(e),B.delete(r),Nt}function In(e){return vu(ld(e,s,yd),e+"")}function lu(e){return Tf(e,Ce,hu)}function cu(e){return Tf(e,Be,id)}var fu=es?function(e){return es.get(e)}:Mu;function ms(e){for(var r=e.name+"",a=$r[r],b=Qt.call($r,r)?a.length:0;b--;){var _=a[b],B=_.func;if(B==null||B==e)return _.name}return r}function Jr(e){var r=Qt.call(D,"placeholder")?D:e;return r.placeholder}function St(){var e=D.iteratee||xu;return e=e===xu?wf:e,arguments.length?e(arguments[0],arguments[1]):e}function gs(e,r){var a=e.__data__;return e0(r)?a[typeof r=="string"?"string":"hash"]:a.map}function du(e){for(var r=Ce(e),a=r.length;a--;){var b=r[a],_=e[b];r[a]=[b,_,ad(_)]}return r}function ur(e,r){var a=iv(e,r);return Of(a)?a:s}function Jy(e){var r=Qt.call(e,rr),a=e[rr];try{e[rr]=s;var b=!0}catch(B){}var _=Ko.call(e);return b&&(r?e[rr]=a:delete e[rr]),_}var hu=Ga?function(e){return e==null?[]:(e=te(e),kn(Ga(e),function(r){return cf.call(e,r)}))}:_u,id=Ga?function(e){for(var r=[];e;)Gn(r,hu(e)),e=qo(e);return r}:_u,_e=Pe;(Ha&&_e(new Ha(new ArrayBuffer(1)))!=Ur||Ri&&_e(new Ri)!=pt||Wa&&_e(Wa.resolve())!=se||zr&&_e(new zr)!=ot||Mi&&_e(new Mi)!=ge)&&(_e=function(e){var r=Pe(e),a=r==Xt?e.constructor:s,b=a?lr(a):"";if(b)switch(b){case Mv:return Ur;case _v:return pt;case Pv:return se;case Lv:return ot;case Dv:return ge}return r});function Zy(e,r,a){for(var b=-1,_=a.length;++b<_;){var B=a[b],V=B.size;switch(B.type){case"drop":e+=V;break;case"dropRight":r-=V;break;case"take":r=Me(r,e+V);break;case"takeRight":e=be(e,r-V);break}}return{start:e,end:r}}function qy(e){var r=e.match(ng);return r?r[1].split(rg):[]}function od(e,r,a){r=jn(r,e);for(var b=-1,_=r.length,B=!1;++b<_;){var V=vn(r[b]);if(!(B=e!=null&&a(e,V)))break;e=e[V]}return B||++b!=_?B:(_=e==null?0:e.length,!!_&&Ts(_)&&xn(V,_)&&(It(e)||cr(e)))}function Yy(e){var r=e.length,a=new e.constructor(r);return r&&typeof e[0]=="string"&&Qt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function sd(e){return typeof e.constructor=="function"&&!ki(e)?Vr(qo(e)):{}}function Qy(e,r,a){var b=e.constructor;switch(r){case wi:return su(e);case nt:case ct:return new b(+e);case Ur:return Ny(e,a);case da:case ha:case pa:case ma:case ga:case va:case ya:case ba:case Ea:return Wf(e,a);case pt:return new b;case Vt:case lt:return new b(e);case X:return Fy(e);case ot:return new b;case gt:return Uy(e)}}function Xy(e,r){var a=r.length;if(!a)return e;var b=a-1;return r[b]=(a>1?"& ":"")+r[b],r=r.join(a>2?", ":" "),e.replace(eg,`{
/* [wrapped with `+r+`] */
`)}function t0(e){return It(e)||cr(e)||!!(ff&&e&&e[ff])}function xn(e,r){var a=typeof e;return r=r==null?$:r,!!r&&(a=="number"||a!="symbol"&&dg.test(e))&&e>-1&&e%1==0&&e<r}function Le(e,r,a){if(!ue(a))return!1;var b=typeof r;return(b=="number"?Ue(a)&&xn(r,a.length):b=="string"&&r in a)?ln(a[r],e):!1}function pu(e,r){if(It(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||$e(e)?!0:Ym.test(e)||!qm.test(e)||r!=null&&e in te(r)}function e0(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function mu(e){var r=ms(e),a=D[r];if(typeof a!="function"||!(r in Gt.prototype))return!1;if(e===a)return!0;var b=fu(a);return!!b&&e===b[0]}function n0(e){return!!af&&af in e}var r0=Vo?Rn:Pu;function ki(e){var r=e&&e.constructor,a=typeof r=="function"&&r.prototype||Wr;return e===a}function ad(e){return e===e&&!ue(e)}function ud(e,r){return function(a){return a==null?!1:a[e]===r&&(r!==s||e in te(a))}}function i0(e){var r=As(e,function(b){return a.size===u&&a.clear(),b}),a=r.cache;return r}function o0(e,r){var a=e[1],b=r[1],_=a|b,B=_<(I|M|g),V=b==g&&a==S||b==g&&a==v&&e[7].length<=r[8]||b==(g|v)&&r[7].length<=r[8]&&a==S;if(!(B||V))return e;b&I&&(e[2]=r[2],_|=a&I?0:C);var J=r[3];if(J){var Q=e[3];e[3]=Q?$f(Q,J,r[4]):J,e[4]=Q?Hn(e[3],f):r[4]}return J=r[5],J&&(Q=e[5],e[5]=Q?Vf(Q,J,r[6]):J,e[6]=Q?Hn(e[5],f):r[6]),J=r[7],J&&(e[7]=J),b&g&&(e[8]=e[8]==null?r[8]:Me(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=_,e}function s0(e){var r=[];if(e!=null)for(var a in te(e))r.push(a);return r}function a0(e){return Ko.call(e)}function ld(e,r,a){return r=be(r===s?e.length-1:r,0),function(){for(var b=arguments,_=-1,B=be(b.length-r,0),V=rt(B);++_<B;)V[_]=b[r+_];_=-1;for(var J=rt(r+1);++_<r;)J[_]=b[_];return J[r]=a(V),He(e,this,J)}}function cd(e,r){return r.length<2?e:ar(e,tn(r,0,-1))}function u0(e,r){for(var a=e.length,b=Me(r.length,a),_=Fe(e);b--;){var B=r[b];e[b]=xn(B,a)?_[B]:s}return e}function gu(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var fd=hd(Df),Gi=Tv||function(e,r){return Te.setTimeout(e,r)},vu=hd(_y);function dd(e,r,a){var b=r+"";return vu(e,Xy(b,l0(qy(b),a)))}function hd(e){var r=0,a=0;return function(){var b=Iv(),_=z-(b-a);if(a=b,_>0){if(++r>=L)return arguments[0]}else r=0;return e.apply(s,arguments)}}function vs(e,r){var a=-1,b=e.length,_=b-1;for(r=r===s?b:r;++a<r;){var B=Xa(a,_),V=e[B];e[B]=e[a],e[a]=V}return e.length=r,e}var pd=i0(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Qm,function(a,b,_,B){r.push(_?B.replace(sg,"$1"):b||a)}),r});function vn(e){if(typeof e=="string"||$e(e))return e;var r=e+"";return r=="0"&&1/e==-P?"-0":r}function lr(e){if(e!=null){try{return jo.call(e)}catch(r){}try{return e+""}catch(r){}}return""}function l0(e,r){return qe(N,function(a){var b="_."+a[0];r&a[1]&&!Ho(e,b)&&e.push(b)}),e.sort()}function md(e){if(e instanceof Gt)return e.clone();var r=new Qe(e.__wrapped__,e.__chain__);return r.__actions__=Fe(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function c0(e,r,a){(a?Le(e,r,a):r===s)?r=1:r=be(Pt(r),0);var b=e==null?0:e.length;if(!b||r<1)return[];for(var _=0,B=0,V=rt(Xo(b/r));_<b;)V[B++]=tn(e,_,_+=r);return V}function f0(e){for(var r=-1,a=e==null?0:e.length,b=0,_=[];++r<a;){var B=e[r];B&&(_[b++]=B)}return _}function d0(){var e=arguments.length;if(!e)return[];for(var r=rt(e-1),a=arguments[0],b=e;b--;)r[b-1]=arguments[b];return Gn(It(a)?Fe(a):[a],xe(r,1))}var h0=Bt(function(e,r){return he(e)?Di(e,xe(r,1,he,!0)):[]}),p0=Bt(function(e,r){var a=en(r);return he(a)&&(a=s),he(e)?Di(e,xe(r,1,he,!0),St(a,2)):[]}),m0=Bt(function(e,r){var a=en(r);return he(a)&&(a=s),he(e)?Di(e,xe(r,1,he,!0),s,a):[]});function g0(e,r,a){var b=e==null?0:e.length;return b?(r=a||r===s?1:Pt(r),tn(e,r<0?0:r,b)):[]}function v0(e,r,a){var b=e==null?0:e.length;return b?(r=a||r===s?1:Pt(r),r=b-r,tn(e,0,r<0?0:r)):[]}function y0(e,r){return e&&e.length?ls(e,St(r,3),!0,!0):[]}function b0(e,r){return e&&e.length?ls(e,St(r,3),!0):[]}function E0(e,r,a,b){var _=e==null?0:e.length;return _?(a&&typeof a!="number"&&Le(e,r,a)&&(a=0,b=_),dy(e,r,a,b)):[]}function gd(e,r,a){var b=e==null?0:e.length;if(!b)return-1;var _=a==null?0:Pt(a);return _<0&&(_=be(b+_,0)),Wo(e,St(r,3),_)}function vd(e,r,a){var b=e==null?0:e.length;if(!b)return-1;var _=b-1;return a!==s&&(_=Pt(a),_=a<0?be(b+_,0):Me(_,b-1)),Wo(e,St(r,3),_,!0)}function yd(e){var r=e==null?0:e.length;return r?xe(e,1):[]}function A0(e){var r=e==null?0:e.length;return r?xe(e,P):[]}function S0(e,r){var a=e==null?0:e.length;return a?(r=r===s?1:Pt(r),xe(e,r)):[]}function T0(e){for(var r=-1,a=e==null?0:e.length,b={};++r<a;){var _=e[r];b[_[0]]=_[1]}return b}function bd(e){return e&&e.length?e[0]:s}function C0(e,r,a){var b=e==null?0:e.length;if(!b)return-1;var _=a==null?0:Pt(a);return _<0&&(_=be(b+_,0)),kr(e,r,_)}function O0(e){var r=e==null?0:e.length;return r?tn(e,0,-1):[]}var w0=Bt(function(e){var r=ae(e,iu);return r.length&&r[0]===e[0]?Ja(r):[]}),I0=Bt(function(e){var r=en(e),a=ae(e,iu);return r===en(a)?r=s:a.pop(),a.length&&a[0]===e[0]?Ja(a,St(r,2)):[]}),x0=Bt(function(e){var r=en(e),a=ae(e,iu);return r=typeof r=="function"?r:s,r&&a.pop(),a.length&&a[0]===e[0]?Ja(a,s,r):[]});function R0(e,r){return e==null?"":Ov.call(e,r)}function en(e){var r=e==null?0:e.length;return r?e[r-1]:s}function M0(e,r,a){var b=e==null?0:e.length;if(!b)return-1;var _=b;return a!==s&&(_=Pt(a),_=_<0?be(b+_,0):Me(_,b-1)),r===r?lv(e,r,_):Wo(e,Qc,_,!0)}function _0(e,r){return e&&e.length?Mf(e,Pt(r)):s}var P0=Bt(Ed);function Ed(e,r){return e&&e.length&&r&&r.length?Qa(e,r):e}function L0(e,r,a){return e&&e.length&&r&&r.length?Qa(e,r,St(a,2)):e}function D0(e,r,a){return e&&e.length&&r&&r.length?Qa(e,r,s,a):e}var N0=In(function(e,r){var a=e==null?0:e.length,b=$a(e,r);return Lf(e,ae(r,function(_){return xn(_,a)?+_:_}).sort(zf)),b});function F0(e,r){var a=[];if(!(e&&e.length))return a;var b=-1,_=[],B=e.length;for(r=St(r,3);++b<B;){var V=e[b];r(V,b,e)&&(a.push(V),_.push(b))}return Lf(e,_),a}function yu(e){return e==null?e:Rv.call(e)}function U0(e,r,a){var b=e==null?0:e.length;return b?(a&&typeof a!="number"&&Le(e,r,a)?(r=0,a=b):(r=r==null?0:Pt(r),a=a===s?b:Pt(a)),tn(e,r,a)):[]}function B0(e,r){return us(e,r)}function k0(e,r,a){return eu(e,r,St(a,2))}function G0(e,r){var a=e==null?0:e.length;if(a){var b=us(e,r);if(b<a&&ln(e[b],r))return b}return-1}function H0(e,r){return us(e,r,!0)}function W0(e,r,a){return eu(e,r,St(a,2),!0)}function z0(e,r){var a=e==null?0:e.length;if(a){var b=us(e,r,!0)-1;if(ln(e[b],r))return b}return-1}function $0(e){return e&&e.length?Nf(e):[]}function V0(e,r){return e&&e.length?Nf(e,St(r,2)):[]}function j0(e){var r=e==null?0:e.length;return r?tn(e,1,r):[]}function K0(e,r,a){return e&&e.length?(r=a||r===s?1:Pt(r),tn(e,0,r<0?0:r)):[]}function J0(e,r,a){var b=e==null?0:e.length;return b?(r=a||r===s?1:Pt(r),r=b-r,tn(e,r<0?0:r,b)):[]}function Z0(e,r){return e&&e.length?ls(e,St(r,3),!1,!0):[]}function q0(e,r){return e&&e.length?ls(e,St(r,3)):[]}var Y0=Bt(function(e){return Vn(xe(e,1,he,!0))}),Q0=Bt(function(e){var r=en(e);return he(r)&&(r=s),Vn(xe(e,1,he,!0),St(r,2))}),X0=Bt(function(e){var r=en(e);return r=typeof r=="function"?r:s,Vn(xe(e,1,he,!0),s,r)});function tb(e){return e&&e.length?Vn(e):[]}function eb(e,r){return e&&e.length?Vn(e,St(r,2)):[]}function nb(e,r){return r=typeof r=="function"?r:s,e&&e.length?Vn(e,s,r):[]}function bu(e){if(!(e&&e.length))return[];var r=0;return e=kn(e,function(a){if(he(a))return r=be(a.length,r),!0}),Fa(r,function(a){return ae(e,La(a))})}function Ad(e,r){if(!(e&&e.length))return[];var a=bu(e);return r==null?a:ae(a,function(b){return He(r,s,b)})}var rb=Bt(function(e,r){return he(e)?Di(e,r):[]}),ib=Bt(function(e){return ru(kn(e,he))}),ob=Bt(function(e){var r=en(e);return he(r)&&(r=s),ru(kn(e,he),St(r,2))}),sb=Bt(function(e){var r=en(e);return r=typeof r=="function"?r:s,ru(kn(e,he),s,r)}),ab=Bt(bu);function ub(e,r){return kf(e||[],r||[],Li)}function lb(e,r){return kf(e||[],r||[],Ui)}var cb=Bt(function(e){var r=e.length,a=r>1?e[r-1]:s;return a=typeof a=="function"?(e.pop(),a):s,Ad(e,a)});function Sd(e){var r=D(e);return r.__chain__=!0,r}function fb(e,r){return r(e),e}function ys(e,r){return r(e)}var db=In(function(e){var r=e.length,a=r?e[0]:0,b=this.__wrapped__,_=function(B){return $a(B,e)};return r>1||this.__actions__.length||!(b instanceof Gt)||!xn(a)?this.thru(_):(b=b.slice(a,+a+(r?1:0)),b.__actions__.push({func:ys,args:[_],thisArg:s}),new Qe(b,this.__chain__).thru(function(B){return r&&!B.length&&B.push(s),B}))});function hb(){return Sd(this)}function pb(){return new Qe(this.value(),this.__chain__)}function mb(){this.__values__===s&&(this.__values__=Fd(this.value()));var e=this.__index__>=this.__values__.length,r=e?s:this.__values__[this.__index__++];return{done:e,value:r}}function gb(){return this}function vb(e){for(var r,a=this;a instanceof rs;){var b=md(a);b.__index__=0,b.__values__=s,r?_.__wrapped__=b:r=b;var _=b;a=a.__wrapped__}return _.__wrapped__=e,r}function yb(){var e=this.__wrapped__;if(e instanceof Gt){var r=e;return this.__actions__.length&&(r=new Gt(this)),r=r.reverse(),r.__actions__.push({func:ys,args:[yu],thisArg:s}),new Qe(r,this.__chain__)}return this.thru(yu)}function bb(){return Bf(this.__wrapped__,this.__actions__)}var Eb=cs(function(e,r,a){Qt.call(e,a)?++e[a]:On(e,a,1)});function Ab(e,r,a){var b=It(e)?qc:fy;return a&&Le(e,r,a)&&(r=s),b(e,St(r,3))}function Sb(e,r){var a=It(e)?kn:Af;return a(e,St(r,3))}var Tb=Zf(gd),Cb=Zf(vd);function Ob(e,r){return xe(bs(e,r),1)}function wb(e,r){return xe(bs(e,r),P)}function Ib(e,r,a){return a=a===s?1:Pt(a),xe(bs(e,r),a)}function Td(e,r){var a=It(e)?qe:$n;return a(e,St(r,3))}function Cd(e,r){var a=It(e)?jg:Ef;return a(e,St(r,3))}var xb=cs(function(e,r,a){Qt.call(e,a)?e[a].push(r):On(e,a,[r])});function Rb(e,r,a,b){e=Ue(e)?e:qr(e),a=a&&!b?Pt(a):0;var _=e.length;return a<0&&(a=be(_+a,0)),Cs(e)?a<=_&&e.indexOf(r,a)>-1:!!_&&kr(e,r,a)>-1}var Mb=Bt(function(e,r,a){var b=-1,_=typeof r=="function",B=Ue(e)?rt(e.length):[];return $n(e,function(V){B[++b]=_?He(r,V,a):Ni(V,r,a)}),B}),_b=cs(function(e,r,a){On(e,a,r)});function bs(e,r){var a=It(e)?ae:If;return a(e,St(r,3))}function Pb(e,r,a,b){return e==null?[]:(It(r)||(r=r==null?[]:[r]),a=b?s:a,It(a)||(a=a==null?[]:[a]),_f(e,r,a))}var Lb=cs(function(e,r,a){e[a?0:1].push(r)},function(){return[[],[]]});function Db(e,r,a){var b=It(e)?_a:tf,_=arguments.length<3;return b(e,St(r,4),a,_,$n)}function Nb(e,r,a){var b=It(e)?Kg:tf,_=arguments.length<3;return b(e,St(r,4),a,_,Ef)}function Fb(e,r){var a=It(e)?kn:Af;return a(e,Ss(St(r,3)))}function Ub(e){var r=It(e)?gf:Ry;return r(e)}function Bb(e,r,a){(a?Le(e,r,a):r===s)?r=1:r=Pt(r);var b=It(e)?sy:My;return b(e,r)}function kb(e){var r=It(e)?ay:Py;return r(e)}function Gb(e){if(e==null)return 0;if(Ue(e))return Cs(e)?Hr(e):e.length;var r=_e(e);return r==pt||r==ot?e.size:qa(e).length}function Hb(e,r,a){var b=It(e)?Pa:Ly;return a&&Le(e,r,a)&&(r=s),b(e,St(r,3))}var Wb=Bt(function(e,r){if(e==null)return[];var a=r.length;return a>1&&Le(e,r[0],r[1])?r=[]:a>2&&Le(r[0],r[1],r[2])&&(r=[r[0]]),_f(e,xe(r,1),[])}),Es=Sv||function(){return Te.Date.now()};function zb(e,r){if(typeof r!="function")throw new Ye(o);return e=Pt(e),function(){if(--e<1)return r.apply(this,arguments)}}function Od(e,r,a){return r=a?s:r,r=e&&r==null?e.length:r,wn(e,g,s,s,s,s,r)}function wd(e,r){var a;if(typeof r!="function")throw new Ye(o);return e=Pt(e),function(){return--e>0&&(a=r.apply(this,arguments)),e<=1&&(r=s),a}}var Eu=Bt(function(e,r,a){var b=I;if(a.length){var _=Hn(a,Jr(Eu));b|=p}return wn(e,b,r,a,_)}),Id=Bt(function(e,r,a){var b=I|M;if(a.length){var _=Hn(a,Jr(Id));b|=p}return wn(r,b,e,a,_)});function xd(e,r,a){r=a?s:r;var b=wn(e,S,s,s,s,s,s,r);return b.placeholder=xd.placeholder,b}function Rd(e,r,a){r=a?s:r;var b=wn(e,w,s,s,s,s,s,r);return b.placeholder=Rd.placeholder,b}function Md(e,r,a){var b,_,B,V,J,Q,st=0,at=!1,ut=!1,ft=!0;if(typeof e!="function")throw new Ye(o);r=nn(r)||0,ue(a)&&(at=!!a.leading,ut="maxWait"in a,B=ut?be(nn(a.maxWait)||0,r):B,ft="trailing"in a?!!a.trailing:ft);function vt(pe){var cn=b,_n=_;return b=_=s,st=pe,V=e.apply(_n,cn),V}function Tt(pe){return st=pe,J=Gi(kt,r),at?vt(pe):V}function Nt(pe){var cn=pe-Q,_n=pe-st,Zd=r-cn;return ut?Me(Zd,B-_n):Zd}function Ct(pe){var cn=pe-Q,_n=pe-st;return Q===s||cn>=r||cn<0||ut&&_n>=B}function kt(){var pe=Es();if(Ct(pe))return zt(pe);J=Gi(kt,Nt(pe))}function zt(pe){return J=s,ft&&b?vt(pe):(b=_=s,V)}function Ve(){J!==s&&Gf(J),st=0,b=Q=_=J=s}function De(){return J===s?V:zt(Es())}function je(){var pe=Es(),cn=Ct(pe);if(b=arguments,_=this,Q=pe,cn){if(J===s)return Tt(Q);if(ut)return Gf(J),J=Gi(kt,r),vt(Q)}return J===s&&(J=Gi(kt,r)),V}return je.cancel=Ve,je.flush=De,je}var $b=Bt(function(e,r){return bf(e,1,r)}),Vb=Bt(function(e,r,a){return bf(e,nn(r)||0,a)});function jb(e){return wn(e,h)}function As(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new Ye(o);var a=function(){var b=arguments,_=r?r.apply(this,b):b[0],B=a.cache;if(B.has(_))return B.get(_);var V=e.apply(this,b);return a.cache=B.set(_,V)||B,V};return a.cache=new(As.Cache||Cn),a}As.Cache=Cn;function Ss(e){if(typeof e!="function")throw new Ye(o);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Kb(e){return wd(2,e)}var Jb=Dy(function(e,r){r=r.length==1&&It(r[0])?ae(r[0],We(St())):ae(xe(r,1),We(St()));var a=r.length;return Bt(function(b){for(var _=-1,B=Me(b.length,a);++_<B;)b[_]=r[_].call(this,b[_]);return He(e,this,b)})}),Au=Bt(function(e,r){var a=Hn(r,Jr(Au));return wn(e,p,s,r,a)}),_d=Bt(function(e,r){var a=Hn(r,Jr(_d));return wn(e,y,s,r,a)}),Zb=In(function(e,r){return wn(e,v,s,s,s,r)});function qb(e,r){if(typeof e!="function")throw new Ye(o);return r=r===s?r:Pt(r),Bt(e,r)}function Yb(e,r){if(typeof e!="function")throw new Ye(o);return r=r==null?0:be(Pt(r),0),Bt(function(a){var b=a[r],_=Kn(a,0,r);return b&&Gn(_,b),He(e,this,_)})}function Qb(e,r,a){var b=!0,_=!0;if(typeof e!="function")throw new Ye(o);return ue(a)&&(b="leading"in a?!!a.leading:b,_="trailing"in a?!!a.trailing:_),Md(e,r,{leading:b,maxWait:r,trailing:_})}function Xb(e){return Od(e,1)}function tE(e,r){return Au(ou(r),e)}function eE(){if(!arguments.length)return[];var e=arguments[0];return It(e)?e:[e]}function nE(e){return Xe(e,O)}function rE(e,r){return r=typeof r=="function"?r:s,Xe(e,O,r)}function iE(e){return Xe(e,m|O)}function oE(e,r){return r=typeof r=="function"?r:s,Xe(e,m|O,r)}function sE(e,r){return r==null||yf(e,r,Ce(r))}function ln(e,r){return e===r||e!==e&&r!==r}var aE=ps(Ka),uE=ps(function(e,r){return e>=r}),cr=Cf(function(){return arguments}())?Cf:function(e){return de(e)&&Qt.call(e,"callee")&&!cf.call(e,"callee")},It=rt.isArray,lE=$c?We($c):vy;function Ue(e){return e!=null&&Ts(e.length)&&!Rn(e)}function he(e){return de(e)&&Ue(e)}function cE(e){return e===!0||e===!1||de(e)&&Pe(e)==nt}var Jn=Cv||Pu,fE=Vc?We(Vc):yy;function dE(e){return de(e)&&e.nodeType===1&&!Hi(e)}function hE(e){if(e==null)return!0;if(Ue(e)&&(It(e)||typeof e=="string"||typeof e.splice=="function"||Jn(e)||Zr(e)||cr(e)))return!e.length;var r=_e(e);if(r==pt||r==ot)return!e.size;if(ki(e))return!qa(e).length;for(var a in e)if(Qt.call(e,a))return!1;return!0}function pE(e,r){return Fi(e,r)}function mE(e,r,a){a=typeof a=="function"?a:s;var b=a?a(e,r):s;return b===s?Fi(e,r,s,a):!!b}function Su(e){if(!de(e))return!1;var r=Pe(e);return r==bt||r==Et||typeof e.message=="string"&&typeof e.name=="string"&&!Hi(e)}function gE(e){return typeof e=="number"&&df(e)}function Rn(e){if(!ue(e))return!1;var r=Pe(e);return r==_t||r==Kt||r==j||r==Ne}function Pd(e){return typeof e=="number"&&e==Pt(e)}function Ts(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=$}function ue(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function de(e){return e!=null&&typeof e=="object"}var Ld=jc?We(jc):Ey;function vE(e,r){return e===r||Za(e,r,du(r))}function yE(e,r,a){return a=typeof a=="function"?a:s,Za(e,r,du(r),a)}function bE(e){return Dd(e)&&e!=+e}function EE(e){if(r0(e))throw new wt(i);return Of(e)}function AE(e){return e===null}function SE(e){return e==null}function Dd(e){return typeof e=="number"||de(e)&&Pe(e)==Vt}function Hi(e){if(!de(e)||Pe(e)!=Xt)return!1;var r=qo(e);if(r===null)return!0;var a=Qt.call(r,"constructor")&&r.constructor;return typeof a=="function"&&a instanceof a&&jo.call(a)==yv}var Tu=Kc?We(Kc):Ay;function TE(e){return Pd(e)&&e>=-$&&e<=$}var Nd=Jc?We(Jc):Sy;function Cs(e){return typeof e=="string"||!It(e)&&de(e)&&Pe(e)==lt}function $e(e){return typeof e=="symbol"||de(e)&&Pe(e)==gt}var Zr=Zc?We(Zc):Ty;function CE(e){return e===s}function OE(e){return de(e)&&_e(e)==ge}function wE(e){return de(e)&&Pe(e)==er}var IE=ps(Ya),xE=ps(function(e,r){return e<=r});function Fd(e){if(!e)return[];if(Ue(e))return Cs(e)?an(e):Fe(e);if(xi&&e[xi])return sv(e[xi]());var r=_e(e),a=r==pt?Ba:r==ot?zo:qr;return a(e)}function Mn(e){if(!e)return e===0?e:0;if(e=nn(e),e===P||e===-P){var r=e<0?-1:1;return r*W}return e===e?e:0}function Pt(e){var r=Mn(e),a=r%1;return r===r?a?r-a:r:0}function Ud(e){return e?sr(Pt(e),0,et):0}function nn(e){if(typeof e=="number")return e;if($e(e))return Z;if(ue(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ue(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=ef(e);var a=lg.test(e);return a||fg.test(e)?zg(e.slice(2),a?2:8):ug.test(e)?Z:+e}function Bd(e){return gn(e,Be(e))}function RE(e){return e?sr(Pt(e),-$,$):e===0?e:0}function qt(e){return e==null?"":ze(e)}var ME=jr(function(e,r){if(ki(r)||Ue(r)){gn(r,Ce(r),e);return}for(var a in r)Qt.call(r,a)&&Li(e,a,r[a])}),kd=jr(function(e,r){gn(r,Be(r),e)}),Os=jr(function(e,r,a,b){gn(r,Be(r),e,b)}),_E=jr(function(e,r,a,b){gn(r,Ce(r),e,b)}),PE=In($a);function LE(e,r){var a=Vr(e);return r==null?a:vf(a,r)}var DE=Bt(function(e,r){e=te(e);var a=-1,b=r.length,_=b>2?r[2]:s;for(_&&Le(r[0],r[1],_)&&(b=1);++a<b;)for(var B=r[a],V=Be(B),J=-1,Q=V.length;++J<Q;){var st=V[J],at=e[st];(at===s||ln(at,Wr[st])&&!Qt.call(e,st))&&(e[st]=B[st])}return e}),NE=Bt(function(e){return e.push(s,nd),He(Gd,s,e)});function FE(e,r){return Yc(e,St(r,3),mn)}function UE(e,r){return Yc(e,St(r,3),ja)}function BE(e,r){return e==null?e:Va(e,St(r,3),Be)}function kE(e,r){return e==null?e:Sf(e,St(r,3),Be)}function GE(e,r){return e&&mn(e,St(r,3))}function HE(e,r){return e&&ja(e,St(r,3))}function WE(e){return e==null?[]:ss(e,Ce(e))}function zE(e){return e==null?[]:ss(e,Be(e))}function Cu(e,r,a){var b=e==null?s:ar(e,r);return b===s?a:b}function $E(e,r){return e!=null&&od(e,r,hy)}function Ou(e,r){return e!=null&&od(e,r,py)}var VE=Yf(function(e,r,a){r!=null&&typeof r.toString!="function"&&(r=Ko.call(r)),e[r]=a},Iu(ke)),jE=Yf(function(e,r,a){r!=null&&typeof r.toString!="function"&&(r=Ko.call(r)),Qt.call(e,r)?e[r].push(a):e[r]=[a]},St),KE=Bt(Ni);function Ce(e){return Ue(e)?mf(e):qa(e)}function Be(e){return Ue(e)?mf(e,!0):Cy(e)}function JE(e,r){var a={};return r=St(r,3),mn(e,function(b,_,B){On(a,r(b,_,B),b)}),a}function ZE(e,r){var a={};return r=St(r,3),mn(e,function(b,_,B){On(a,_,r(b,_,B))}),a}var qE=jr(function(e,r,a){as(e,r,a)}),Gd=jr(function(e,r,a,b){as(e,r,a,b)}),YE=In(function(e,r){var a={};if(e==null)return a;var b=!1;r=ae(r,function(B){return B=jn(B,e),b||(b=B.length>1),B}),gn(e,cu(e),a),b&&(a=Xe(a,m|E|O,Vy));for(var _=r.length;_--;)nu(a,r[_]);return a});function QE(e,r){return Hd(e,Ss(St(r)))}var XE=In(function(e,r){return e==null?{}:wy(e,r)});function Hd(e,r){if(e==null)return{};var a=ae(cu(e),function(b){return[b]});return r=St(r),Pf(e,a,function(b,_){return r(b,_[0])})}function tA(e,r,a){r=jn(r,e);var b=-1,_=r.length;for(_||(_=1,e=s);++b<_;){var B=e==null?s:e[vn(r[b])];B===s&&(b=_,B=a),e=Rn(B)?B.call(e):B}return e}function eA(e,r,a){return e==null?e:Ui(e,r,a)}function nA(e,r,a,b){return b=typeof b=="function"?b:s,e==null?e:Ui(e,r,a,b)}var Wd=td(Ce),zd=td(Be);function rA(e,r,a){var b=It(e),_=b||Jn(e)||Zr(e);if(r=St(r,4),a==null){var B=e&&e.constructor;_?a=b?new B:[]:ue(e)?a=Rn(B)?Vr(qo(e)):{}:a={}}return(_?qe:mn)(e,function(V,J,Q){return r(a,V,J,Q)}),a}function iA(e,r){return e==null?!0:nu(e,r)}function oA(e,r,a){return e==null?e:Uf(e,r,ou(a))}function sA(e,r,a,b){return b=typeof b=="function"?b:s,e==null?e:Uf(e,r,ou(a),b)}function qr(e){return e==null?[]:Ua(e,Ce(e))}function aA(e){return e==null?[]:Ua(e,Be(e))}function uA(e,r,a){return a===s&&(a=r,r=s),a!==s&&(a=nn(a),a=a===a?a:0),r!==s&&(r=nn(r),r=r===r?r:0),sr(nn(e),r,a)}function lA(e,r,a){return r=Mn(r),a===s?(a=r,r=0):a=Mn(a),e=nn(e),my(e,r,a)}function cA(e,r,a){if(a&&typeof a!="boolean"&&Le(e,r,a)&&(r=a=s),a===s&&(typeof r=="boolean"?(a=r,r=s):typeof e=="boolean"&&(a=e,e=s)),e===s&&r===s?(e=0,r=1):(e=Mn(e),r===s?(r=e,e=0):r=Mn(r)),e>r){var b=e;e=r,r=b}if(a||e%1||r%1){var _=hf();return Me(e+_*(r-e+Wg("1e-"+((_+"").length-1))),r)}return Xa(e,r)}var fA=Kr(function(e,r,a){return r=r.toLowerCase(),e+(a?$d(r):r)});function $d(e){return wu(qt(e).toLowerCase())}function Vd(e){return e=qt(e),e&&e.replace(hg,ev).replace(Pg,"")}function dA(e,r,a){e=qt(e),r=ze(r);var b=e.length;a=a===s?b:sr(Pt(a),0,b);var _=a;return a-=r.length,a>=0&&e.slice(a,_)==r}function hA(e){return e=qt(e),e&&Km.test(e)?e.replace(Ac,nv):e}function pA(e){return e=qt(e),e&&Xm.test(e)?e.replace(Aa,"\\$&"):e}var mA=Kr(function(e,r,a){return e+(a?"-":"")+r.toLowerCase()}),gA=Kr(function(e,r,a){return e+(a?" ":"")+r.toLowerCase()}),vA=Jf("toLowerCase");function yA(e,r,a){e=qt(e),r=Pt(r);var b=r?Hr(e):0;if(!r||b>=r)return e;var _=(r-b)/2;return hs(ts(_),a)+e+hs(Xo(_),a)}function bA(e,r,a){e=qt(e),r=Pt(r);var b=r?Hr(e):0;return r&&b<r?e+hs(r-b,a):e}function EA(e,r,a){e=qt(e),r=Pt(r);var b=r?Hr(e):0;return r&&b<r?hs(r-b,a)+e:e}function AA(e,r,a){return a||r==null?r=0:r&&(r=+r),xv(qt(e).replace(Sa,""),r||0)}function SA(e,r,a){return(a?Le(e,r,a):r===s)?r=1:r=Pt(r),tu(qt(e),r)}function TA(){var e=arguments,r=qt(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var CA=Kr(function(e,r,a){return e+(a?"_":"")+r.toLowerCase()});function OA(e,r,a){return a&&typeof a!="number"&&Le(e,r,a)&&(r=a=s),a=a===s?et:a>>>0,a?(e=qt(e),e&&(typeof r=="string"||r!=null&&!Tu(r))&&(r=ze(r),!r&&Gr(e))?Kn(an(e),0,a):e.split(r,a)):[]}var wA=Kr(function(e,r,a){return e+(a?" ":"")+wu(r)});function IA(e,r,a){return e=qt(e),a=a==null?0:sr(Pt(a),0,e.length),r=ze(r),e.slice(a,a+r.length)==r}function xA(e,r,a){var b=D.templateSettings;a&&Le(e,r,a)&&(r=s),e=qt(e),r=Os({},r,b,ed);var _=Os({},r.imports,b.imports,ed),B=Ce(_),V=Ua(_,B),J,Q,st=0,at=r.interpolate||Bo,ut="__p += '",ft=ka((r.escape||Bo).source+"|"+at.source+"|"+(at===Sc?ag:Bo).source+"|"+(r.evaluate||Bo).source+"|$","g"),vt="//# sourceURL="+(Qt.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ug+"]")+`
`;e.replace(ft,function(Ct,kt,zt,Ve,De,je){return zt||(zt=Ve),ut+=e.slice(st,je).replace(pg,rv),kt&&(J=!0,ut+=`' +
__e(`+kt+`) +
'`),De&&(Q=!0,ut+=`';
`+De+`;
__p += '`),zt&&(ut+=`' +
((__t = (`+zt+`)) == null ? '' : __t) +
'`),st=je+Ct.length,Ct}),ut+=`';
`;var Tt=Qt.call(r,"variable")&&r.variable;if(!Tt)ut=`with (obj) {
`+ut+`
}
`;else if(og.test(Tt))throw new wt(l);ut=(Q?ut.replace(zm,""):ut).replace($m,"$1").replace(Vm,"$1;"),ut="function("+(Tt||"obj")+`) {
`+(Tt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(J?", __e = _.escape":"")+(Q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ut+`return __p
}`;var Nt=Kd(function(){return Jt(B,vt+"return "+ut).apply(s,V)});if(Nt.source=ut,Su(Nt))throw Nt;return Nt}function RA(e){return qt(e).toLowerCase()}function MA(e){return qt(e).toUpperCase()}function _A(e,r,a){if(e=qt(e),e&&(a||r===s))return ef(e);if(!e||!(r=ze(r)))return e;var b=an(e),_=an(r),B=nf(b,_),V=rf(b,_)+1;return Kn(b,B,V).join("")}function PA(e,r,a){if(e=qt(e),e&&(a||r===s))return e.slice(0,sf(e)+1);if(!e||!(r=ze(r)))return e;var b=an(e),_=rf(b,an(r))+1;return Kn(b,0,_).join("")}function LA(e,r,a){if(e=qt(e),e&&(a||r===s))return e.replace(Sa,"");if(!e||!(r=ze(r)))return e;var b=an(e),_=nf(b,an(r));return Kn(b,_).join("")}function DA(e,r){var a=T,b=x;if(ue(r)){var _="separator"in r?r.separator:_;a="length"in r?Pt(r.length):a,b="omission"in r?ze(r.omission):b}e=qt(e);var B=e.length;if(Gr(e)){var V=an(e);B=V.length}if(a>=B)return e;var J=a-Hr(b);if(J<1)return b;var Q=V?Kn(V,0,J).join(""):e.slice(0,J);if(_===s)return Q+b;if(V&&(J+=Q.length-J),Tu(_)){if(e.slice(J).search(_)){var st,at=Q;for(_.global||(_=ka(_.source,qt(Tc.exec(_))+"g")),_.lastIndex=0;st=_.exec(at);)var ut=st.index;Q=Q.slice(0,ut===s?J:ut)}}else if(e.indexOf(ze(_),J)!=J){var ft=Q.lastIndexOf(_);ft>-1&&(Q=Q.slice(0,ft))}return Q+b}function NA(e){return e=qt(e),e&&jm.test(e)?e.replace(Ec,cv):e}var FA=Kr(function(e,r,a){return e+(a?" ":"")+r.toUpperCase()}),wu=Jf("toUpperCase");function jd(e,r,a){return e=qt(e),r=a?s:r,r===s?ov(e)?hv(e):qg(e):e.match(r)||[]}var Kd=Bt(function(e,r){try{return He(e,s,r)}catch(a){return Su(a)?a:new wt(a)}}),UA=In(function(e,r){return qe(r,function(a){a=vn(a),On(e,a,Eu(e[a],e))}),e});function BA(e){var r=e==null?0:e.length,a=St();return e=r?ae(e,function(b){if(typeof b[1]!="function")throw new Ye(o);return[a(b[0]),b[1]]}):[],Bt(function(b){for(var _=-1;++_<r;){var B=e[_];if(He(B[0],this,b))return He(B[1],this,b)}})}function kA(e){return cy(Xe(e,m))}function Iu(e){return function(){return e}}function GA(e,r){return e==null||e!==e?r:e}var HA=qf(),WA=qf(!0);function ke(e){return e}function xu(e){return wf(typeof e=="function"?e:Xe(e,m))}function zA(e){return xf(Xe(e,m))}function $A(e,r){return Rf(e,Xe(r,m))}var VA=Bt(function(e,r){return function(a){return Ni(a,e,r)}}),jA=Bt(function(e,r){return function(a){return Ni(e,a,r)}});function Ru(e,r,a){var b=Ce(r),_=ss(r,b);a==null&&!(ue(r)&&(_.length||!b.length))&&(a=r,r=e,e=this,_=ss(r,Ce(r)));var B=!(ue(a)&&"chain"in a)||!!a.chain,V=Rn(e);return qe(_,function(J){var Q=r[J];e[J]=Q,V&&(e.prototype[J]=function(){var st=this.__chain__;if(B||st){var at=e(this.__wrapped__),ut=at.__actions__=Fe(this.__actions__);return ut.push({func:Q,args:arguments,thisArg:e}),at.__chain__=st,at}return Q.apply(e,Gn([this.value()],arguments))})}),e}function KA(){return Te._===this&&(Te._=bv),this}function Mu(){}function JA(e){return e=Pt(e),Bt(function(r){return Mf(r,e)})}var ZA=au(ae),qA=au(qc),YA=au(Pa);function Jd(e){return pu(e)?La(vn(e)):Iy(e)}function QA(e){return function(r){return e==null?s:ar(e,r)}}var XA=Qf(),tS=Qf(!0);function _u(){return[]}function Pu(){return!1}function eS(){return{}}function nS(){return""}function rS(){return!0}function iS(e,r){if(e=Pt(e),e<1||e>$)return[];var a=et,b=Me(e,et);r=St(r),e-=et;for(var _=Fa(b,r);++a<e;)r(a);return _}function oS(e){return It(e)?ae(e,vn):$e(e)?[e]:Fe(pd(qt(e)))}function sS(e){var r=++vv;return qt(e)+r}var aS=ds(function(e,r){return e+r},0),uS=uu("ceil"),lS=ds(function(e,r){return e/r},1),cS=uu("floor");function fS(e){return e&&e.length?os(e,ke,Ka):s}function dS(e,r){return e&&e.length?os(e,St(r,2),Ka):s}function hS(e){return Xc(e,ke)}function pS(e,r){return Xc(e,St(r,2))}function mS(e){return e&&e.length?os(e,ke,Ya):s}function gS(e,r){return e&&e.length?os(e,St(r,2),Ya):s}var vS=ds(function(e,r){return e*r},1),yS=uu("round"),bS=ds(function(e,r){return e-r},0);function ES(e){return e&&e.length?Na(e,ke):0}function AS(e,r){return e&&e.length?Na(e,St(r,2)):0}return D.after=zb,D.ary=Od,D.assign=ME,D.assignIn=kd,D.assignInWith=Os,D.assignWith=_E,D.at=PE,D.before=wd,D.bind=Eu,D.bindAll=UA,D.bindKey=Id,D.castArray=eE,D.chain=Sd,D.chunk=c0,D.compact=f0,D.concat=d0,D.cond=BA,D.conforms=kA,D.constant=Iu,D.countBy=Eb,D.create=LE,D.curry=xd,D.curryRight=Rd,D.debounce=Md,D.defaults=DE,D.defaultsDeep=NE,D.defer=$b,D.delay=Vb,D.difference=h0,D.differenceBy=p0,D.differenceWith=m0,D.drop=g0,D.dropRight=v0,D.dropRightWhile=y0,D.dropWhile=b0,D.fill=E0,D.filter=Sb,D.flatMap=Ob,D.flatMapDeep=wb,D.flatMapDepth=Ib,D.flatten=yd,D.flattenDeep=A0,D.flattenDepth=S0,D.flip=jb,D.flow=HA,D.flowRight=WA,D.fromPairs=T0,D.functions=WE,D.functionsIn=zE,D.groupBy=xb,D.initial=O0,D.intersection=w0,D.intersectionBy=I0,D.intersectionWith=x0,D.invert=VE,D.invertBy=jE,D.invokeMap=Mb,D.iteratee=xu,D.keyBy=_b,D.keys=Ce,D.keysIn=Be,D.map=bs,D.mapKeys=JE,D.mapValues=ZE,D.matches=zA,D.matchesProperty=$A,D.memoize=As,D.merge=qE,D.mergeWith=Gd,D.method=VA,D.methodOf=jA,D.mixin=Ru,D.negate=Ss,D.nthArg=JA,D.omit=YE,D.omitBy=QE,D.once=Kb,D.orderBy=Pb,D.over=ZA,D.overArgs=Jb,D.overEvery=qA,D.overSome=YA,D.partial=Au,D.partialRight=_d,D.partition=Lb,D.pick=XE,D.pickBy=Hd,D.property=Jd,D.propertyOf=QA,D.pull=P0,D.pullAll=Ed,D.pullAllBy=L0,D.pullAllWith=D0,D.pullAt=N0,D.range=XA,D.rangeRight=tS,D.rearg=Zb,D.reject=Fb,D.remove=F0,D.rest=qb,D.reverse=yu,D.sampleSize=Bb,D.set=eA,D.setWith=nA,D.shuffle=kb,D.slice=U0,D.sortBy=Wb,D.sortedUniq=$0,D.sortedUniqBy=V0,D.split=OA,D.spread=Yb,D.tail=j0,D.take=K0,D.takeRight=J0,D.takeRightWhile=Z0,D.takeWhile=q0,D.tap=fb,D.throttle=Qb,D.thru=ys,D.toArray=Fd,D.toPairs=Wd,D.toPairsIn=zd,D.toPath=oS,D.toPlainObject=Bd,D.transform=rA,D.unary=Xb,D.union=Y0,D.unionBy=Q0,D.unionWith=X0,D.uniq=tb,D.uniqBy=eb,D.uniqWith=nb,D.unset=iA,D.unzip=bu,D.unzipWith=Ad,D.update=oA,D.updateWith=sA,D.values=qr,D.valuesIn=aA,D.without=rb,D.words=jd,D.wrap=tE,D.xor=ib,D.xorBy=ob,D.xorWith=sb,D.zip=ab,D.zipObject=ub,D.zipObjectDeep=lb,D.zipWith=cb,D.entries=Wd,D.entriesIn=zd,D.extend=kd,D.extendWith=Os,Ru(D,D),D.add=aS,D.attempt=Kd,D.camelCase=fA,D.capitalize=$d,D.ceil=uS,D.clamp=uA,D.clone=nE,D.cloneDeep=iE,D.cloneDeepWith=oE,D.cloneWith=rE,D.conformsTo=sE,D.deburr=Vd,D.defaultTo=GA,D.divide=lS,D.endsWith=dA,D.eq=ln,D.escape=hA,D.escapeRegExp=pA,D.every=Ab,D.find=Tb,D.findIndex=gd,D.findKey=FE,D.findLast=Cb,D.findLastIndex=vd,D.findLastKey=UE,D.floor=cS,D.forEach=Td,D.forEachRight=Cd,D.forIn=BE,D.forInRight=kE,D.forOwn=GE,D.forOwnRight=HE,D.get=Cu,D.gt=aE,D.gte=uE,D.has=$E,D.hasIn=Ou,D.head=bd,D.identity=ke,D.includes=Rb,D.indexOf=C0,D.inRange=lA,D.invoke=KE,D.isArguments=cr,D.isArray=It,D.isArrayBuffer=lE,D.isArrayLike=Ue,D.isArrayLikeObject=he,D.isBoolean=cE,D.isBuffer=Jn,D.isDate=fE,D.isElement=dE,D.isEmpty=hE,D.isEqual=pE,D.isEqualWith=mE,D.isError=Su,D.isFinite=gE,D.isFunction=Rn,D.isInteger=Pd,D.isLength=Ts,D.isMap=Ld,D.isMatch=vE,D.isMatchWith=yE,D.isNaN=bE,D.isNative=EE,D.isNil=SE,D.isNull=AE,D.isNumber=Dd,D.isObject=ue,D.isObjectLike=de,D.isPlainObject=Hi,D.isRegExp=Tu,D.isSafeInteger=TE,D.isSet=Nd,D.isString=Cs,D.isSymbol=$e,D.isTypedArray=Zr,D.isUndefined=CE,D.isWeakMap=OE,D.isWeakSet=wE,D.join=R0,D.kebabCase=mA,D.last=en,D.lastIndexOf=M0,D.lowerCase=gA,D.lowerFirst=vA,D.lt=IE,D.lte=xE,D.max=fS,D.maxBy=dS,D.mean=hS,D.meanBy=pS,D.min=mS,D.minBy=gS,D.stubArray=_u,D.stubFalse=Pu,D.stubObject=eS,D.stubString=nS,D.stubTrue=rS,D.multiply=vS,D.nth=_0,D.noConflict=KA,D.noop=Mu,D.now=Es,D.pad=yA,D.padEnd=bA,D.padStart=EA,D.parseInt=AA,D.random=cA,D.reduce=Db,D.reduceRight=Nb,D.repeat=SA,D.replace=TA,D.result=tA,D.round=yS,D.runInContext=q,D.sample=Ub,D.size=Gb,D.snakeCase=CA,D.some=Hb,D.sortedIndex=B0,D.sortedIndexBy=k0,D.sortedIndexOf=G0,D.sortedLastIndex=H0,D.sortedLastIndexBy=W0,D.sortedLastIndexOf=z0,D.startCase=wA,D.startsWith=IA,D.subtract=bS,D.sum=ES,D.sumBy=AS,D.template=xA,D.times=iS,D.toFinite=Mn,D.toInteger=Pt,D.toLength=Ud,D.toLower=RA,D.toNumber=nn,D.toSafeInteger=RE,D.toString=qt,D.toUpper=MA,D.trim=_A,D.trimEnd=PA,D.trimStart=LA,D.truncate=DA,D.unescape=NA,D.uniqueId=sS,D.upperCase=FA,D.upperFirst=wu,D.each=Td,D.eachRight=Cd,D.first=bd,Ru(D,function(){var e={};return mn(D,function(r,a){Qt.call(D.prototype,a)||(e[a]=r)}),e}(),{chain:!1}),D.VERSION=t,qe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){D[e].placeholder=D}),qe(["drop","take"],function(e,r){Gt.prototype[e]=function(a){a=a===s?1:be(Pt(a),0);var b=this.__filtered__&&!r?new Gt(this):this.clone();return b.__filtered__?b.__takeCount__=Me(a,b.__takeCount__):b.__views__.push({size:Me(a,et),type:e+(b.__dir__<0?"Right":"")}),b},Gt.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),qe(["filter","map","takeWhile"],function(e,r){var a=r+1,b=a==H||a==R;Gt.prototype[e]=function(_){var B=this.clone();return B.__iteratees__.push({iteratee:St(_,3),type:a}),B.__filtered__=B.__filtered__||b,B}}),qe(["head","last"],function(e,r){var a="take"+(r?"Right":"");Gt.prototype[e]=function(){return this[a](1).value()[0]}}),qe(["initial","tail"],function(e,r){var a="drop"+(r?"":"Right");Gt.prototype[e]=function(){return this.__filtered__?new Gt(this):this[a](1)}}),Gt.prototype.compact=function(){return this.filter(ke)},Gt.prototype.find=function(e){return this.filter(e).head()},Gt.prototype.findLast=function(e){return this.reverse().find(e)},Gt.prototype.invokeMap=Bt(function(e,r){return typeof e=="function"?new Gt(this):this.map(function(a){return Ni(a,e,r)})}),Gt.prototype.reject=function(e){return this.filter(Ss(St(e)))},Gt.prototype.slice=function(e,r){e=Pt(e);var a=this;return a.__filtered__&&(e>0||r<0)?new Gt(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),r!==s&&(r=Pt(r),a=r<0?a.dropRight(-r):a.take(r-e)),a)},Gt.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gt.prototype.toArray=function(){return this.take(et)},mn(Gt.prototype,function(e,r){var a=/^(?:filter|find|map|reject)|While$/.test(r),b=/^(?:head|last)$/.test(r),_=D[b?"take"+(r=="last"?"Right":""):r],B=b||/^find/.test(r);!_||(D.prototype[r]=function(){var V=this.__wrapped__,J=b?[1]:arguments,Q=V instanceof Gt,st=J[0],at=Q||It(V),ut=function(kt){var zt=_.apply(D,Gn([kt],J));return b&&ft?zt[0]:zt};at&&a&&typeof st=="function"&&st.length!=1&&(Q=at=!1);var ft=this.__chain__,vt=!!this.__actions__.length,Tt=B&&!ft,Nt=Q&&!vt;if(!B&&at){V=Nt?V:new Gt(this);var Ct=e.apply(V,J);return Ct.__actions__.push({func:ys,args:[ut],thisArg:s}),new Qe(Ct,ft)}return Tt&&Nt?e.apply(this,J):(Ct=this.thru(ut),Tt?b?Ct.value()[0]:Ct.value():Ct)})}),qe(["pop","push","shift","sort","splice","unshift"],function(e){var r=$o[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",b=/^(?:pop|shift)$/.test(e);D.prototype[e]=function(){var _=arguments;if(b&&!this.__chain__){var B=this.value();return r.apply(It(B)?B:[],_)}return this[a](function(V){return r.apply(It(V)?V:[],_)})}}),mn(Gt.prototype,function(e,r){var a=D[r];if(a){var b=a.name+"";Qt.call($r,b)||($r[b]=[]),$r[b].push({name:r,func:a})}}),$r[fs(s,M).name]=[{name:"wrapper",func:s}],Gt.prototype.clone=Nv,Gt.prototype.reverse=Fv,Gt.prototype.value=Uv,D.prototype.at=db,D.prototype.chain=hb,D.prototype.commit=pb,D.prototype.next=mb,D.prototype.plant=vb,D.prototype.reverse=yb,D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=bb,D.prototype.first=D.prototype.head,xi&&(D.prototype[xi]=gb),D},Wn=pv();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Te._=Wn,define(function(){return Wn})):nr?((nr.exports=Wn)._=Wn,xa._=Wn):Te._=Wn}).call(ti)});var Hh=me((Zi,Vu)=>{k();(function(s,t){typeof Zi=="object"&&typeof Vu=="object"?Vu.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Zi=="object"?Zi.bowser=t():s.bowser=t()})(Zi,function(){return function(s){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i,l:!1,exports:{}};return s[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=s,n.c=t,n.d=function(i,o,l){n.o(i,o)||Object.defineProperty(i,o,{enumerable:!0,get:l})},n.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,o){if(1&o&&(i=n(i)),8&o||4&o&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),2&o&&typeof i!="string")for(var c in i)n.d(l,c,function(u){return i[u]}.bind(null,c));return l},n.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(o,"a",o),o},n.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},n.p="",n(n.s=90)}({17:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i=n(18),o=function(){function l(){}return l.getFirstMatch=function(c,u){var f=u.match(c);return f&&f.length>0&&f[1]||""},l.getSecondMatch=function(c,u){var f=u.match(c);return f&&f.length>1&&f[2]||""},l.matchAndReturnConst=function(c,u,f){if(c.test(u))return f},l.getWindowsVersionName=function(c){switch(c){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},l.getMacOSVersionName=function(c){var u=c.split(".").splice(0,2).map(function(f){return parseInt(f,10)||0});if(u.push(0),u[0]===10)switch(u[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},l.getAndroidVersionName=function(c){var u=c.split(".").splice(0,2).map(function(f){return parseInt(f,10)||0});if(u.push(0),!(u[0]===1&&u[1]<5))return u[0]===1&&u[1]<6?"Cupcake":u[0]===1&&u[1]>=6?"Donut":u[0]===2&&u[1]<2?"Eclair":u[0]===2&&u[1]===2?"Froyo":u[0]===2&&u[1]>2?"Gingerbread":u[0]===3?"Honeycomb":u[0]===4&&u[1]<1?"Ice Cream Sandwich":u[0]===4&&u[1]<4?"Jelly Bean":u[0]===4&&u[1]>=4?"KitKat":u[0]===5?"Lollipop":u[0]===6?"Marshmallow":u[0]===7?"Nougat":u[0]===8?"Oreo":u[0]===9?"Pie":void 0},l.getVersionPrecision=function(c){return c.split(".").length},l.compareVersions=function(c,u,f){f===void 0&&(f=!1);var m=l.getVersionPrecision(c),E=l.getVersionPrecision(u),O=Math.max(m,E),d=0,A=l.map([c,u],function(I){var M=O-l.getVersionPrecision(I),C=I+new Array(M+1).join(".0");return l.map(C.split("."),function(S){return new Array(20-S.length).join("0")+S}).reverse()});for(f&&(d=O-Math.min(m,E)),O-=1;O>=d;){if(A[0][O]>A[1][O])return 1;if(A[0][O]===A[1][O]){if(O===d)return 0;O-=1}else if(A[0][O]<A[1][O])return-1}},l.map=function(c,u){var f,m=[];if(Array.prototype.map)return Array.prototype.map.call(c,u);for(f=0;f<c.length;f+=1)m.push(u(c[f]));return m},l.find=function(c,u){var f,m;if(Array.prototype.find)return Array.prototype.find.call(c,u);for(f=0,m=c.length;f<m;f+=1){var E=c[f];if(u(E,f))return E}},l.assign=function(c){for(var u,f,m=c,E=arguments.length,O=new Array(E>1?E-1:0),d=1;d<E;d++)O[d-1]=arguments[d];if(Object.assign)return Object.assign.apply(Object,[c].concat(O));var A=function(){var I=O[u];typeof I=="object"&&I!==null&&Object.keys(I).forEach(function(M){m[M]=I[M]})};for(u=0,f=O.length;u<f;u+=1)A();return c},l.getBrowserAlias=function(c){return i.BROWSER_ALIASES_MAP[c]},l.getBrowserTypeByAlias=function(c){return i.BROWSER_MAP[c]||""},l}();t.default=o,s.exports=t.default},18:function(s,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,o=(i=n(91))&&i.__esModule?i:{default:i},l=n(18);function c(f,m){for(var E=0;E<m.length;E++){var O=m[E];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(f,O.key,O)}}var u=function(){function f(){}var m,E,O;return f.getParser=function(d,A){if(A===void 0&&(A=!1),typeof d!="string")throw new Error("UserAgent should be a string");return new o.default(d,A)},f.parse=function(d){return new o.default(d).getResult()},m=f,O=[{key:"BROWSER_MAP",get:function(){return l.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return l.ENGINE_MAP}},{key:"OS_MAP",get:function(){return l.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return l.PLATFORMS_MAP}}],(E=null)&&c(m.prototype,E),O&&c(m,O),f}();t.default=u,s.exports=t.default},91:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i=f(n(92)),o=f(n(93)),l=f(n(94)),c=f(n(95)),u=f(n(17));function f(E){return E&&E.__esModule?E:{default:E}}var m=function(){function E(d,A){if(A===void 0&&(A=!1),d==null||d==="")throw new Error("UserAgent parameter can't be empty");this._ua=d,this.parsedResult={},A!==!0&&this.parse()}var O=E.prototype;return O.getUA=function(){return this._ua},O.test=function(d){return d.test(this._ua)},O.parseBrowser=function(){var d=this;this.parsedResult.browser={};var A=u.default.find(i.default,function(I){if(typeof I.test=="function")return I.test(d);if(I.test instanceof Array)return I.test.some(function(M){return d.test(M)});throw new Error("Browser's test function is not valid")});return A&&(this.parsedResult.browser=A.describe(this.getUA())),this.parsedResult.browser},O.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},O.getBrowserName=function(d){return d?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},O.getBrowserVersion=function(){return this.getBrowser().version},O.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},O.parseOS=function(){var d=this;this.parsedResult.os={};var A=u.default.find(o.default,function(I){if(typeof I.test=="function")return I.test(d);if(I.test instanceof Array)return I.test.some(function(M){return d.test(M)});throw new Error("Browser's test function is not valid")});return A&&(this.parsedResult.os=A.describe(this.getUA())),this.parsedResult.os},O.getOSName=function(d){var A=this.getOS().name;return d?String(A).toLowerCase()||"":A||""},O.getOSVersion=function(){return this.getOS().version},O.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},O.getPlatformType=function(d){d===void 0&&(d=!1);var A=this.getPlatform().type;return d?String(A).toLowerCase()||"":A||""},O.parsePlatform=function(){var d=this;this.parsedResult.platform={};var A=u.default.find(l.default,function(I){if(typeof I.test=="function")return I.test(d);if(I.test instanceof Array)return I.test.some(function(M){return d.test(M)});throw new Error("Browser's test function is not valid")});return A&&(this.parsedResult.platform=A.describe(this.getUA())),this.parsedResult.platform},O.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},O.getEngineName=function(d){return d?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},O.parseEngine=function(){var d=this;this.parsedResult.engine={};var A=u.default.find(c.default,function(I){if(typeof I.test=="function")return I.test(d);if(I.test instanceof Array)return I.test.some(function(M){return d.test(M)});throw new Error("Browser's test function is not valid")});return A&&(this.parsedResult.engine=A.describe(this.getUA())),this.parsedResult.engine},O.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},O.getResult=function(){return u.default.assign({},this.parsedResult)},O.satisfies=function(d){var A=this,I={},M=0,C={},S=0;if(Object.keys(d).forEach(function(x){var L=d[x];typeof L=="string"?(C[x]=L,S+=1):typeof L=="object"&&(I[x]=L,M+=1)}),M>0){var w=Object.keys(I),p=u.default.find(w,function(x){return A.isOS(x)});if(p){var y=this.satisfies(I[p]);if(y!==void 0)return y}var g=u.default.find(w,function(x){return A.isPlatform(x)});if(g){var v=this.satisfies(I[g]);if(v!==void 0)return v}}if(S>0){var h=Object.keys(C),T=u.default.find(h,function(x){return A.isBrowser(x,!0)});if(T!==void 0)return this.compareVersion(C[T])}},O.isBrowser=function(d,A){A===void 0&&(A=!1);var I=this.getBrowserName().toLowerCase(),M=d.toLowerCase(),C=u.default.getBrowserTypeByAlias(M);return A&&C&&(M=C.toLowerCase()),M===I},O.compareVersion=function(d){var A=[0],I=d,M=!1,C=this.getBrowserVersion();if(typeof C=="string")return d[0]===">"||d[0]==="<"?(I=d.substr(1),d[1]==="="?(M=!0,I=d.substr(2)):A=[],d[0]===">"?A.push(1):A.push(-1)):d[0]==="="?I=d.substr(1):d[0]==="~"&&(M=!0,I=d.substr(1)),A.indexOf(u.default.compareVersions(C,I,M))>-1},O.isOS=function(d){return this.getOSName(!0)===String(d).toLowerCase()},O.isPlatform=function(d){return this.getPlatformType(!0)===String(d).toLowerCase()},O.isEngine=function(d){return this.getEngineName(!0)===String(d).toLowerCase()},O.is=function(d,A){return A===void 0&&(A=!1),this.isBrowser(d,A)||this.isOS(d)||this.isPlatform(d)},O.some=function(d){var A=this;return d===void 0&&(d=[]),d.some(function(I){return A.is(I)})},E}();t.default=m,s.exports=t.default},92:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,o=(i=n(17))&&i.__esModule?i:{default:i},l=/version\/(\d+(\.?_?\d+)+)/i,c=[{test:[/googlebot/i],describe:function(u){var f={name:"Googlebot"},m=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/opera/i],describe:function(u){var f={name:"Opera"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/opr\/|opios/i],describe:function(u){var f={name:"Opera"},m=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/SamsungBrowser/i],describe:function(u){var f={name:"Samsung Internet for Android"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/Whale/i],describe:function(u){var f={name:"NAVER Whale Browser"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/MZBrowser/i],describe:function(u){var f={name:"MZ Browser"},m=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/focus/i],describe:function(u){var f={name:"Focus"},m=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/swing/i],describe:function(u){var f={name:"Swing"},m=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/coast/i],describe:function(u){var f={name:"Opera Coast"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(u){var f={name:"Opera Touch"},m=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/yabrowser/i],describe:function(u){var f={name:"Yandex Browser"},m=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/ucbrowser/i],describe:function(u){var f={name:"UC Browser"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/Maxthon|mxios/i],describe:function(u){var f={name:"Maxthon"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/epiphany/i],describe:function(u){var f={name:"Epiphany"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/puffin/i],describe:function(u){var f={name:"Puffin"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/sleipnir/i],describe:function(u){var f={name:"Sleipnir"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/k-meleon/i],describe:function(u){var f={name:"K-Meleon"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/micromessenger/i],describe:function(u){var f={name:"WeChat"},m=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/qqbrowser/i],describe:function(u){var f={name:/qqbrowserlite/i.test(u)?"QQ Browser Lite":"QQ Browser"},m=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/msie|trident/i],describe:function(u){var f={name:"Internet Explorer"},m=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/\sedg\//i],describe:function(u){var f={name:"Microsoft Edge"},m=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/edg([ea]|ios)/i],describe:function(u){var f={name:"Microsoft Edge"},m=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/vivaldi/i],describe:function(u){var f={name:"Vivaldi"},m=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/seamonkey/i],describe:function(u){var f={name:"SeaMonkey"},m=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/sailfish/i],describe:function(u){var f={name:"Sailfish"},m=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,u);return m&&(f.version=m),f}},{test:[/silk/i],describe:function(u){var f={name:"Amazon Silk"},m=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/phantom/i],describe:function(u){var f={name:"PhantomJS"},m=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/slimerjs/i],describe:function(u){var f={name:"SlimerJS"},m=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(u){var f={name:"BlackBerry"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/(web|hpw)[o0]s/i],describe:function(u){var f={name:"WebOS Browser"},m=o.default.getFirstMatch(l,u)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/bada/i],describe:function(u){var f={name:"Bada"},m=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/tizen/i],describe:function(u){var f={name:"Tizen"},m=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/qupzilla/i],describe:function(u){var f={name:"QupZilla"},m=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/firefox|iceweasel|fxios/i],describe:function(u){var f={name:"Firefox"},m=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/electron/i],describe:function(u){var f={name:"Electron"},m=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/MiuiBrowser/i],describe:function(u){var f={name:"Miui"},m=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/chromium/i],describe:function(u){var f={name:"Chromium"},m=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,u)||o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/chrome|crios|crmo/i],describe:function(u){var f={name:"Chrome"},m=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/GSA/i],describe:function(u){var f={name:"Google Search"},m=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:function(u){var f=!u.test(/like android/i),m=u.test(/android/i);return f&&m},describe:function(u){var f={name:"Android Browser"},m=o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/playstation 4/i],describe:function(u){var f={name:"PlayStation 4"},m=o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/safari|applewebkit/i],describe:function(u){var f={name:"Safari"},m=o.default.getFirstMatch(l,u);return m&&(f.version=m),f}},{test:[/.*/i],describe:function(u){var f=u.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(f,u),version:o.default.getSecondMatch(f,u)}}}];t.default=c,s.exports=t.default},93:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,o=(i=n(17))&&i.__esModule?i:{default:i},l=n(18),c=[{test:[/Roku\/DVP/],describe:function(u){var f=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,u);return{name:l.OS_MAP.Roku,version:f}}},{test:[/windows phone/i],describe:function(u){var f=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,u);return{name:l.OS_MAP.WindowsPhone,version:f}}},{test:[/windows /i],describe:function(u){var f=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,u),m=o.default.getWindowsVersionName(f);return{name:l.OS_MAP.Windows,version:f,versionName:m}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(u){var f={name:l.OS_MAP.iOS},m=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,u);return m&&(f.version=m),f}},{test:[/macintosh/i],describe:function(u){var f=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,u).replace(/[_\s]/g,"."),m=o.default.getMacOSVersionName(f),E={name:l.OS_MAP.MacOS,version:f};return m&&(E.versionName=m),E}},{test:[/(ipod|iphone|ipad)/i],describe:function(u){var f=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,u).replace(/[_\s]/g,".");return{name:l.OS_MAP.iOS,version:f}}},{test:function(u){var f=!u.test(/like android/i),m=u.test(/android/i);return f&&m},describe:function(u){var f=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,u),m=o.default.getAndroidVersionName(f),E={name:l.OS_MAP.Android,version:f};return m&&(E.versionName=m),E}},{test:[/(web|hpw)[o0]s/i],describe:function(u){var f=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,u),m={name:l.OS_MAP.WebOS};return f&&f.length&&(m.version=f),m}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(u){var f=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,u)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,u)||o.default.getFirstMatch(/\bbb(\d+)/i,u);return{name:l.OS_MAP.BlackBerry,version:f}}},{test:[/bada/i],describe:function(u){var f=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,u);return{name:l.OS_MAP.Bada,version:f}}},{test:[/tizen/i],describe:function(u){var f=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,u);return{name:l.OS_MAP.Tizen,version:f}}},{test:[/linux/i],describe:function(){return{name:l.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:l.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(u){var f=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,u);return{name:l.OS_MAP.PlayStation4,version:f}}}];t.default=c,s.exports=t.default},94:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,o=(i=n(17))&&i.__esModule?i:{default:i},l=n(18),c=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(u){var f=o.default.getFirstMatch(/(can-l01)/i,u)&&"Nova",m={type:l.PLATFORMS_MAP.mobile,vendor:"Huawei"};return f&&(m.model=f),m}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:l.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:l.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:l.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:l.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:l.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:l.PLATFORMS_MAP.tablet}}},{test:function(u){var f=u.test(/ipod|iphone/i),m=u.test(/like (ipod|iphone)/i);return f&&!m},describe:function(u){var f=o.default.getFirstMatch(/(ipod|iphone)/i,u);return{type:l.PLATFORMS_MAP.mobile,vendor:"Apple",model:f}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:l.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:l.PLATFORMS_MAP.mobile}}},{test:function(u){return u.getBrowserName(!0)==="blackberry"},describe:function(){return{type:l.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(u){return u.getBrowserName(!0)==="bada"},describe:function(){return{type:l.PLATFORMS_MAP.mobile}}},{test:function(u){return u.getBrowserName()==="windows phone"},describe:function(){return{type:l.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(u){var f=Number(String(u.getOSVersion()).split(".")[0]);return u.getOSName(!0)==="android"&&f>=3},describe:function(){return{type:l.PLATFORMS_MAP.tablet}}},{test:function(u){return u.getOSName(!0)==="android"},describe:function(){return{type:l.PLATFORMS_MAP.mobile}}},{test:function(u){return u.getOSName(!0)==="macos"},describe:function(){return{type:l.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(u){return u.getOSName(!0)==="windows"},describe:function(){return{type:l.PLATFORMS_MAP.desktop}}},{test:function(u){return u.getOSName(!0)==="linux"},describe:function(){return{type:l.PLATFORMS_MAP.desktop}}},{test:function(u){return u.getOSName(!0)==="playstation 4"},describe:function(){return{type:l.PLATFORMS_MAP.tv}}},{test:function(u){return u.getOSName(!0)==="roku"},describe:function(){return{type:l.PLATFORMS_MAP.tv}}}];t.default=c,s.exports=t.default},95:function(s,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,o=(i=n(17))&&i.__esModule?i:{default:i},l=n(18),c=[{test:function(u){return u.getBrowserName(!0)==="microsoft edge"},describe:function(u){if(/\sedg\//i.test(u))return{name:l.ENGINE_MAP.Blink};var f=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,u);return{name:l.ENGINE_MAP.EdgeHTML,version:f}}},{test:[/trident/i],describe:function(u){var f={name:l.ENGINE_MAP.Trident},m=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:function(u){return u.test(/presto/i)},describe:function(u){var f={name:l.ENGINE_MAP.Presto},m=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:function(u){var f=u.test(/gecko/i),m=u.test(/like gecko/i);return f&&!m},describe:function(u){var f={name:l.ENGINE_MAP.Gecko},m=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:l.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(u){var f={name:l.ENGINE_MAP.WebKit},m=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,u);return m&&(f.version=m),f}}];t.default=c,s.exports=t.default}})})});var $h={};th($h,{version:()=>FT});var FT,Vh=Nu(()=>{k();FT="lab"});var jh={};th(jh,{remoteConfig:()=>UT});var UT,Kh=Nu(()=>{k();UT={apiUrl:"dev-url",conferenceLayerUrl:"frame-url"}});var Jh=me((Hs,Ku)=>{k();(function(t,n){typeof Hs=="object"&&typeof Ku=="object"?Ku.exports=n():typeof define=="function"&&define.amd?define([],n):typeof Hs=="object"?Hs.Ably=n():t.Ably=n()})(window,function(){return function(s){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i,l:!1,exports:{}};return s[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=s,n.c=t,n.d=function(i,o,l){n.o(i,o)||Object.defineProperty(i,o,{enumerable:!0,get:l})},n.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,o){if(o&1&&(i=n(i)),o&8||o&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),o&2&&typeof i!="string")for(var c in i)n.d(l,c,function(u){return i[u]}.bind(null,c));return l},n.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(o,"a",o),o},n.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},n.p="",n(n.s=41)}([function(s,t,n){"use strict";t.__esModule=!0;var i=function(){function o(){}return o}();t.default=i},function(s,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return o}),n.d(t,"__assign",function(){return l}),n.d(t,"__rest",function(){return c}),n.d(t,"__decorate",function(){return u}),n.d(t,"__param",function(){return f}),n.d(t,"__metadata",function(){return m}),n.d(t,"__awaiter",function(){return E}),n.d(t,"__generator",function(){return O}),n.d(t,"__createBinding",function(){return d}),n.d(t,"__exportStar",function(){return A}),n.d(t,"__values",function(){return I}),n.d(t,"__read",function(){return M}),n.d(t,"__spread",function(){return C}),n.d(t,"__spreadArrays",function(){return S}),n.d(t,"__spreadArray",function(){return w}),n.d(t,"__await",function(){return p}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return g}),n.d(t,"__asyncValues",function(){return v}),n.d(t,"__makeTemplateObject",function(){return h}),n.d(t,"__importStar",function(){return x}),n.d(t,"__importDefault",function(){return L}),n.d(t,"__classPrivateFieldGet",function(){return z}),n.d(t,"__classPrivateFieldSet",function(){return H});var i=function(F,R){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,$){P.__proto__=$}||function(P,$){for(var W in $)Object.prototype.hasOwnProperty.call($,W)&&(P[W]=$[W])},i(F,R)};function o(F,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");i(F,R);function P(){this.constructor=F}F.prototype=R===null?Object.create(R):(P.prototype=R.prototype,new P)}var l=function(){return l=Object.assign||function(R){for(var P,$=1,W=arguments.length;$<W;$++){P=arguments[$];for(var Z in P)Object.prototype.hasOwnProperty.call(P,Z)&&(R[Z]=P[Z])}return R},l.apply(this,arguments)};function c(F,R){var P={};for(var $ in F)Object.prototype.hasOwnProperty.call(F,$)&&R.indexOf($)<0&&(P[$]=F[$]);if(F!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,$=Object.getOwnPropertySymbols(F);W<$.length;W++)R.indexOf($[W])<0&&Object.prototype.propertyIsEnumerable.call(F,$[W])&&(P[$[W]]=F[$[W]]);return P}function u(F,R,P,$){var W=arguments.length,Z=W<3?R:$===null?$=Object.getOwnPropertyDescriptor(R,P):$,et;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Z=Reflect.decorate(F,R,P,$);else for(var Y=F.length-1;Y>=0;Y--)(et=F[Y])&&(Z=(W<3?et(Z):W>3?et(R,P,Z):et(R,P))||Z);return W>3&&Z&&Object.defineProperty(R,P,Z),Z}function f(F,R){return function(P,$){R(P,$,F)}}function m(F,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(F,R)}function E(F,R,P,$){function W(Z){return Z instanceof P?Z:new P(function(et){et(Z)})}return new(P||(P=Promise))(function(Z,et){function Y(U){try{N($.next(U))}catch(K){et(K)}}function G(U){try{N($.throw(U))}catch(K){et(K)}}function N(U){U.done?Z(U.value):W(U.value).then(Y,G)}N(($=$.apply(F,R||[])).next())})}function O(F,R){var P={label:0,sent:function(){if(Z[0]&1)throw Z[1];return Z[1]},trys:[],ops:[]},$,W,Z,et;return et={next:Y(0),throw:Y(1),return:Y(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function Y(N){return function(U){return G([N,U])}}function G(N){if($)throw new TypeError("Generator is already executing.");for(;P;)try{if($=1,W&&(Z=N[0]&2?W.return:N[0]?W.throw||((Z=W.return)&&Z.call(W),0):W.next)&&!(Z=Z.call(W,N[1])).done)return Z;switch(W=0,Z&&(N=[N[0]&2,Z.value]),N[0]){case 0:case 1:Z=N;break;case 4:return P.label++,{value:N[1],done:!1};case 5:P.label++,W=N[1],N=[0];continue;case 7:N=P.ops.pop(),P.trys.pop();continue;default:if(Z=P.trys,!(Z=Z.length>0&&Z[Z.length-1])&&(N[0]===6||N[0]===2)){P=0;continue}if(N[0]===3&&(!Z||N[1]>Z[0]&&N[1]<Z[3])){P.label=N[1];break}if(N[0]===6&&P.label<Z[1]){P.label=Z[1],Z=N;break}if(Z&&P.label<Z[2]){P.label=Z[2],P.ops.push(N);break}Z[2]&&P.ops.pop(),P.trys.pop();continue}N=R.call(F,P)}catch(U){N=[6,U],W=0}finally{$=Z=0}if(N[0]&5)throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}}var d=Object.create?function(F,R,P,$){$===void 0&&($=P),Object.defineProperty(F,$,{enumerable:!0,get:function(){return R[P]}})}:function(F,R,P,$){$===void 0&&($=P),F[$]=R[P]};function A(F,R){for(var P in F)P!=="default"&&!Object.prototype.hasOwnProperty.call(R,P)&&d(R,F,P)}function I(F){var R=typeof Symbol=="function"&&Symbol.iterator,P=R&&F[R],$=0;if(P)return P.call(F);if(F&&typeof F.length=="number")return{next:function(){return F&&$>=F.length&&(F=void 0),{value:F&&F[$++],done:!F}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(F,R){var P=typeof Symbol=="function"&&F[Symbol.iterator];if(!P)return F;var $=P.call(F),W,Z=[],et;try{for(;(R===void 0||R-- >0)&&!(W=$.next()).done;)Z.push(W.value)}catch(Y){et={error:Y}}finally{try{W&&!W.done&&(P=$.return)&&P.call($)}finally{if(et)throw et.error}}return Z}function C(){for(var F=[],R=0;R<arguments.length;R++)F=F.concat(M(arguments[R]));return F}function S(){for(var F=0,R=0,P=arguments.length;R<P;R++)F+=arguments[R].length;for(var $=Array(F),W=0,R=0;R<P;R++)for(var Z=arguments[R],et=0,Y=Z.length;et<Y;et++,W++)$[W]=Z[et];return $}function w(F,R,P){if(P||arguments.length===2)for(var $=0,W=R.length,Z;$<W;$++)(Z||!($ in R))&&(Z||(Z=Array.prototype.slice.call(R,0,$)),Z[$]=R[$]);return F.concat(Z||Array.prototype.slice.call(R))}function p(F){return this instanceof p?(this.v=F,this):new p(F)}function y(F,R,P){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=P.apply(F,R||[]),W,Z=[];return W={},et("next"),et("throw"),et("return"),W[Symbol.asyncIterator]=function(){return this},W;function et(j){$[j]&&(W[j]=function(nt){return new Promise(function(ct,Et){Z.push([j,nt,ct,Et])>1||Y(j,nt)})})}function Y(j,nt){try{G($[j](nt))}catch(ct){K(Z[0][3],ct)}}function G(j){j.value instanceof p?Promise.resolve(j.value.v).then(N,U):K(Z[0][2],j)}function N(j){Y("next",j)}function U(j){Y("throw",j)}function K(j,nt){j(nt),Z.shift(),Z.length&&Y(Z[0][0],Z[0][1])}}function g(F){var R,P;return R={},$("next"),$("throw",function(W){throw W}),$("return"),R[Symbol.iterator]=function(){return this},R;function $(W,Z){R[W]=F[W]?function(et){return(P=!P)?{value:p(F[W](et)),done:W==="return"}:Z?Z(et):et}:Z}}function v(F){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=F[Symbol.asyncIterator],P;return R?R.call(F):(F=typeof I=="function"?I(F):F[Symbol.iterator](),P={},$("next"),$("throw"),$("return"),P[Symbol.asyncIterator]=function(){return this},P);function $(Z){P[Z]=F[Z]&&function(et){return new Promise(function(Y,G){et=F[Z](et),W(Y,G,et.done,et.value)})}}function W(Z,et,Y,G){Promise.resolve(G).then(function(N){Z({value:N,done:Y})},et)}}function h(F,R){return Object.defineProperty?Object.defineProperty(F,"raw",{value:R}):F.raw=R,F}var T=Object.create?function(F,R){Object.defineProperty(F,"default",{enumerable:!0,value:R})}:function(F,R){F.default=R};function x(F){if(F&&F.__esModule)return F;var R={};if(F!=null)for(var P in F)P!=="default"&&Object.prototype.hasOwnProperty.call(F,P)&&d(R,F,P);return T(R,F),R}function L(F){return F&&F.__esModule?F:{default:F}}function z(F,R,P,$){if(P==="a"&&!$)throw new TypeError("Private accessor was defined without a getter");if(typeof R=="function"?F!==R||!$:!R.has(F))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?$:P==="a"?$.call(F):$?$.value:R.get(F)}function H(F,R,P,$,W){if($==="m")throw new TypeError("Private method is not writable");if($==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof R=="function"?F!==R||!W:!R.has(F))throw new TypeError("Cannot write private member to an object whose class did not declare it");return $==="a"?W.call(F,P):W?W.value=P:R.set(F,P),P}},function(s,t,n){"use strict";(function(i){t.__esModule=!0,t.allToUpperCase=t.allToLowerCase=t.encodeBody=t.decodeBody=t.Format=t.promisify=t.trim=t.arrChooseN=t.randomHexString=t.randomString=t.cheapRandStr=t.dataSizeBytes=t.inspectBody=t.inspectError=t.isErrorInfo=t.now=t.parseQueryString=t.toQueryString=t.arrPopRandomElement=t.defaultPostHeaders=t.defaultGetHeaders=t.allSame=t.arrEvery=t.arrFilter=t.arrMap=t.safeArrForEach=t.arrForEach=t.forInOwnNonNullProperties=t.valuesArray=t.keysArray=t.arrWithoutValue=t.arrDeleteValue=t.arrIn=t.arrIndexOf=t.arrSubtract=t.arrIntersectOb=t.arrIntersect=t.intersect=t.containsValue=t.inherits=t.prototypicalClone=t.shallowClone=t.isEmptyArg=t.isOnlyPropIn=t.isEmpty=t.isObject=t.ensureArray=t.isArray=t.copy=t.mixin=void 0,t.getGlobalObject=t.getJitterCoefficient=t.getBackoffCoefficient=void 0;var o=n(1),l=o.__importDefault(n(0)),c=o.__importDefault(n(8));function u(X){return Math.floor(Math.random()*X.length)}function f(X){for(var ot=[],lt=1;lt<arguments.length;lt++)ot[lt-1]=arguments[lt];for(var gt=0;gt<ot.length;gt++){var Dt=ot[gt];if(!Dt)break;var ge=Object.prototype.hasOwnProperty;for(var er in Dt)(!ge||ge.call(Dt,er))&&(X[er]=Dt[er])}return X}t.mixin=f;function m(X){return f({},X)}t.copy=m,t.isArray=Array.isArray||function(X){return Object.prototype.toString.call(X)=="[object Array]"};function E(X){return I(X)?[]:t.isArray(X)?X:[X]}t.ensureArray=E;function O(X){return Object.prototype.toString.call(X)=="[object Object]"}t.isObject=O;function d(X){for(var ot in X)return!1;return!0}t.isEmpty=d;function A(X,ot){for(var lt in X)if(lt!==ot)return!1;return!0}t.isOnlyPropIn=A;function I(X){return X==null}t.isEmptyArg=I;function M(X){var ot=new Object;for(var lt in X)ot[lt]=X[lt];return ot}t.shallowClone=M;function C(X,ot){var lt=function(){function Dt(){}return Dt}();lt.prototype=X;var gt=new lt;return ot&&f(gt,ot),gt}t.prototypicalClone=C;var S=function(X,ot){if(l.default.Config.inherits){l.default.Config.inherits(X,ot);return}X.super_=ot,X.prototype=C(ot.prototype,{constructor:X})};t.inherits=S;function w(X,ot){for(var lt in X)if(X[lt]==ot)return!0;return!1}t.containsValue=w;function p(X,ot){return t.isArray(ot)?y(X,ot):g(X,ot)}t.intersect=p;function y(X,ot){for(var lt=[],gt=0;gt<X.length;gt++){var Dt=X[gt];t.arrIndexOf(ot,Dt)!=-1&&lt.push(Dt)}return lt}t.arrIntersect=y;function g(X,ot){for(var lt=[],gt=0;gt<X.length;gt++){var Dt=X[gt];Dt in ot&&lt.push(Dt)}return lt}t.arrIntersectOb=g;function v(X,ot){for(var lt=[],gt=0;gt<X.length;gt++){var Dt=X[gt];t.arrIndexOf(ot,Dt)==-1&&lt.push(Dt)}return lt}t.arrSubtract=v,t.arrIndexOf=Array.prototype.indexOf?function(X,ot,lt){return X.indexOf(ot,lt)}:function(X,ot,lt){lt=lt||0;for(var gt=X.length;lt<gt;lt++)if(X[lt]===ot)return lt;return-1};function h(X,ot){return t.arrIndexOf(X,ot)!==-1}t.arrIn=h;function T(X,ot){var lt=t.arrIndexOf(X,ot),gt=lt!=-1;return gt&&X.splice(lt,1),gt}t.arrDeleteValue=T;function x(X,ot){var lt=X.slice();return T(lt,ot),lt}t.arrWithoutValue=x;function L(X,ot){var lt=[];for(var gt in X)ot&&!Object.prototype.hasOwnProperty.call(X,gt)||lt.push(gt);return lt}t.keysArray=L;function z(X,ot){var lt=[];for(var gt in X)ot&&!Object.prototype.hasOwnProperty.call(X,gt)||lt.push(X[gt]);return lt}t.valuesArray=z;function H(X,ot){for(var lt in X)Object.prototype.hasOwnProperty.call(X,lt)&&X[lt]&&ot(lt)}t.forInOwnNonNullProperties=H,t.arrForEach=Array.prototype.forEach?function(X,ot){X.forEach(ot)}:function(X,ot){for(var lt=X.length,gt=0;gt<lt;gt++)ot(X[gt],gt,X)};function F(X,ot){return t.arrForEach(X.slice(),ot)}t.safeArrForEach=F,t.arrMap=Array.prototype.map?function(X,ot){return X.map(ot)}:function(X,ot){for(var lt=[],gt=X.length,Dt=0;Dt<gt;Dt++)lt.push(ot(X[Dt],Dt,X));return lt},t.arrFilter=Array.prototype.filter?function(X,ot){return X.filter(ot)}:function(X,ot){for(var lt=[],gt=X.length,Dt=0;Dt<gt;Dt++)ot(X[Dt])&&lt.push(X[Dt]);return lt},t.arrEvery=Array.prototype.every?function(X,ot){return X.every(ot)}:function(X,ot){for(var lt=X.length,gt=0;gt<lt;gt++)if(!ot(X[gt],gt,X))return!1;return!0};function R(X,ot){if(X.length===0)return!0;var lt=X[0][ot];return t.arrEvery(X,function(gt){return gt[ot]===lt})}t.allSame=R;var P={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function $(X){var ot=P[X||_t.json];return{accept:ot,"X-Ably-Version":c.default.apiVersion,"Ably-Agent":c.default.agent}}t.defaultGetHeaders=$;function W(X){var ot,lt=ot=P[X||_t.json];return{accept:lt,"content-type":ot,"X-Ably-Version":c.default.apiVersion,"Ably-Agent":c.default.agent}}t.defaultPostHeaders=W;function Z(X){return X.splice(u(X),1)[0]}t.arrPopRandomElement=Z;function et(X){var ot=[];if(X)for(var lt in X)ot.push(encodeURIComponent(lt)+"="+encodeURIComponent(X[lt]));return ot.length?"?"+ot.join("&"):""}t.toQueryString=et;function Y(X){for(var ot,lt=/([^?&=]+)=?([^&]*)/g,gt={};ot=lt.exec(X);)gt[decodeURIComponent(ot[1])]=decodeURIComponent(ot[2]);return gt}t.parseQueryString=Y,t.now=Date.now||function(){return new Date().getTime()};function G(X){return X.constructor.name=="ErrorInfo"}t.isErrorInfo=G;function N(X){var ot,lt;return X instanceof Error||((lt=(ot=X)===null||ot===void 0?void 0:ot.constructor)===null||lt===void 0?void 0:lt.name)==="ErrorInfo"?l.default.Config.inspect(X):X.toString()}t.inspectError=N;function U(X){return l.default.BufferUtils.isBuffer(X)?X.toString():typeof X=="string"?X:l.default.Config.inspect(X)}t.inspectBody=U;function K(X){if(l.default.BufferUtils.isBuffer(X))return l.default.BufferUtils.byteLength(X);if(typeof X=="string")return l.default.Config.stringByteSize(X);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof X)}t.dataSizeBytes=K;function j(){return String(Math.random()).substr(2)}t.cheapRandStr=j;var nt=function(X){if(l.default.Config.getRandomValues&&typeof Uint8Array!="undefined"){var ot=new Uint8Array(X);return l.default.Config.getRandomValues(ot),l.default.BufferUtils.base64Encode(ot)}for(var lt=l.default.BufferUtils.base64CharSet,gt=Math.round(X*4/3),Dt="",ge=0;ge<gt;ge++)Dt+=lt[u(lt)];return Dt};t.randomString=nt;var ct=function(X){if(l.default.Config.getRandomValues&&typeof Uint8Array!="undefined"){var ot=new Uint8Array(X);return l.default.Config.getRandomValues(ot),l.default.BufferUtils.hexEncode(ot)}for(var lt=l.default.BufferUtils.hexCharSet,gt=X*2,Dt="",ge=0;ge<gt;ge++)Dt+=lt[u(lt)];return Dt};t.randomHexString=ct;function Et(X,ot){for(var lt=Math.min(ot,X.length),gt=X.slice(),Dt=[],ge=0;ge<lt;ge++)Dt.push(Z(gt));return Dt}t.arrChooseN=Et,t.trim=String.prototype.trim?function(X){return X.trim()}:function(X){return X.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function bt(X,ot,lt){return new Promise(function(gt,Dt){X[ot].apply(X,o.__spreadArray(o.__spreadArray([],lt),[function(ge,er){ge?Dt(ge):gt(er)}]))})}t.promisify=bt;var _t;(function(X){X.msgpack="msgpack",X.json="json"})(_t=t.Format||(t.Format={}));function Kt(X,ot){return ot=="msgpack"?l.default.Config.msgpack.decode(X):JSON.parse(String(X))}t.decodeBody=Kt;function pt(X,ot){return ot=="msgpack"?l.default.Config.msgpack.encode(X,!0):JSON.stringify(X)}t.encodeBody=pt;function Vt(X){return X.map(function(ot){return ot&&ot.toLowerCase()})}t.allToLowerCase=Vt;function Se(X){return X.map(function(ot){return ot&&ot.toUpperCase()})}t.allToUpperCase=Se;function Xt(X){return Math.min((X+2)/3,2)}t.getBackoffCoefficient=Xt;function se(){return 1-Math.random()*.2}t.getJitterCoefficient=se;function Ne(){return i||(typeof window!="undefined"?window:self)}t.getGlobalObject=Ne}).call(this,n(12))},function(s,t,n){"use strict";(function(i){t.__esModule=!0;var o=n(1),l=o.__importDefault(n(0)),c=i||(typeof window!="undefined"?window:self),u;(function(d){d[d.None=0]="None",d[d.Error=1]="Error",d[d.Major=2]="Major",d[d.Minor=3]="Minor",d[d.Micro=4]="Micro"})(u||(u={}));function f(d,A){return(""+d).padStart(A?3:2,"0")}function m(d){return l.default.Config.logTimestamps?function(A){var I=new Date;d(f(I.getHours())+":"+f(I.getMinutes())+":"+f(I.getSeconds())+"."+f(I.getMilliseconds(),1)+" "+A)}:d}var E=function(){var d,A,I,M;return typeof Window=="undefined"&&typeof WorkerGlobalScope=="undefined"||typeof((A=(d=c==null?void 0:c.console)===null||d===void 0?void 0:d.log)===null||A===void 0?void 0:A.apply)=="function"?(I=function(){for(var C=[],S=0;S<arguments.length;S++)C[S]=arguments[S]},M=console.warn?function(){for(var C=[],S=0;S<arguments.length;S++)C[S]=arguments[S]}:I):c!=null&&c.console.log?I=M=function(){Function.prototype.apply.call(console.log,console,arguments)}:I=M=function(){},[I,M].map(m)},O=function(){function d(){d.logLevel=d.LOG_DEFAULT}return d.initLogHandlers=function(){var A=E(),I=A[0],M=A[1];this.logHandler=I,this.logErrorHandler=M},d.logLevel=u.Error,d.LOG_NONE=u.None,d.LOG_ERROR=u.Error,d.LOG_MAJOR=u.Major,d.LOG_MINOR=u.Minor,d.LOG_MICRO=u.Micro,d.LOG_DEFAULT=u.Error,d.LOG_DEBUG=u.Micro,d.logAction=function(A,I,M){d.shouldLog(A)&&(A===u.Error?d.logErrorHandler:d.logHandler)("Ably: "+I+": "+M)},d.deprecated=function(A,I){d.deprecatedWithMsg(A,"Please use '"+I+"' instead.")},d.deprecatedWithMsg=function(A,I){d.shouldLog(u.Error)&&d.logErrorHandler("Ably: Deprecation warning - '"+A+"' is deprecated and will be removed from a future version. "+I)},d.shouldLog=function(A){return A<=d.logLevel},d.setLog=function(A,I){A!==void 0&&(d.logLevel=A),I!==void 0&&(d.logHandler=d.logErrorHandler=I)},d}();t.default=O}).call(this,n(12))},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(){if(typeof ArrayBuffer=="function"){var o=i,l=o.lib,c=l.WordArray,u=c.init,f=c.init=function(m){if(m instanceof ArrayBuffer&&(m=new Uint8Array(m)),(m instanceof Int8Array||typeof Uint8ClampedArray!="undefined"&&m instanceof Uint8ClampedArray||m instanceof Int16Array||m instanceof Uint16Array||m instanceof Int32Array||m instanceof Uint32Array||m instanceof Float32Array||m instanceof Float64Array)&&(m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength)),m instanceof Uint8Array){for(var E=m.byteLength,O=[],d=0;d<E;d++)O[d>>>2]|=m[d]<<24-d%4*8;u.call(this,O,E)}else u.apply(this,arguments)};f.prototype=c}}(),i.lib.WordArray})},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(0)),l=i.__importStar(n(2)),c=function(){function u(f,m,E,O){this.message=f,this.code=m,this.statusCode=E,this.cause=O}return u.prototype.toString=function(){var f="["+this.constructor.name;return this.message&&(f+=": "+this.message),this.statusCode&&(f+="; statusCode="+this.statusCode),this.code&&(f+="; code="+this.code),this.cause&&(f+="; cause="+l.inspectError(this.cause)),this.href&&!(this.message&&this.message.indexOf("help.ably.io")>-1)&&(f+="; see "+this.href+" "),f+="]",f},u.fromValues=function(f){var m=f,E=m.message,O=m.code,d=m.statusCode;if(typeof E!="string"||typeof O!="number"||typeof d!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+o.default.Config.inspect(f));var A=Object.assign(new u(E,O,d),f);return A.code&&!A.href&&(A.href="https://help.ably.io/error/"+A.code),A},u}();t.default=c},function(s,t,n){(function(i){(function(o,l){s.exports=t=l()})(this,function(){var o=o||function(l,c){var u;if(typeof window!="undefined"&&window.crypto&&(u=window.crypto),!u&&typeof window!="undefined"&&window.msCrypto&&(u=window.msCrypto),!u&&typeof i!="undefined"&&i.crypto&&(u=i.crypto),!u)try{u=n(44)}catch(g){}var f=function(){if(u){if(typeof u.getRandomValues=="function")try{return u.getRandomValues(new Uint32Array(1))[0]}catch(g){}if(typeof u.randomBytes=="function")try{return u.randomBytes(4).readInt32LE()}catch(g){}}throw new Error("Native crypto module could not be used to get secure random number.")},m=Object.create||function(){function g(){}return function(v){var h;return g.prototype=v,h=new g,g.prototype=null,h}}(),E={},O=E.lib={},d=O.Base=function(){return{extend:function(g){var v=m(this);return g&&v.mixIn(g),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var v in g)g.hasOwnProperty(v)&&(this[v]=g[v]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),A=O.WordArray=d.extend({init:function(g,v){g=this.words=g||[],v!=c?this.sigBytes=v:this.sigBytes=g.length*4},toString:function(g){return(g||M).stringify(this)},concat:function(g){var v=this.words,h=g.words,T=this.sigBytes,x=g.sigBytes;if(this.clamp(),T%4)for(var L=0;L<x;L++){var z=h[L>>>2]>>>24-L%4*8&255;v[T+L>>>2]|=z<<24-(T+L)%4*8}else for(var L=0;L<x;L+=4)v[T+L>>>2]=h[L>>>2];return this.sigBytes+=x,this},clamp:function(){var g=this.words,v=this.sigBytes;g[v>>>2]&=4294967295<<32-v%4*8,g.length=l.ceil(v/4)},clone:function(){var g=d.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var v=[],h=0;h<g;h+=4)v.push(f());return new A.init(v,g)}}),I=E.enc={},M=I.Hex={stringify:function(g){for(var v=g.words,h=g.sigBytes,T=[],x=0;x<h;x++){var L=v[x>>>2]>>>24-x%4*8&255;T.push((L>>>4).toString(16)),T.push((L&15).toString(16))}return T.join("")},parse:function(g){for(var v=g.length,h=[],T=0;T<v;T+=2)h[T>>>3]|=parseInt(g.substr(T,2),16)<<24-T%8*4;return new A.init(h,v/2)}},C=I.Latin1={stringify:function(g){for(var v=g.words,h=g.sigBytes,T=[],x=0;x<h;x++){var L=v[x>>>2]>>>24-x%4*8&255;T.push(String.fromCharCode(L))}return T.join("")},parse:function(g){for(var v=g.length,h=[],T=0;T<v;T++)h[T>>>2]|=(g.charCodeAt(T)&255)<<24-T%4*8;return new A.init(h,v)}},S=I.Utf8={stringify:function(g){try{return decodeURIComponent(escape(C.stringify(g)))}catch(v){throw new Error("Malformed UTF-8 data")}},parse:function(g){return C.parse(unescape(encodeURIComponent(g)))}},w=O.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new A.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=S.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var v,h=this._data,T=h.words,x=h.sigBytes,L=this.blockSize,z=L*4,H=x/z;g?H=l.ceil(H):H=l.max((H|0)-this._minBufferSize,0);var F=H*L,R=l.min(F*4,x);if(F){for(var P=0;P<F;P+=L)this._doProcessBlock(T,P);v=T.splice(0,F),h.sigBytes-=R}return new A.init(v,R)},clone:function(){var g=d.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0}),p=O.Hasher=w.extend({cfg:d.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){g&&this._append(g);var v=this._doFinalize();return v},blockSize:512/32,_createHelper:function(g){return function(v,h){return new g.init(h).finalize(v)}},_createHmacHelper:function(g){return function(v,h){return new y.HMAC.init(g,h).finalize(v)}}}),y=E.algo={};return E}(Math);return o})}).call(this,n(12))},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(3)),c=i.__importDefault(n(0));function u(E,O,d){try{O.apply(E,d)}catch(A){l.default.logAction(l.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+A+"; stack = "+(A&&A.stack))}}function f(E,O,d){for(var A,I,M,C=0;C<E.length;C++)if(A=E[C],d&&(A=A[d]),o.isArray(A)){for(;(I=o.arrIndexOf(A,O))!==-1;)A.splice(I,1);d&&A.length===0&&delete E[C][d]}else if(o.isObject(A))for(M in A)Object.prototype.hasOwnProperty.call(A,M)&&o.isArray(A[M])&&f([A],O,M)}var m=function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var O=this,d=[],A=0;A<arguments.length;A++)d[A]=arguments[A];if(d.length===1){var I=d[0];if(typeof I=="function")this.any.push(I);else throw new Error("EventListener.on(): Invalid arguments: "+c.default.Config.inspect(d))}if(d.length===2){var M=d[0],C=d[1];if(typeof C!="function")throw new Error("EventListener.on(): Invalid arguments: "+c.default.Config.inspect(d));if(o.isEmptyArg(M))this.any.push(C);else if(o.isArray(M))M.forEach(function(w){O.on(w,C)});else{if(typeof M!="string")throw new Error("EventListener.on(): Invalid arguments: "+c.default.Config.inspect(d));var S=this.events[M]||(this.events[M]=[]);S.push(C)}}},E.prototype.off=function(){for(var O,d=this,A=[],I=0;I<arguments.length;I++)A[I]=arguments[I];if(A.length==0||o.isEmptyArg(A[0])&&o.isEmptyArg(A[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var M=A[0],C=A[1],S=null,w=null;if(A.length===1||!C)typeof M=="function"?S=M:w=M;else{if(typeof C!="function")throw new Error("EventEmitter.off(): invalid arguments:"+c.default.Config.inspect(A));O=[M,C],w=O[0],S=O[1]}if(S&&o.isEmptyArg(w)){f([this.any,this.events,this.anyOnce,this.eventsOnce],S);return}if(o.isArray(w)){w.forEach(function(p){d.off(p,S)});return}if(typeof w!="string")throw new Error("EventEmitter.off(): invalid arguments:"+c.default.Config.inspect(A));S?f([this.events,this.eventsOnce],S,w):(delete this.events[w],delete this.eventsOnce[w])},E.prototype.listeners=function(O){if(O){var d=this.events[O]||[];return this.eventsOnce[O]&&Array.prototype.push.apply(d,this.eventsOnce[O]),d.length?d:null}return this.any.length?this.any:null},E.prototype.emit=function(O){for(var d=[],A=1;A<arguments.length;A++)d[A-1]=arguments[A];var I={event:O},M=[];this.anyOnce.length&&(Array.prototype.push.apply(M,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(M,this.any);var C=this.eventsOnce[O];C&&(Array.prototype.push.apply(M,C),delete this.eventsOnce[O]);var S=this.events[O];S&&Array.prototype.push.apply(M,S),o.arrForEach(M,function(w){u(I,w,d)})},E.prototype.once=function(){for(var O=this,d=[],A=0;A<arguments.length;A++)d[A]=arguments[A];var I=d.length;if((I===0||I===1&&typeof d[0]!="function")&&c.default.Config.Promise){var M=d[0];if(typeof M!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+c.default.Config.inspect(d));return new c.default.Config.Promise(function(g){O.once(M,g)})}var C=d[0],S=d[1];if(d.length===1&&typeof C=="function")this.anyOnce.push(C);else if(o.isEmptyArg(C)){if(typeof S!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+c.default.Config.inspect(d));this.anyOnce.push(S)}else if(o.isArray(C)){var w=this,p=function(){var g=Array.prototype.slice.call(arguments);if(o.arrForEach(C,function(v){w.off(v,p)}),typeof S!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+c.default.Config.inspect(d));S.apply(this,g)};o.arrForEach(C,function(g){w.on(g,p)})}else{if(typeof C!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+c.default.Config.inspect(d));var y=this.eventsOnce[C]||(this.eventsOnce[C]=[]);if(S){if(typeof S!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+c.default.Config.inspect(d));y.push(S)}}},E.prototype.whenState=function(O,d,A){for(var I=this,M=[],C=3;C<arguments.length;C++)M[C-3]=arguments[C];var S={event:O};if(typeof O!="string"||typeof d!="string")throw"whenState requires a valid event String argument";if(typeof A!="function"&&c.default.Config.Promise)return new c.default.Config.Promise(function(w){E.prototype.whenState.apply(I,[O,d,w].concat(M))});O===d?u(S,A,M):this.once(O,A)},E}();t.default=m},function(s,t,n){"use strict";t.__esModule=!0,t.getDefaults=t.normaliseOptions=t.objectifyOptions=t.getHosts=t.getFallbackHosts=t.environmentFallbackHosts=t.getHttpScheme=t.getPort=t.getHost=void 0;var i=n(1),o=i.__importDefault(n(0)),l=i.__importStar(n(2)),c=i.__importDefault(n(3)),u=i.__importDefault(n(5)),f=n(42),m="ably-js/"+f.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:f.version,apiVersion:"1.2",agent:m,getHost:O,getPort:d,getHttpScheme:A,environmentFallbackHosts:I,getFallbackHosts:M,getHosts:C,checkHost:S,objectifyOptions:y,normaliseOptions:g};function O(h,T,x){return x?T=T==h.restHost&&h.realtimeHost||T||h.realtimeHost:T=T||h.restHost,T}t.getHost=O;function d(h,T){return T||h.tls?h.tlsPort:h.port}t.getPort=d;function A(h){return h.tls?"https://":"http://"}t.getHttpScheme=A;function I(h){return[h+"-a-fallback.ably-realtime.com",h+"-b-fallback.ably-realtime.com",h+"-c-fallback.ably-realtime.com",h+"-d-fallback.ably-realtime.com",h+"-e-fallback.ably-realtime.com"]}t.environmentFallbackHosts=I;function M(h){var T=h.fallbackHosts,x=typeof h.httpMaxRetryCount!="undefined"?h.httpMaxRetryCount:E.httpMaxRetryCount;return T?l.arrChooseN(T,x):[]}t.getFallbackHosts=M;function C(h){return[h.restHost].concat(M(h))}t.getHosts=C;function S(h){if(typeof h!="string")throw new u.default("host must be a string; was a "+typeof h,4e4,400);if(!h.length)throw new u.default("host must not be zero-length",4e4,400)}function w(h,T,x){return h.realtimeHost?h.realtimeHost:h.restHost?(c.default.logAction(c.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+h.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+h.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),h.restHost):T?E.REALTIME_HOST:x+"-"+E.REALTIME_HOST}function p(h){var T={};for(var x in E.TIMEOUTS)T[x]=h[x]||E.TIMEOUTS[x];return T}function y(h){return typeof h=="string"?h.indexOf(":")==-1?{token:h}:{key:h}:h}t.objectifyOptions=y;function g(h){if(h.host&&(c.default.deprecated("host","restHost"),h.restHost=h.host),h.wsHost&&(c.default.deprecated("wsHost","realtimeHost"),h.realtimeHost=h.wsHost),h.queueEvents&&(c.default.deprecated("queueEvents","queueMessages"),h.queueMessages=h.queueEvents),h.fallbackHostsUseDefault){if(h.fallbackHosts){var T="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw c.default.logAction(c.default.LOG_ERROR,"Defaults.normaliseOptions",T),new u.default(T,4e4,400)}if(h.port||h.tlsPort){var T="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw c.default.logAction(c.default.LOG_ERROR,"Defaults.normaliseOptions",T),new u.default(T,4e4,400)}h.environment?c.default.deprecatedWithMsg("fallbackHostsUseDefault","There is no longer a need to set this when the environment option is also set since the library will now generate the correct fallback hosts using the environment option."):c.default.deprecated("fallbackHostsUseDefault","fallbackHosts: Ably.Defaults.FALLBACK_HOSTS"),h.fallbackHosts=E.FALLBACK_HOSTS}h.recover===!0&&(c.default.deprecated("{recover: true}","{recover: function(lastConnectionDetails, cb) { cb(true); }}"),h.recover=function($,W){W(!0)}),typeof h.recover=="function"&&h.closeOnUnload===!0&&(c.default.logAction(c.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),h.recover=void 0),"closeOnUnload"in h||(h.closeOnUnload=!h.recover),h.transports&&l.arrIn(h.transports,"xhr")&&(c.default.deprecated('transports: ["xhr"]','transports: ["xhr_streaming"]'),l.arrDeleteValue(h.transports,"xhr"),h.transports.push("xhr_streaming")),"queueMessages"in h||(h.queueMessages=!0);var x=h.environment&&String(h.environment).toLowerCase()||E.ENVIRONMENT,L=!x||x==="production";!h.fallbackHosts&&!h.restHost&&!h.realtimeHost&&!h.port&&!h.tlsPort&&(h.fallbackHosts=L?E.FALLBACK_HOSTS:I(x));var z=h.restHost||(L?E.REST_HOST:x+"-"+E.REST_HOST),H=w(h,L,x);l.arrForEach((h.fallbackHosts||[]).concat(z,H),S),h.port=h.port||E.PORT,h.tlsPort=h.tlsPort||E.TLS_PORT,"tls"in h||(h.tls=!0);var F=p(h);if("useBinaryProtocol"in h?h.useBinaryProtocol=o.default.Config.supportsBinary&&h.useBinaryProtocol:h.useBinaryProtocol=o.default.Config.preferBinary,h.clientId){var R=h.headers=h.headers||{};R["X-Ably-ClientId"]=o.default.BufferUtils.base64Encode(o.default.BufferUtils.utf8Encode(h.clientId))}if("idempotentRestPublishing"in h||(h.idempotentRestPublishing=!0),h.promises&&!o.default.Config.Promise&&(c.default.logAction(c.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),h.promises=!1),h.agents)for(var P in h.agents)E.agent+=" "+P+"/"+h.agents[P];return i.__assign(i.__assign({},h),{useBinaryProtocol:"useBinaryProtocol"in h?o.default.Config.supportsBinary&&h.useBinaryProtocol:o.default.Config.preferBinary,realtimeHost:H,restHost:z,maxMessageSize:h.maxMessageSize||E.maxMessageSize,timeouts:F})}t.normaliseOptions=g,t.default=E;function v(h){return Object.assign(E,h)}t.getDefaults=v},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(0)),l=i.__importDefault(n(3)),c=i.__importDefault(n(5)),u=i.__importStar(n(2));function f(d){return!d||!d.channelOptions?{channelOptions:d,plugins:{},baseEncodedPreviousPayload:void 0}:d}function m(d){if(d&&d.cipher&&!d.cipher.channelCipher){if(!o.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=o.default.Crypto.getCipher(d.cipher);return{cipher:A.cipherParams,channelCipher:A.cipher}}return d}function E(d){var A=0;return d.name&&(A+=d.name.length),d.clientId&&(A+=d.clientId.length),d.extras&&(A+=JSON.stringify(d.extras).length),d.data&&(A+=u.dataSizeBytes(d.data)),A}var O=function(){function d(){}return d.prototype.toJSON=function(){var A=this.encoding,I=this.data;return I&&o.default.BufferUtils.isBuffer(I)&&(arguments.length>0?(A=A?A+"/base64":"base64",I=o.default.BufferUtils.base64Encode(I)):I=o.default.BufferUtils.toBuffer(I)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:A,data:I}},d.prototype.toString=function(){var A="[Message";return this.name&&(A+="; name="+this.name),this.id&&(A+="; id="+this.id),this.timestamp&&(A+="; timestamp="+this.timestamp),this.clientId&&(A+="; clientId="+this.clientId),this.connectionId&&(A+="; connectionId="+this.connectionId),this.encoding&&(A+="; encoding="+this.encoding),this.extras&&(A+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?A+="; data="+this.data:o.default.BufferUtils.isBuffer(this.data)?A+="; data (buffer)="+o.default.BufferUtils.base64Encode(this.data):A+="; data (json)="+JSON.stringify(this.data)),this.extras&&(A+="; extras="+JSON.stringify(this.extras)),A+="]",A},d.encrypt=function(A,I,M){var C=A.data,S=A.encoding,w=I.channelCipher;S=S?S+"/":"",o.default.BufferUtils.isBuffer(C)||(C=o.default.BufferUtils.utf8Encode(String(C)),S=S+"utf-8/"),w.encrypt(C,function(p,y){if(p){M(p);return}A.data=y,A.encoding=S+"cipher+"+w.algorithm,M(null,A)})},d.encode=function(A,I,M){var C=A.data,S=typeof C=="string"||o.default.BufferUtils.isBuffer(C)||C===null||C===void 0;if(!S)if(u.isObject(C)||u.isArray(C))A.data=JSON.stringify(C),A.encoding=A.encoding?A.encoding+"/json":"json";else throw new c.default("Data type is unsupported",40013,400);I!=null&&I.cipher?d.encrypt(A,I,M):M(null,A)},d.encodeArray=function(A,I,M){for(var C=0,S=0;S<A.length;S++)d.encode(A[S],I,function(w){if(w){M(w);return}C++,C==A.length&&M(null,A)})},d.decode=function(A,I){var M=f(I),C=A.data,S=A.encoding;if(S){var w=S.split("/"),p=void 0,y=w.length,g=A.data,v="";try{for(;(p=y)>0;){var h=w[--y].match(/([-\w]+)(\+([\w-]+))?/);if(!h)break;switch(v=h[1],v){case"base64":g=o.default.BufferUtils.base64Decode(String(g)),p==w.length&&(C=g);continue;case"utf-8":g=o.default.BufferUtils.utf8Decode(g);continue;case"json":g=JSON.parse(g);continue;case"cipher":if(M.channelOptions!=null&&M.channelOptions.cipher&&M.channelOptions.channelCipher){var T=h[3],x=M.channelOptions.channelCipher;if(T!=x.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");g=x.decrypt(g);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!M.plugins||!M.plugins.vcdiff)throw new c.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array=="undefined")throw new c.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var L=M.baseEncodedPreviousPayload;typeof L=="string"&&(L=o.default.BufferUtils.utf8Encode(L)),L=o.default.BufferUtils.toBuffer(L),g=o.default.BufferUtils.toBuffer(g),g=o.default.BufferUtils.typedArrayToBuffer(M.plugins.vcdiff.decode(g,L)),C=g}catch(H){throw new c.default("Vcdiff delta decode failed with "+H,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(H){var z=H;throw new c.default("Error processing the "+v+" encoding, decoder returned \u2018"+z.message+"\u2019",z.code||40013,400)}finally{A.encoding=p<=0?null:w.slice(0,p).join("/"),A.data=g}}M.baseEncodedPreviousPayload=C},d.fromResponseBody=function(A,I,M){M&&(A=u.decodeBody(A,M));for(var C=0;C<A.length;C++){var S=A[C]=d.fromValues(A[C]);try{d.decode(S,I)}catch(w){l.default.logAction(l.default.LOG_ERROR,"Message.fromResponseBody()",w.toString())}}return A},d.fromValues=function(A){return Object.assign(new d,A)},d.fromValuesArray=function(A){for(var I=A.length,M=new Array(I),C=0;C<I;C++)M[C]=d.fromValues(A[C]);return M},d.fromEncoded=function(A,I){var M=d.fromValues(A),C=m(I);try{d.decode(M,C)}catch(S){l.default.logAction(l.default.LOG_ERROR,"Message.fromEncoded()",S.toString())}return M},d.fromEncodedArray=function(A,I){return m(I),A.map(function(M){return d.fromEncoded(M,I)})},d.getMessagesSize=function(A){for(var I,M=0,C=0;C<A.length;C++)I=A[C],M+=I.size||(I.size=E(I));return M},d.serialize=u.encodeBody,d}();t.default=O},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(5)),c=i.__importDefault(n(9)),u=i.__importDefault(n(14)),f={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17},m=[];Object.keys(f).forEach(function(M){m[f[M]]=M});var E={HAS_PRESENCE:1<<0,HAS_BACKLOG:1<<1,RESUMED:1<<2,TRANSIENT:1<<4,ATTACH_RESUME:1<<5,PRESENCE:1<<16,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},O=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function d(M){var C=[];if(M)for(var S=0;S<M.length;S++)C.push(M[S].toString());return"[ "+C.join(", ")+" ]"}var A="id channel channelSerial connectionId connectionKey connectionSerial count msgSerial timestamp".split(" "),I=function(){function M(){var C=this;this.hasFlag=function(S){return(C.flags&E[S])>0}}return M.prototype.setFlag=function(C){return this.flags=this.flags|E[C]},M.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},M.prototype.encodeModesToFlags=function(C){var S=this;C.forEach(function(w){return S.setFlag(w)})},M.prototype.decodeModesFromFlags=function(){var C=this,S=[];return M.channelModes.forEach(function(w){C.hasFlag(w)&&S.push(w)}),S.length>0?S:void 0},M.fromValues=function(C){return Object.assign(new M,C)},M.Action=f,M.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],M.ActionName=m,M.serialize=o.encodeBody,M.deserialize=function(C,S){var w=o.decodeBody(C,S);return M.fromDeserialized(w)},M.fromDeserialized=function(C){var S=C.error;S&&(C.error=l.default.fromValues(S));var w=C.messages;if(w)for(var p=0;p<w.length;p++)w[p]=c.default.fromValues(w[p]);var y=C.presence;if(y)for(var p=0;p<y.length;p++)y[p]=u.default.fromValues(y[p],!0);return Object.assign(new M,C)},M.stringify=function(C){var S="[ProtocolMessage";C.action!==void 0&&(S+="; action="+M.ActionName[C.action]||!1);for(var w,p=0;p<A.length;p++)w=A[p],C[w]!==void 0&&(S+="; "+w+"="+C[w]);if(C.messages&&(S+="; messages="+d(c.default.fromValuesArray(C.messages))),C.presence&&(S+="; presence="+d(u.default.fromValuesArray(C.presence))),C.error&&(S+="; error="+l.default.fromValues(C.error).toString()),C.auth&&C.auth.accessToken&&(S+="; token="+C.auth.accessToken),C.flags&&(S+="; flags="+O.filter(C.hasFlag).join(",")),C.params){var y="";o.forInOwnNonNullProperties(C.params,function(g){y.length>0&&(y+="; "),y+=g+"="+C.params[g]}),y.length>0&&(S+="; params=["+y+"]")}return S+="]",S},M.isDuplicate=function(C,S){if(C&&S&&(C.action===f.MESSAGE||C.action===f.PRESENCE)&&C.action===S.action&&C.channel===S.channel&&C.id===S.id){if(C.action===f.PRESENCE)return!0;if(C.messages.length===S.messages.length){for(var w=0;w<C.messages.length;w++){var p=C.messages[w],y=S.messages[w];if((p.extras&&p.extras.delta&&p.extras.delta.format)!==(y.extras&&y.extras.delta&&y.extras.delta.format))return!1}return!0}}return!1},M}();t.default=I},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(10)),c=i.__importDefault(n(26)),u=i.__importDefault(n(3)),f=i.__importDefault(n(8)),m=i.__importDefault(n(19)),E=i.__importDefault(n(16)),O=i.__importDefault(n(5)),d=i.__importDefault(n(20)),A=i.__importDefault(n(0));function I(S){var w=[80015,80017,80030];return S.code?E.default.isTokenErr(S)?!1:o.arrIn(w,S.code)?!0:S.code>=4e4&&S.code<5e4:!1}function M(S){return I(S)?[l.default.fromValues({action:l.default.Action.ERROR,error:S})]:[l.default.fromValues({action:l.default.Action.DISCONNECTED,error:S})]}var C=function(S){i.__extends(w,S);function w(p,y,g){var v=S.call(this,p,y,g,!0)||this;return v.onAuthUpdated=function(h){v.authParams={access_token:h.token}},v.stream="stream"in g?g.stream:!0,v.sendRequest=null,v.recvRequest=null,v.pendingCallback=null,v.pendingItems=null,v}return w.prototype.connect=function(){var p=this;u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","starting"),c.default.prototype.connect.call(this);var y=this.params,g=y.options,v=f.default.getHost(g,y.host),h=f.default.getPort(g),T=g.tls?"https://":"http://";this.baseUri=T+v+":"+h+"/comet/";var x=this.baseUri+"connect";u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","uri: "+x),this.auth.getAuthParams(function(L,z){if(L){p.disconnect(L);return}if(!p.isDisposed){p.authParams=z;var H=p.params.getConnectParams(z);"stream"in H&&(p.stream=H.stream),u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+o.toQueryString(H));var F=!1,R=p.recvRequest=p.createRequest(x,null,H,null,p.stream?d.default.REQ_RECV_STREAM:d.default.REQ_RECV);R.on("data",function(P){!p.recvRequest||(F||(F=!0,p.emit("preconnect")),p.onData(P))}),R.on("complete",function(P){if(p.recvRequest||(P=P||new O.default("Request cancelled",80003,400)),p.recvRequest=null,!F&&!P&&(F=!0,p.emit("preconnect")),p.onActivity(),P){P.code?p.onData(M(P)):p.disconnect(P);return}A.default.Config.nextTick(function(){p.recv()})}),R.exec()}})},w.prototype.requestClose=function(){u.default.logAction(u.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},w.prototype.requestDisconnect=function(){u.default.logAction(u.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},w.prototype._requestCloseOrDisconnect=function(p){var y=this,g=p?this.closeUri:this.disconnectUri;if(g){var v=this.createRequest(g,null,this.authParams,null,d.default.REQ_SEND);v.on("complete",function(h){h&&(u.default.logAction(u.default.LOG_ERROR,"CometTransport.request"+(p?"Close()":"Disconnect()"),"request returned err = "+o.inspectError(h)),y.finish("disconnected",h))}),v.exec()}},w.prototype.dispose=function(){var p=this;u.default.logAction(u.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(u.default.logAction(u.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",m.default.disconnected),A.default.Config.nextTick(function(){p.emit("disposed")}))},w.prototype.onConnect=function(p){if(!this.isDisposed){var y=p.connectionKey;c.default.prototype.onConnect.call(this,p);var g=this.baseUri+y;u.default.logAction(u.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+g+"; connectionKey = "+p.connectionKey),this.sendUri=g+"/send",this.recvUri=g+"/recv",this.closeUri=g+"/close",this.disconnectUri=g+"/disconnect"}},w.prototype.send=function(p){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(p);return}var y=this.pendingItems||[];y.push(p),this.pendingItems=null,this.sendItems(y)},w.prototype.sendAnyPending=function(){var p=this.pendingItems;!p||(this.pendingItems=null,this.sendItems(p))},w.prototype.sendItems=function(p){var y=this,g=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(p),d.default.REQ_SEND);g.on("complete",function(v,h){if(v&&u.default.logAction(u.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+o.inspectError(v)),y.sendRequest=null,v){v.code?y.onData(M(v)):y.disconnect(v);return}h&&y.onData(h),y.pendingItems&&A.default.Config.nextTick(function(){y.sendRequest||y.sendAnyPending()})}),g.exec()},w.prototype.recv=function(){var p=this;if(!this.recvRequest&&!!this.isConnected){var y=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?d.default.REQ_RECV_STREAM:d.default.REQ_RECV_POLL);y.on("data",function(g){p.onData(g)}),y.on("complete",function(g){if(p.recvRequest=null,p.onActivity(),g){g.code?p.onData(M(g)):p.disconnect(g);return}A.default.Config.nextTick(function(){p.recv()})}),y.exec()}},w.prototype.onData=function(p){try{var y=this.decodeResponse(p);if(y&&y.length)for(var g=0;g<y.length;g++)this.onProtocolMessage(l.default.fromDeserialized(y[g]))}catch(v){u.default.logAction(u.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+v.stack)}},w.prototype.encodeRequest=function(p){return JSON.stringify(p)},w.prototype.decodeResponse=function(p){return typeof p=="string"?JSON.parse(p):p},w}(c.default);t.default=C},function(s,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){typeof window=="object"&&(n=window)}s.exports=n},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(){var o=i,l=o.lib,c=l.WordArray,u=o.enc,f=u.Base64={stringify:function(E){var O=E.words,d=E.sigBytes,A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";E.clamp();for(var I=[],M=0;M<d;M+=3)for(var C=O[M>>>2]>>>24-M%4*8&255,S=O[M+1>>>2]>>>24-(M+1)%4*8&255,w=O[M+2>>>2]>>>24-(M+2)%4*8&255,p=C<<16|S<<8|w,y=0;y<4&&M+y*.75<d;y++)I.push(A.charAt(p>>>6*(3-y)&63));var g=A.charAt(64);if(g)for(;I.length%4;)I.push(g);return I.join("")},parse:function(E){var O=E.length,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var I=0;I<d.length;I++)A[d.charCodeAt(I)]=I}var M=d.charAt(64);if(M){var C=E.indexOf(M);C!==-1&&(O=C)}return m(E,O,A)}};function m(E,O,d){for(var A=[],I=0,M=0;M<O;M++)if(M%4){var C=d[E.charCodeAt(M-1)]<<M%4*2,S=d[E.charCodeAt(M)]>>>6-M%4*2,w=C|S;A[I>>>2]|=w<<24-I%4*8,I++}return c.create(A,I)}}(),i.enc.Base64})},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(3)),l=i.__importDefault(n(0)),c=i.__importDefault(n(9)),u=i.__importStar(n(2));function f(E){return m.Actions.indexOf(E)}var m=function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var O=this.id.split(":");return{connectionId:O[0],msgSerial:parseInt(O[1],10),index:parseInt(O[2],10)}},E.prototype.toJSON=function(){var O=this.data,d=this.encoding;return O&&l.default.BufferUtils.isBuffer(O)&&(arguments.length>0?(d=d?d+"/base64":"base64",O=l.default.BufferUtils.base64Encode(O)):O=l.default.BufferUtils.toBuffer(O)),{clientId:this.clientId,action:f(this.action),data:O,encoding:d}},E.prototype.toString=function(){var O="[PresenceMessage";return O+="; action="+this.action,this.id&&(O+="; id="+this.id),this.timestamp&&(O+="; timestamp="+this.timestamp),this.clientId&&(O+="; clientId="+this.clientId),this.connectionId&&(O+="; connectionId="+this.connectionId),this.encoding&&(O+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?O+="; data="+this.data:l.default.BufferUtils.isBuffer(this.data)?O+="; data (buffer)="+l.default.BufferUtils.base64Encode(this.data):O+="; data (json)="+JSON.stringify(this.data)),O+="]",O},E.fromResponseBody=function(O,d,A){var I=[];A&&(O=u.decodeBody(O,A));for(var M=0;M<O.length;M++){var C=I[M]=E.fromValues(O[M],!0);try{E.decode(C,d)}catch(S){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",S.toString())}}return I},E.fromValues=function(O,d){return d&&(O.action=E.Actions[O.action]),Object.assign(new E,O)},E.fromValuesArray=function(O){for(var d=O.length,A=new Array(d),I=0;I<d;I++)A[I]=E.fromValues(O[I]);return A},E.fromEncoded=function(O,d){var A=E.fromValues(O,!0);try{E.decode(A,d)}catch(I){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromEncoded()",I.toString())}return A},E.fromEncodedArray=function(O,d){return O.map(function(A){return E.fromEncoded(A,d)})},E.Actions=["absent","present","enter","leave","update"],E.encode=c.default.encode,E.decode=c.default.decode,E.getMessagesSize=c.default.getMessagesSize,E}();t.default=m},function(s,t,n){"use strict";(function(i){t.__esModule=!0;var o=n(1),l=o.__importStar(n(2)),c=o.__importDefault(n(7)),u=o.__importDefault(n(5)),f=o.__importDefault(n(3)),m=o.__importDefault(n(8)),E=o.__importDefault(n(20)),O=o.__importDefault(n(0));function d(T,x){return l.arrIn(l.allToLowerCase(l.keysArray(x)),"x-ably-errorcode")}function A(T,x){if(d(T,x))return T.error&&u.default.fromValues(T.error)}var I=function(){},M=0,C={},S=typeof i!="undefined"&&i.XDomainRequest;function w(){var T=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return T&&Number(T[1])}function p(){var T;return S&&(T=w())&&T===10}function y(T,x){return T.getResponseHeader&&T.getResponseHeader(x)}function g(T){return T.getResponseHeader&&(T.getResponseHeader("transfer-encoding")||!T.getResponseHeader("content-length"))}function v(T){for(var x=l.trim(T.getAllResponseHeaders()).split(`\r
`),L={},z=0;z<x.length;z++){var H=x[z].split(":").map(l.trim);L[H[0].toLowerCase()]=H[1]}return L}var h=function(T){o.__extends(x,T);function x(L,z,H,F,R,P,$){var W=T.call(this)||this;return H=H||{},H.rnd=l.cheapRandStr(),p()&&!H.envelope&&(H.envelope="json"),W.uri=L+l.toQueryString(H),W.headers=z||{},W.body=F,W.method=$?$.toUpperCase():l.isEmptyArg(F)?"GET":"POST",W.requestMode=R,W.timeouts=P,W.timedOut=!1,W.requestComplete=!1,W.id=String(++M),C[W.id]=W,W}return x.createRequest=function(L,z,H,F,R,P,$){var W=P||m.default.TIMEOUTS;return new x(L,z,l.copy(H),F,R,W,$)},x.prototype.complete=function(L,z,H,F,R){this.requestComplete||(this.requestComplete=!0,!L&&z&&this.emit("data",z),this.emit("complete",L,z,H,F,R),this.dispose())},x.prototype.abort=function(){this.dispose()},x.prototype.exec=function(){var L=this,z=this.headers,H=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,F=this.timer=setTimeout(function(){L.timedOut=!0,P.abort()},H),R=this.method,P=this.xhr=new XMLHttpRequest,$=z.accept,W=this.body,Z="text";if($?$.indexOf("application/x-msgpack")===0&&(Z="arraybuffer"):z.accept="application/json",W){var et=z["content-type"]||(z["content-type"]="application/json");et.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}P.open(R,this.uri,!0),P.responseType=Z,"authorization"in z&&(P.withCredentials=!0);for(var Y in z)P.setRequestHeader(Y,z[Y]);var G=function(pt,Vt,Se,Xt){var se,Ne=Vt+" (event type: "+pt.type+")";!((se=L==null?void 0:L.xhr)===null||se===void 0)&&se.statusText&&(Ne+=", current statusText is "+L.xhr.statusText),f.default.logAction(f.default.LOG_ERROR,"Request.on"+pt.type+"()",Ne),L.complete(new u.default(Ne,Se,Xt))};P.onerror=function(pt){G(pt,"XHR error occurred",null,400)},P.onabort=function(pt){L.timedOut?G(pt,"Request aborted due to request timeout expiring",null,408):G(pt,"Request cancelled",null,400)},P.ontimeout=function(pt){G(pt,"Request timed out",null,408)};var N,U,K,j=0,nt=!1,ct=function(){if(clearTimeout(F),K=U<400,U==204){L.complete(null,null,null,null,U);return}N=L.requestMode==E.default.REQ_RECV_STREAM&&K&&g(P)},Et=function(){var pt;try{var Vt=y(P,"content-type"),Se=Vt?Vt.indexOf("application/json")>=0:P.responseType=="text";if(Se){var Xt=P.responseType==="arraybuffer"?O.default.BufferUtils.utf8Decode(P.response):String(P.responseText);Xt.length?pt=JSON.parse(Xt):pt=Xt,nt=!0}else pt=P.response;pt.response!==void 0?(U=pt.statusCode,K=U<400,z=pt.headers,pt=pt.response):z=v(P)}catch(Ne){L.complete(new u.default("Malformed response body from server: "+Ne.message,null,400));return}if(K||l.isArray(pt)){L.complete(null,pt,z,nt,U);return}var se=A(pt,z);se||(se=new u.default("Error response received from server: "+U+" body was: "+O.default.Config.inspect(pt),null,U)),L.complete(se,pt,z,nt,U)};function bt(){for(var pt=P.responseText,Vt=pt.length-1,Se,Xt;j<Vt&&(Se=pt.indexOf(`
`,j))>-1;)Xt=pt.slice(j,Se),j=Se+1,_t(Xt)}var _t=function(pt){try{pt=JSON.parse(pt)}catch(Vt){L.complete(new u.default("Malformed response body from server: "+Vt.message,null,400));return}L.emit("data",pt)},Kt=function(){bt(),L.streamComplete=!0,O.default.Config.nextTick(function(){L.complete()})};P.onreadystatechange=function(){var pt=P.readyState;pt<3||P.status!==0&&(U===void 0&&(U=P.status,U===1223&&(U=204),ct()),pt==3&&N?bt():pt==4&&(N?Kt():Et()))},P.send(W)},x.prototype.dispose=function(){var L=this.xhr;if(L){L.onreadystatechange=L.onerror=L.onabort=L.ontimeout=I,this.xhr=null;var z=this.timer;z&&(clearTimeout(z),this.timer=null),this.requestComplete||L.abort()}delete C[this.id]},x}(c.default);t.default=h}).call(this,n(12))},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(3)),l=i.__importStar(n(2)),c=i.__importDefault(n(22)),u=i.__importDefault(n(5)),f=i.__importDefault(n(43)),m=n(13),E=n(32),O=i.__importDefault(n(17)),d=i.__importDefault(n(0)),A=Math.pow(2,17);function I(){}function M(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function C(H){return!!H.connection}function S(H){return l.isErrorInfo(H)?(H.code||(H.statusCode===403?H.code=40300:(H.code=40170,H.statusCode=401)),H):new u.default(l.inspectError(H),H.code||40170,H.statusCode||401)}var w=function(H){return d.default.Config.createHmac?Buffer.from(H,"ascii").toString("base64"):m.stringify(E.parse(H))},p=function(H,F){if(d.default.Config.createHmac){var R=d.default.Config.createHmac("SHA256",F);return R.update(H),R.digest("base64")}return m.stringify(f.default(H,F))};function y(H){if(!H)return"";typeof H=="string"&&(H=JSON.parse(H));var F={},R=l.keysArray(H,!0);if(!R)return"";R.sort();for(var P=0;P<R.length;P++)F[R[P]]=H[R[P]].sort();return JSON.stringify(F)}function g(H){if(H.authCallback)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(H.authUrl)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(H.key)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(H.tokenDetails)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var F="authOptions must include valid authentication parameters";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",F),new Error(F)}}function v(H){return"useTokenAuth"in H&&!H.useTokenAuth}function h(H){return H.useTokenAuth||!v(H)&&(H.authCallback||H.authUrl||H.token||H.tokenDetails)}function T(H){return!H.key&&!H.authCallback&&!H.authUrl}var x=0;function L(){return x++}var z=function(){function H(F,R){if(this.authOptions={},this.client=F,this.tokenParams=R.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,h(R)){if(R.key&&!p){var P="client-side token request signing not supported";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",P),new Error(P)}T(R)&&o.default.logAction(o.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(R.defaultTokenParams,R),g(this.authOptions)}else{if(!R.key){var P="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",P),new u.default(P,40160,401)}o.default.logAction(o.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(R)}}return H.prototype.authorize=function(F,R,P){var $=this,W;if(typeof F=="function"&&!P?(P=F,W=F=null):typeof R=="function"&&!P?(P=R,W=null):W=R,!P&&this.client.options.promises)return l.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new u.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(o.default.logAction(o.default.LOG_ERROR,"Auth.authorize","Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want"),l.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(F,W,function(Z,et){if(Z){$.client.connection&&$.client.connection.connectionManager.actOnErrorFromAuthorize(Z),P==null||P(Z);return}C($.client)?$.client.connection.connectionManager.onAuthUpdated(et,P||I):P==null||P(null,et)})},H.prototype.authorise=function(F,R,P){o.default.deprecated("Auth.authorise","Auth.authorize"),this.authorize(F,R,P)},H.prototype._forceNewToken=function(F,R,P){var $=this;this.tokenDetails=null,this._saveTokenOptions(F,R),g(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,Z){delete $.tokenParams.timestamp,delete $.authOptions.queryTime,P(W,Z)})},H.prototype.requestToken=function(F,R,P){var $=this;if(typeof F=="function"&&!P?(P=F,R=F=null):typeof R=="function"&&!P&&(P=R,R=null),!P&&this.client.options.promises)return l.promisify(this,"requestToken",arguments);R=R||this.authOptions,F=F||l.copy(this.tokenParams);var W=P||I,Z,et=this.client;if(R.authCallback)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),Z=R.authCallback;else if(R.authUrl)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),Z=function(j,nt){var ct=l.mixin({accept:"application/json, text/plain"},R.authHeaders),Et=R.authMethod&&R.authMethod.toLowerCase()==="post",bt,_t=R.authUrl.indexOf("?");_t>-1&&(bt=l.parseQueryString(R.authUrl.slice(_t)),R.authUrl=R.authUrl.slice(0,_t),Et||(R.authParams=l.mixin(bt,R.authParams)));var Kt=l.mixin({},R.authParams||{},j),pt=function(Xt,se,Ne,X){var ot;if(Xt?o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+l.inspectError(Xt)):(ot=Ne["content-type"],o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+ot+"; body: "+l.inspectBody(se))),Xt||X)return nt(Xt,se);if(d.default.BufferUtils.isBuffer(se)&&(se=se.toString()),!ot){nt(new u.default("authUrl response is missing a content-type header",40170,401));return}var lt=ot.indexOf("application/json")>-1,gt=ot.indexOf("text/plain")>-1||ot.indexOf("application/jwt")>-1;if(!lt&&!gt){nt(new u.default("authUrl responded with unacceptable content-type "+ot+", should be either text/plain, application/jwt or application/json",40170,401));return}if(lt){if(se.length>A){nt(new u.default("authUrl response exceeded max permitted length",40170,401));return}try{se=JSON.parse(se)}catch(Dt){nt(new u.default("Unexpected error processing authURL response; err = "+Dt.message,40170,401));return}}nt(null,se,ot)};if(o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+R.authUrl+"; Params: "+JSON.stringify(Kt)+"; method: "+(Et?"POST":"GET")),Et){var Vt=ct||{};Vt["content-type"]="application/x-www-form-urlencoded";var Se=l.toQueryString(Kt).slice(1);$.client.http.doUri(O.default.Post,et,R.authUrl,Vt,Se,bt,pt)}else $.client.http.doUri(O.default.Get,et,R.authUrl,ct||{},null,Kt,pt)};else if(R.key)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),Z=function(j,nt){$.createTokenRequest(j,R,nt)};else{var Y="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";o.default.logAction(o.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new u.default(Y,40171,403));return}"capability"in F&&(F.capability=y(F.capability));var G=function(j,nt){var ct=j.keyName,Et="/keys/"+ct+"/requestToken",bt=function(Kt){return et.baseUri(Kt)+Et},_t=l.defaultPostHeaders();R.requestHeaders&&l.mixin(_t,R.requestHeaders),o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Et+"; Token params: "+JSON.stringify(j)),$.client.http.do(O.default.Post,et,bt,_t,JSON.stringify(j),null,nt)},N=!1,U=this.client.options.timeouts.realtimeRequestTimeout,K=setTimeout(function(){N=!0;var j="Token request callback timed out after "+U/1e3+" seconds";o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",j),W(new u.default(j,40170,401))},U);Z(F,function(j,nt,ct){if(!N){if(clearTimeout(K),j){o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+l.inspectError(j)),W(S(j));return}if(typeof nt=="string"){nt.length===0?W(new u.default("Token string is empty",40170,401)):nt.length>A?W(new u.default("Token string exceeded max permitted length (was "+nt.length+" bytes)",40170,401)):nt==="undefined"||nt==="null"?W(new u.default("Token string was literal null/undefined",40170,401)):nt[0]==="{"&&!(ct&&ct.indexOf("application/jwt")>-1)?W(new u.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:nt});return}if(typeof nt!="object"){var Et="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof nt;o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",Et),W(new u.default(Et,40170,401));return}var bt=JSON.stringify(nt).length;if(bt>A&&!R.suppressMaxLengthCheck){W(new u.default("Token request/details object exceeded max permitted stringified size (was "+bt+" bytes)",40170,401));return}if("issued"in nt){W(null,nt);return}if(!("keyName"in nt)){var Et="Expected token request callback to call back with a token string, token request object, or token details object";o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",Et),W(new u.default(Et,40170,401));return}G(nt,function(_t,Kt,pt,Vt){if(_t){o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+l.inspectError(_t)),W(S(_t));return}Vt||(Kt=JSON.parse(Kt)),o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,Kt)})}})},H.prototype.createTokenRequest=function(F,R,P){var $=this;if(typeof F=="function"&&!P?(P=F,R=F=null):typeof R=="function"&&!P&&(P=R,R=null),!P&&this.client.options.promises)return l.promisify(this,"createTokenRequest",arguments);R=R||this.authOptions,F=F||l.copy(this.tokenParams);var W=R.key;if(!W){P(new u.default("No key specified",40101,403));return}var Z=W.split(":"),et=Z[0],Y=Z[1];if(!Y){P(new u.default("Invalid key specified",40101,403));return}if(F.clientId===""){P(new u.default("clientId can\u2019t be an empty string",40012,400));return}"capability"in F&&(F.capability=y(F.capability));var G=l.mixin({keyName:et},F),N=F.clientId||"",U=F.ttl||"",K=F.capability||"";(function(j){if(G.timestamp){j();return}$.getTimestamp(R&&R.queryTime,function(nt,ct){if(nt){P(nt);return}G.timestamp=ct,j()})})(function(){var j=G.nonce||(G.nonce=M()),nt=G.timestamp,ct=G.keyName+`
`+U+`
`+K+`
`+N+`
`+nt+`
`+j+`
`;G.mac=G.mac||p(ct,Y),o.default.logAction(o.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),P(null,G)})},H.prototype.getAuthParams=function(F){this.method=="basic"?F(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(R,P){if(R){F(R);return}if(!P)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");F(null,{access_token:P.token})})},H.prototype.getAuthHeaders=function(F){this.method=="basic"?F(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(R,P){if(R){F(R);return}if(!P)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");F(null,{authorization:"Bearer "+w(P.token)})})},H.prototype.getTimestamp=function(F,R){!this.isTimeOffsetSet()&&(F||this.authOptions.queryTime)?this.client.time(R):R(null,this.getTimestampUsingOffset())},H.prototype.getTimestampUsingOffset=function(){return l.now()+(this.client.serverTimeOffset||0)},H.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},H.prototype._saveBasicOptions=function(F){this.method="basic",this.key=F.key,this.basicKey=w(F.key),this.authOptions=F||{},"clientId"in F&&this._userSetClientId(F.clientId)},H.prototype._saveTokenOptions=function(F,R){this.method="token",F&&(this.tokenParams=F),R&&(R.token&&(R.tokenDetails=typeof R.token=="string"?{token:R.token}:R.token),R.tokenDetails&&(this.tokenDetails=R.tokenDetails),"clientId"in R&&this._userSetClientId(R.clientId),this.authOptions=R)},H.prototype._ensureValidAuthCredentials=function(F,R){var P=this,$=this.tokenDetails;if($){if(this._tokenClientIdMismatch($.clientId)){R(new u.default("Mismatch between clientId in token ("+$.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!$.expires||$.expires>=this.getTimestampUsingOffset()){o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+$.expires),R(null,$);return}o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=c.default.create())).push(R),!(this.currentTokenRequestId!==null&&!F)){var W=this.currentTokenRequestId=L();this.requestToken(this.tokenParams,this.authOptions,function(Z,et){if(P.currentTokenRequestId>W){o.default.logAction(o.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}P.currentTokenRequestId=null;var Y=P.waitingForTokenRequest||I;if(P.waitingForTokenRequest=null,Z){Y(Z);return}Y(null,P.tokenDetails=et)})}},H.prototype._userSetClientId=function(F){if(typeof F=="string"||F===null){if(F==="*")throw new u.default('Can\u2019t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var R=this._uncheckedSetClientId(F);if(R)throw R}else throw new u.default("clientId must be either a string or null",40012,400)},H.prototype._uncheckedSetClientId=function(F){if(this._tokenClientIdMismatch(F)){var R="Unexpected clientId mismatch: client has "+this.clientId+", requested "+F,P=new u.default(R,40102,401);return o.default.logAction(o.default.LOG_ERROR,"Auth._uncheckedSetClientId()",R),P}else return this.clientId=this.tokenParams.clientId=F,null},H.prototype._tokenClientIdMismatch=function(F){return!!(this.clientId&&this.clientId!=="*"&&F&&F!=="*"&&this.clientId!==F)},H.isTokenErr=function(F){return F.code&&F.code>=40140&&F.code<40150},H}();t.default=z},function(s,t,n){"use strict";t.__esModule=!0;var i;(function(o){o.Get="get",o.Delete="delete",o.Post="post",o.Put="put",o.Patch="patch"})(i||(i={})),t.default=i},function(s,t,n){"use strict";t.__esModule=!0,t.HttpPaginatedResponse=t.PaginatedResult=void 0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(3)),c=i.__importDefault(n(24));function u(A){var I=A.match(/^\.\/(\w+)\?(.*)$/);return I&&I[2]&&o.parseQueryString(I[2])}function f(A){typeof A=="string"&&(A=A.split(","));for(var I={},M=0;M<A.length;M++){var C=A[M].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(C){var S=u(C[1]);S&&(I[C[2]]=S)}}return I}function m(A,I,M){return!(M&&(I||typeof A.code=="number"))}var E=function(){function A(I,M,C,S,w,p){this.rest=I,this.path=M,this.headers=C,this.envelope=S!=null?S:null,this.bodyHandler=w,this.useHttpPaginatedResponse=p||!1}return A.prototype.get=function(I,M){var C=this;c.default.get(this.rest,this.path,this.headers,I,this.envelope,function(S,w,p,y,g){C.handlePage(S,w,p,y,g,M)})},A.prototype.delete=function(I,M){var C=this;c.default.delete(this.rest,this.path,this.headers,I,this.envelope,function(S,w,p,y,g){C.handlePage(S,w,p,y,g,M)})},A.prototype.post=function(I,M,C){var S=this;c.default.post(this.rest,this.path,M,this.headers,I,this.envelope,function(w,p,y,g,v){C&&S.handlePage(w,p,y,g,v,C)})},A.prototype.put=function(I,M,C){var S=this;c.default.put(this.rest,this.path,M,this.headers,I,this.envelope,function(w,p,y,g,v){C&&S.handlePage(w,p,y,g,v,C)})},A.prototype.patch=function(I,M,C){var S=this;c.default.patch(this.rest,this.path,M,this.headers,I,this.envelope,function(w,p,y,g,v){C&&S.handlePage(w,p,y,g,v,C)})},A.prototype.handlePage=function(I,M,C,S,w,p){if(I&&m(I,M,this.useHttpPaginatedResponse)){l.default.logAction(l.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+o.inspectError(I)),p==null||p(I);return}var y,g,v;try{y=this.bodyHandler(M,C||{},S)}catch(h){p==null||p(I||h);return}C&&(g=C.Link||C.link)&&(v=f(g)),this.useHttpPaginatedResponse?p(null,new d(this,y,C||{},w,v,I)):p(null,new O(this,y,v))},A}(),O=function(){function A(I,M,C){var S=this;this.resource=I,this.items=M;var w=this;C&&("first"in C&&(this.first=function(p){if(!p&&w.resource.rest.options.promises)return o.promisify(w,"first",[]);w.get(C.first,p)}),"current"in C&&(this.current=function(p){if(!p&&w.resource.rest.options.promises)return o.promisify(w,"current",[]);w.get(C.current,p)}),this.next=function(p){if(!p&&w.resource.rest.options.promises)return o.promisify(w,"next",[]);"next"in C?w.get(C.next,p):p(null)},this.hasNext=function(){return"next"in C},this.isLast=function(){var p;return!(!((p=S.hasNext)===null||p===void 0)&&p.call(S))})}return A.prototype.get=function(I,M){var C=this.resource;c.default.get(C.rest,C.path,C.headers,I,C.envelope,function(S,w,p,y,g){C.handlePage(S,w,p,y,g,M)})},A}();t.PaginatedResult=O;var d=function(A){i.__extends(I,A);function I(M,C,S,w,p,y){var g=A.call(this,M,C,p)||this;return g.statusCode=w,g.success=w<300&&w>=200,g.headers=S,g.errorCode=y&&y.code,g.errorMessage=y&&y.message,g}return I.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},I}(O);t.HttpPaginatedResponse=d,t.default=E},function(s,t,n){"use strict";t.__esModule=!0,t.isRetriable=void 0;var i=n(1),o=i.__importDefault(n(5)),l={disconnected:o.default.fromValues({statusCode:400,code:80003,message:"Connection to server temporarily unavailable"}),suspended:o.default.fromValues({statusCode:400,code:80002,message:"Connection to server unavailable"}),failed:o.default.fromValues({statusCode:400,code:8e4,message:"Connection failed or disconnected by server"}),closing:o.default.fromValues({statusCode:400,code:80017,message:"Connection closing"}),closed:o.default.fromValues({statusCode:400,code:80017,message:"Connection closed"}),unknownConnectionErr:o.default.fromValues({statusCode:500,code:50002,message:"Internal connection error"}),unknownChannelErr:o.default.fromValues({statusCode:500,code:50001,message:"Internal channel error"})};function c(u){if(!u.statusCode||!u.code||u.statusCode>=500)return!0;var f=!1;return Object.values(l).forEach(function(m){m.code&&m.code==u.code&&(f=!0)}),f}t.isRetriable=c,t.default=l},function(s,t,n){"use strict";t.__esModule=!0;var i;(function(o){o[o.REQ_SEND=0]="REQ_SEND",o[o.REQ_RECV=1]="REQ_RECV",o[o.REQ_RECV_POLL=2]="REQ_RECV_POLL",o[o.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(i||(i={})),t.default=i},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(4),n(58),n(13),n(39),n(31),n(23),n(27),n(28),n(59),n(60))})(this,function(i){return i})},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(3)),l=function(){function c(u){this.members=u||[]}return c.prototype.call=function(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];for(var m=0,E=this.members;m<E.length;m++){var O=E[m];if(O)try{O.apply(void 0,u)}catch(d){o.default.logAction(o.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+d+"; stack = "+d.stack)}}},c.prototype.push=function(){for(var u,f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];(u=this.members).push.apply(u,f)},c.create=function(u){var f=new c(u);return Object.assign(function(){for(var m=[],E=0;E<arguments.length;E++)m[E]=arguments[E];return f.call.apply(f,m)},{push:function(m){return f.push(m)}})},c}();t.default=l},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){(function(){var o=i,l=o.lib,c=l.Base,u=o.enc,f=u.Utf8,m=o.algo,E=m.HMAC=c.extend({init:function(O,d){O=this._hasher=new O.init,typeof d=="string"&&(d=f.parse(d));var A=O.blockSize,I=A*4;d.sigBytes>I&&(d=O.finalize(d)),d.clamp();for(var M=this._oKey=d.clone(),C=this._iKey=d.clone(),S=M.words,w=C.words,p=0;p<A;p++)S[p]^=1549556828,w[p]^=909522486;M.sigBytes=C.sigBytes=I,this.reset()},reset:function(){var O=this._hasher;O.reset(),O.update(this._iKey)},update:function(O){return this._hasher.update(O),this},finalize:function(O){var d=this._hasher,A=d.finalize(O);d.reset();var I=d.finalize(this._oKey.clone().concat(A));return I}})})()})},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(0)),l=i.__importStar(n(2)),c=i.__importDefault(n(3)),u=i.__importDefault(n(16)),f=i.__importDefault(n(17)),m=i.__importDefault(n(5));function E(C,S,w,p,y){C.http.supportsAuthHeaders?C.auth.getAuthHeaders(function(g,v){g?p(g):y(l.mixin(v,S),w)}):C.auth.getAuthParams(function(g,v){g?p(g):y(S,l.mixin(v,w))})}function O(C,S){return function(w,p,y,g,v){if(w&&!p){C(w);return}if(!g)try{p=l.decodeBody(p,S)}catch(H){C(H);return}if(!p){C(new m.default("unenvelope(): Response body is missing",null));return}var h=p,T=h.statusCode,x=h.response,L=h.headers;if(T===void 0){C(w,p,y,!0,v);return}if(T<200||T>=300){var z=x&&x.error||w;z||(z=new Error("Error in unenveloping "+p),z.statusCode=T),C(z,x,L,!0,T);return}C(w,x,L,!0,T)}}function d(C){var S=[];if(C)for(var w in C)S.push(w+"="+C[w]);return S.join("&")}function A(C,S){return C+(S?"?":"")+d(S)}function I(C,S,w,p){return function(y,g,v,h,T){y?c.default.logAction(c.default.LOG_MICRO,"Resource."+S+"()","Received Error; "+A(w,p)+"; Error: "+l.inspectError(y)):c.default.logAction(c.default.LOG_MICRO,"Resource."+S+"()","Received; "+A(w,p)+"; Headers: "+d(v)+"; StatusCode: "+T+"; Body: "+(o.default.BufferUtils.isBuffer(g)?g.toString():g)),C&&C(y,g,v,h,T)}}var M=function(){function C(){}return C.get=function(S,w,p,y,g,v){C.do(f.default.Get,S,w,null,p,y,g,v)},C.delete=function(S,w,p,y,g,v){C.do(f.default.Delete,S,w,null,p,y,g,v)},C.post=function(S,w,p,y,g,v,h){C.do(f.default.Post,S,w,p,y,g,v,h)},C.patch=function(S,w,p,y,g,v,h){C.do(f.default.Patch,S,w,p,y,g,v,h)},C.put=function(S,w,p,y,g,v,h){C.do(f.default.Put,S,w,p,y,g,v,h)},C.do=function(S,w,p,y,g,v,h,T){c.default.shouldLog(c.default.LOG_MICRO)&&(T=I(T,S,p,v)),h&&(T=T&&O(T,h),(v=v||{}).envelope=h);function x(L,z){var H;if(c.default.shouldLog(c.default.LOG_MICRO)&&c.default.logAction(c.default.LOG_MICRO,"Resource."+S+"()","Sending; "+A(p,z)),c.default.shouldLog(c.default.LOG_MICRO)){var F=y;if(((H=L["content-type"])===null||H===void 0?void 0:H.indexOf("msgpack"))>0)try{F=o.default.Config.msgpack.decode(y)}catch(R){c.default.logAction(c.default.LOG_MICRO,"Resource."+S+"()","Sending MsgPack Decoding Error: "+l.inspectError(R))}c.default.logAction(c.default.LOG_MICRO,"Resource."+S+"()","Sending; "+A(p,z)+"; Body: "+F)}w.http.do(S,w,p,L,y,z,function(R,P,$,W,Z){if(R&&u.default.isTokenErr(R)){w.auth.authorize(null,null,function(et){if(et){T(et);return}E(w,$,z,T,x)});return}T(R,P,$,W,Z)})}E(w,g,v,T,x)},C}();t.default=M},function(s,t,n){"use strict";(function(i){t.__esModule=!0,t.TransportParams=void 0;var o=n(1),l=o.__importDefault(n(10)),c=o.__importStar(n(2)),u=o.__importStar(n(51)),f=o.__importDefault(n(8)),m=o.__importDefault(n(0)),E=o.__importDefault(n(7)),O=o.__importDefault(n(35)),d=o.__importDefault(n(3)),A=o.__importDefault(n(36)),I=o.__importStar(n(19)),M=o.__importDefault(n(5)),C=o.__importDefault(n(16)),S=o.__importDefault(n(9)),w=o.__importDefault(n(22)),p=o.__importDefault(n(52)),y=o.__importDefault(n(26)),g=o.__importDefault(n(53)),v=function(){var et;return typeof m.default.WebStorage!="undefined"&&((et=m.default.WebStorage)===null||et===void 0?void 0:et.localSupported)},h=function(){var et;return typeof m.default.WebStorage!="undefined"&&((et=m.default.WebStorage)===null||et===void 0?void 0:et.sessionSupported)},T=l.default.Action,x=function(){},L="ably-transport-preference",z="ably-connection-recovery";function H(){var et,Y;return h()&&((Y=(et=m.default.WebStorage)===null||et===void 0?void 0:et.getSession)===null||Y===void 0?void 0:Y.call(et,z))}function F(et){var Y,G;return h()&&((G=(Y=m.default.WebStorage)===null||Y===void 0?void 0:Y.setSession)===null||G===void 0?void 0:G.call(Y,z,et))}function R(){var et,Y;return h()&&((Y=(et=m.default.WebStorage)===null||et===void 0?void 0:et.removeSession)===null||Y===void 0?void 0:Y.call(et,z))}function P(et,Y){return c.arrIndexOf(m.default.Defaults.transportPreferenceOrder,et.shortName)>c.arrIndexOf(m.default.Defaults.transportPreferenceOrder,Y.shortName)}function $(et,Y,G){var N;if(et.channel!==Y.channel||(N=et.action)!==T.PRESENCE&&N!==T.MESSAGE||N!==Y.action)return!1;var U=N===T.PRESENCE?"presence":"messages",K=et[U].concat(Y[U]),j=S.default.getMessagesSize(K);return j>G||!c.allSame(K,"clientId")||!c.arrEvery(K,function(nt){return!nt.id})?!1:(et[U]=K,!0)}var W=function(){function et(Y,G,N,U){this.options=Y,this.host=G,this.mode=N,this.connectionKey=U,this.format=Y.useBinaryProtocol?c.Format.msgpack:c.Format.json,this.connectionSerial=void 0,this.timeSerial=void 0}return et.prototype.getConnectParams=function(Y){var G=Y?c.copy(Y):{},N=this.options;switch(this.mode){case"upgrade":G.upgrade=this.connectionKey;break;case"resume":G.resume=this.connectionKey,this.timeSerial!==void 0?G.timeSerial=this.timeSerial:this.connectionSerial!==void 0&&(G.connectionSerial=this.connectionSerial);break;case"recover":{var U=N.recover.split(":");if(U){G.recover=U[0];var K=U[1];isNaN(Number(K))?G.timeSerial=K:G.connectionSerial=K}break}default:}return N.clientId!==void 0&&(G.clientId=N.clientId),N.echoMessages===!1&&(G.echo="false"),this.format!==void 0&&(G.format=this.format),this.stream!==void 0&&(G.stream=this.stream),this.heartbeats!==void 0&&(G.heartbeats=this.heartbeats),G.v=f.default.apiVersion,G.agent=encodeURIComponent(f.default.agent),N.transportParams!==void 0&&c.mixin(G,N.transportParams),G},et.prototype.toString=function(){var Y="[mode="+this.mode;return this.host&&(Y+=",host="+this.host),this.connectionKey&&(Y+=",connectionKey="+this.connectionKey),this.connectionSerial!==void 0&&(Y+=",connectionSerial="+this.connectionSerial),this.timeSerial&&(Y+=",timeSerial="+this.timeSerial),this.format&&(Y+=",format="+this.format),Y+="]",Y},et}();t.TransportParams=W;var Z=function(et){o.__extends(Y,et);function Y(G,N){var U=et.call(this)||this;U.disconnectedRetryCount=0,Y.initTransports(),U.realtime=G,U.options=N;var K=N.timeouts,j=K.preferenceConnectTimeout+K.realtimeRequestTimeout;if(U.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:j,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:K.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:K.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:K.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},U.state=U.states.initialized,U.errorReason=null,U.queuedMessages=new O.default,U.msgSerial=0,U.connectionDetails=void 0,U.connectionId=void 0,U.connectionKey=void 0,U.timeSerial=void 0,U.connectionSerial=void 0,U.connectionStateTtl=K.connectionStateTtl,U.maxIdleInterval=null,U.transports=c.intersect(N.transports||f.default.defaultTransports,Y.supportedTransports),U.baseTransport=c.intersect(f.default.baseTransportOrder,U.transports)[0],U.upgradeTransports=c.intersect(U.transports,f.default.upgradeTransports),U.transportPreference=null,U.httpHosts=f.default.getHosts(N),U.activeProtocol=null,U.proposedTransports=[],U.pendingTransports=[],U.host=null,U.lastAutoReconnectAttempt=null,U.lastActivity=null,U.mostRecentMsg=null,U.forceFallbackHost=!1,U.connectCounter=0,d.default.logAction(d.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),d.default.logAction(d.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(N.transports||f.default.defaultTransports)+"]"),d.default.logAction(d.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+U.transports+"]"),d.default.logAction(d.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+U.httpHosts+"]"),!U.transports.length){var nt="no requested transports available";throw d.default.logAction(d.default.LOG_ERROR,"realtime.ConnectionManager()",nt),new Error(nt)}var ct=m.default.Config.addEventListener;return ct&&(h()&&typeof N.recover=="function"&&ct("beforeunload",U.persistConnection.bind(U)),N.closeOnUnload===!0&&ct("beforeunload",function(){d.default.logAction(d.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),U.requestState({state:"closing"})}),ct("online",function(){(U.state==U.states.disconnected||U.state==U.states.suspended)&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager caught browser \u2018online\u2019 event","reattempting connection"),U.requestState({state:"connecting"}))}),ct("offline",function(){U.state==U.states.connected&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager caught browser \u2018offline\u2019 event","disconnecting active transport"),U.disconnectAllTransports())})),U}return Y.initTransports=function(){p.default(Y),c.arrForEach(m.default.Transports,function(G){G(Y)})},Y.prototype.createTransportParams=function(G,N){var U=new W(this.options,G,N,this.connectionKey);return this.timeSerial?U.timeSerial=String(this.timeSerial):this.connectionSerial!==void 0&&(U.connectionSerial=this.connectionSerial),U},Y.prototype.getTransportParams=function(G){var N=this,U=function(K){if(N.connectionKey){K("resume");return}if(typeof N.options.recover=="string"){K("recover");return}var j=N.options.recover,nt=H();if(nt&&typeof j=="function"){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),j(nt,function(ct){ct?(N.options.recover=nt.recoveryKey,K("recover")):K("clean")});return}K("clean")};U(function(K){var j=N.createTransportParams(null,K);if(K==="recover"){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+N.options.recover);var nt=N.options.recover.split(":");nt&&nt[2]&&(N.msgSerial=Number(nt[2]))}else d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+j.toString());G(j)})},Y.prototype.tryATransport=function(G,N,U){var K=this;d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+N),y.default.tryConnect(Y.supportedTransports[N],this,this.realtime.auth,G,function(j,nt){var ct=K.state;if(ct==K.states.closing||ct==K.states.closed||ct==K.states.failed){nt&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+ct.state+" while we were attempting the transport; closing "+nt),nt.close()),U(!0);return}if(j){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+N+" "+j.event+", err: "+j.error.toString()),C.default.isTokenErr(j.error)&&!(K.errorReason&&C.default.isTokenErr(K.errorReason))?(K.errorReason=j.error,K.realtime.auth._forceNewToken(null,null,function(Et){if(Et){K.actOnErrorFromAuthorize(Et);return}K.tryATransport(G,N,U)})):j.event==="failed"?(K.notifyState({state:"failed",error:j.error}),U(!0)):j.event==="disconnected"&&(I.isRetriable(j.error)?U(!1):(K.notifyState({state:K.states.connecting.failState,error:j.error}),U(!0)));return}d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+N+"; setting pending"),K.setTransportPending(nt,G),U(null,nt)})},Y.prototype.setTransportPending=function(G,N){var U=this,K=N.mode;d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+G+"; mode = "+K),c.arrDeleteValue(this.proposedTransports,G),this.pendingTransports.push(G);var j=m.default.Defaults.transportPreferenceOrder[m.default.Defaults.transportPreferenceOrder.length-1];G.once("connected",function(ct,Et,bt,_t){K=="upgrade"?G.shortName!==j&&c.arrIn(U.getUpgradePossibilities(),j)&&U.activeProtocol?setTimeout(function(){U.scheduleTransportActivation(ct,G,Et,bt,_t)},U.options.timeouts.parallelUpgradeDelay):U.scheduleTransportActivation(ct,G,Et,bt,_t):(U.activateTransport(ct,G,Et,bt,_t),m.default.Config.nextTick(function(){U.connectImpl(N)})),K==="recover"&&U.options.recover&&(U.options.recover=null,U.unpersistConnection())});var nt=this;G.on(["disconnected","closed","failed"],function(ct){nt.deactivateTransport(G,this.event,ct)}),this.emit("transport.pending",G)},Y.prototype.scheduleTransportActivation=function(G,N,U,K,j){var nt=this,ct=this.activeProtocol&&this.activeProtocol.getTransport(),Et=function(){N.disconnect(),c.arrDeleteValue(nt.pendingTransports,N)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+N.shortName),Et();return}if(ct&&!P(N,ct)){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+N.shortName+" is no better than current active transport "+ct.shortName+" - abandoning upgrade"),Et();return}d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+N);var bt=function(_t){var Kt;if(_t){d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Unable to activate transport; transport = "+N+"; err = "+_t);return}if(!N.isConnected){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+N.shortName+"is no longer connected; abandoning upgrade"),Et();return}if(nt.state===nt.states.connected)d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),nt.state=nt.states.synchronizing,Kt=nt.activeProtocol;else if(nt.state!==nt.states.connecting){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+nt.state.state+(nt.state===nt.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+N.shortName),Et();return}var pt=U!==nt.connectionId,Vt=pt?j:nt;pt&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Upgrade resulted in new connectionId; resetting library connection position from "+(nt.timeSerial||nt.connectionSerial)+" to "+(Vt.timeSerial||Vt.connectionSerial)+"; upgrade error was "+G),d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+N),nt.sync(N,Vt,function(Se,Xt,se){if(Se){nt.state===nt.states.synchronizing&&(d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Unexpected error attempting to sync transport; transport = "+N+"; err = "+Se),nt.disconnectAllTransports());return}var Ne=function(){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+N),nt.activateTransport(G,N,Xt,K,se),nt.state===nt.states.synchronizing?(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+N),nt.state=nt.states.connected):d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+nt.state.state+", so leaving unchanged"),nt.state.sendEvents&&nt.sendQueuedMessages()};Kt?Kt.onceIdle(Ne):Ne()})};ct?this.realtime.channels.onceNopending(bt):bt()},Y.prototype.activateTransport=function(G,N,U,K,j){var nt=this;d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+N),G&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+G),U&&d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+U),K&&d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(K)),j&&d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.activateTransport()","serial =  "+(j.timeSerial||j.connectionSerial)),this.persistTransportPreference(N);var ct=this.state,Et=this.states.connected.state;if(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+ct.state),ct.state==this.states.closing.state||ct.state==this.states.closed.state||ct.state==this.states.failed.state)return d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),N.disconnect(),!1;if(c.arrDeleteValue(this.pendingTransports,N),!N.isConnected)return d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+N+" since it appears to no longer be connected"),!1;var bt=this.activeProtocol;this.activeProtocol=new u.default(N),this.host=N.params.host;var _t=K.connectionKey;if(_t&&this.connectionKey!=_t&&this.setConnection(U,K,j,!!G),this.onConnectionDetailsUpdate(K,N),m.default.Config.nextTick(function(){N.on("connected",function(pt,Vt,Se){nt.onConnectionDetailsUpdate(Se,N),nt.emit("update",new A.default(Et,Et,null,pt))})}),ct.state===this.states.connected.state?G&&(this.errorReason=this.realtime.connection.errorReason=G,this.emit("update",new A.default(Et,Et,null,G))):(this.notifyState({state:"connected",error:G}),this.errorReason=this.realtime.connection.errorReason=G||null),this.emit("transport.active",N),bt)if(bt.messageQueue.count()>0&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+bt.transport.shortName+", new one is "+N.shortName+") finishing with "+bt.messageQueue.count()+" messages still pending"),bt.transport===N){var Kt="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+N.shortName+"; stack = "+new Error().stack;d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.activateTransport()",Kt)}else bt.finish();return c.safeArrForEach(this.pendingTransports,function(pt){if(pt===N){var Vt="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+N.shortName+"; stack = "+new Error().stack;d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.activateTransport()",Vt),c.arrDeleteValue(nt.pendingTransports,N)}else pt.disconnect()}),c.safeArrForEach(this.proposedTransports,function(pt){pt===N?(d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+N.shortName+"; stack = "+new Error().stack),c.arrDeleteValue(nt.proposedTransports,N)):pt.dispose()}),!0},Y.prototype.deactivateTransport=function(G,N,U){var K=this.activeProtocol,j=K&&K.getTransport()===G,nt=c.arrDeleteValue(this.pendingTransports,G),ct=c.arrDeleteValue(this.proposedTransports,G),Et=this.noTransportsScheduledForActivation();if(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+G),d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+N+(j?"; was active":nt?"; was pending":ct?"; was proposed":"")+(Et?"":"; another transport is scheduled for activation")),U&&U.message&&d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+U.message),j&&(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(K.getPendingMessages()),m.default.Config.nextTick(function(){K.clearPendingMessages()}),this.activeProtocol=this.host=null,clearTimeout(this.channelResumeCheckTimer)),this.emit("transport.inactive",G),j&&Et||j&&N==="failed"||N==="closed"||K===null&&nt&&this.pendingTransports.length===0){if(N==="disconnected"&&U&&U.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:N,error:U,retryImmediately:!0});return}var bt=N==="failed"&&C.default.isTokenErr(U)?"disconnected":N;this.notifyState({state:bt,error:U});return}j&&N==="disconnected"&&this.state!==this.states.synchronizing&&(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:U}))},Y.prototype.noTransportsScheduledForActivation=function(){return c.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(G){return!G.isConnected})},Y.prototype.sync=function(G,N,U){var K=setTimeout(function(){G.off("sync"),U(new M.default("Timeout waiting for sync response",5e4,500))},this.options.timeouts.realtimeRequestTimeout),j=l.default.fromValues({action:T.SYNC,connectionKey:this.connectionKey});N.timeSerial?j.timeSerial=N.timeSerial:N.connectionSerial!==void 0&&(j.connectionSerial=N.connectionSerial),G.send(j),G.once("sync",function(nt,ct){clearTimeout(K),U(null,nt,ct)})},Y.prototype.setConnection=function(G,N,U,K){var j=this,nt=this.connectionId,ct=nt&&nt!==G,Et=!nt&&K;(ct||Et)&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0),this.connectionId!==G?(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),m.default.Config.nextTick(function(){j.realtime.channels.reattach()})):this.options.checkChannelsOnResume&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.setConnection()","Same connectionId; checkChannelsOnResume is enabled"),clearTimeout(this.channelResumeCheckTimer),this.realtime.channels.resetAttachedMsgIndicators(),this.channelResumeCheckTimer=setTimeout(function(){j.realtime.channels.checkAttachedMsgIndicators(G)},3e4)),this.realtime.connection.id=this.connectionId=G,this.realtime.connection.key=this.connectionKey=N.connectionKey;var bt=ct||!nt;this.setConnectionSerial(U,bt,!1)},Y.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.clearConnectionSerial(),this.msgSerial=0,this.unpersistConnection()},Y.prototype.setConnectionSerial=function(G,N,U){var K=G.timeSerial,j=G.connectionSerial;if(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.setConnectionSerial()","Updating connection serial; serial = "+j+"; timeSerial = "+K+"; force = "+N+"; previous = "+this.connectionSerial),K!==void 0){if(K<=this.timeSerial&&!N)return U&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.setConnectionSerial()","received message with timeSerial "+K+", but current timeSerial is "+this.timeSerial+"; assuming message is a duplicate and discarding it"),!0;this.realtime.connection.timeSerial=this.timeSerial=K,this.setRecoveryKey();return}if(j!==void 0){if(j<=this.connectionSerial&&!N)return U&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.setConnectionSerial()","received message with connectionSerial "+j+", but current connectionSerial is "+this.connectionSerial+"; assuming message is a duplicate and discarding it"),!0;this.realtime.connection.serial=this.connectionSerial=j,this.setRecoveryKey()}},Y.prototype.clearConnectionSerial=function(){this.realtime.connection.serial=this.connectionSerial=void 0,this.realtime.connection.timeSerial=this.timeSerial=void 0,this.clearRecoveryKey()},Y.prototype.setRecoveryKey=function(){this.realtime.connection.recoveryKey=this.connectionKey+":"+(this.timeSerial||this.connectionSerial)+":"+this.msgSerial},Y.prototype.clearRecoveryKey=function(){this.realtime.connection.recoveryKey=null},Y.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var G=c.now()-this.lastActivity;G>this.connectionStateTtl+this.maxIdleInterval&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+G+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},Y.prototype.persistConnection=function(){if(h()){var G=this.realtime.connection.recoveryKey;G&&F({recoveryKey:G,disconnectedAt:c.now(),location:i.location,clientId:this.realtime.auth.clientId})}},Y.prototype.unpersistConnection=function(){R()},Y.prototype.getError=function(){return this.errorReason||this.getStateError()},Y.prototype.getStateError=function(){return I.default[this.state.state]},Y.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},Y.prototype.enactStateChange=function(G){var N=G.current==="failed"?d.default.LOG_ERROR:d.default.LOG_MAJOR;d.default.logAction(N,"Connection state",G.current+(G.reason?"; reason: "+G.reason:"")),d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+G.current+"; reason = "+(G.reason&&G.reason.message));var U=this.state=this.states[G.current];G.reason&&(this.errorReason=G.reason,this.realtime.connection.errorReason=G.reason),(U.terminal||U.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",G)},Y.prototype.startTransitionTimer=function(G){var N=this;d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+G.state),this.transitionTimer&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){N.transitionTimer&&(N.transitionTimer=null,d.default.logAction(d.default.LOG_MINOR,"ConnectionManager "+G.state+" timer expired","requesting new state: "+G.failState),N.notifyState({state:G.failState}))},G.retryDelay)},Y.prototype.cancelTransitionTimer=function(){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},Y.prototype.startSuspendTimer=function(){var G=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){G.suspendTimer&&(G.suspendTimer=null,d.default.logAction(d.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),G.states.connecting.failState="suspended",G.notifyState({state:"suspended"}))},this.connectionStateTtl))},Y.prototype.checkSuspendTimer=function(G){G!=="disconnected"&&G!=="suspended"&&G!=="connecting"&&this.cancelSuspendTimer()},Y.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},Y.prototype.startRetryTimer=function(G){var N=this;this.retryTimer=setTimeout(function(){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),N.retryTimer=null,N.requestState({state:"connecting"})},G)},Y.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},Y.prototype.notifyState=function(G){var N=this,U=G.state,K=U==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||G.retryImmediately||this.state===this.states.connecting&&G.error&&C.default.isTokenErr(G.error)&&!(this.errorReason&&C.default.isTokenErr(this.errorReason)));if(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+U+(K?"; will retry connection immediately":"")),U!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(G.state),(U==="suspended"||U==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var j=this.states[G.state],nt=j.retryDelay;j.state==="disconnected"&&(this.disconnectedRetryCount++,nt=j.retryDelay*c.getBackoffCoefficient(this.disconnectedRetryCount)*c.getJitterCoefficient());var ct=new A.default(this.state.state,j.state,nt,G.error||I.default[j.state]);if(K){var Et=function(){N.state===N.states.disconnected&&(N.lastAutoReconnectAttempt=c.now(),N.requestState({state:"connecting"}))},bt=this.lastAutoReconnectAttempt&&c.now()-this.lastAutoReconnectAttempt+1;bt&&bt<1e3?(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+bt+"ms ago, waiting another "+(1e3-bt)+"ms before trying again"),setTimeout(Et,1e3-bt)):m.default.Config.nextTick(Et)}else(U==="disconnected"||U==="suspended")&&this.startRetryTimer(nt);(U==="disconnected"&&!K||U==="suspended"||j.terminal)&&m.default.Config.nextTick(function(){N.disconnectAllTransports()}),U=="connected"&&!this.activeProtocol&&d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ct),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(U,ct.reason),this.failQueuedMessages(ct.reason))}},Y.prototype.requestState=function(G){var N=this,U=G.state;if(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+U+"; current state: "+this.state.state),U!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(U),!(U=="connecting"&&this.state.state=="connected")&&!(U=="closing"&&this.state.state=="closed"))){var K=this.states[U],j=new A.default(this.state.state,K.state,null,G.error||I.default[K.state]);this.enactStateChange(j),U=="connecting"&&m.default.Config.nextTick(function(){N.startConnect()}),U=="closing"&&this.closeImpl()}},Y.prototype.startConnect=function(){var G=this;if(this.state!==this.states.connecting){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var N=this.realtime.auth,U=++this.connectCounter,K=function(){G.checkConnectionStateFreshness(),G.getTransportParams(function(nt){U===G.connectCounter&&G.connectImpl(nt,U)})};if(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),N.method==="basic")K();else{var j=function(nt){U===G.connectCounter&&(nt?G.actOnErrorFromAuthorize(nt):K())};this.errorReason&&C.default.isTokenErr(this.errorReason)?N._forceNewToken(null,null,j):N._ensureValidAuthCredentials(!1,j)}},Y.prototype.connectImpl=function(G,N){var U=this.state.state;U!==this.states.connecting.state&&U!==this.states.connected.state?d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+U):this.pendingTransports.length?d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):U==this.states.connected.state?this.upgradeIfNeeded(G):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(G):this.connectBase(G,N)},Y.prototype.connectPreference=function(G){var N=this,U=this.getTransportPreference(),K=!1;c.arrIn(this.transports,U)||(this.unpersistTransportPreference(),this.connectImpl(G)),d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+U);var j=setTimeout(function(){K=!0,N.state.state!==N.states.connected.state&&(d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+U+" failed; clearing preference and trying from scratch"),N.disconnectAllTransports(),N.unpersistTransportPreference()),N.connectImpl(G)},this.options.timeouts.preferenceConnectTimeout);G.host=this.httpHosts[0],this.tryATransport(G,U,function(nt,ct){clearTimeout(j),K&&ct?(ct.off(),ct.disconnect(),c.arrDeleteValue(N.pendingTransports,ct)):!ct&&!nt&&(N.unpersistTransportPreference(),N.connectImpl(G))})},Y.prototype.connectBase=function(G,N){var U=this,K=function(bt){U.notifyState({state:U.states.connecting.failState,error:bt})},j=this.httpHosts.slice(),nt=function(bt,_t){N===U.connectCounter&&!_t&&!bt&&Et()};d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var ct=j.shift();if(!ct){K(new M.default("Unable to connect (no available host)",80003,404));return}G.host=ct;var Et=function(){if(!j.length){K(new M.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!U.realtime.http.checkConnectivity){K(new M.default("Internal error: Http.checkConnectivity not set",null,500));return}U.realtime.http.checkConnectivity(function(bt,_t){if(N===U.connectCounter){if(bt){K(bt);return}if(!_t){K(new M.default("Unable to connect (network unreachable)",80003,404));return}G.host=c.arrPopRandomElement(j),U.tryATransport(G,U.baseTransport,nt)}})};if(this.forceFallbackHost&&j.length){this.forceFallbackHost=!1,Et();return}this.tryATransport(G,this.baseTransport,nt)},Y.prototype.getUpgradePossibilities=function(){var G=this.activeProtocol.getTransport().shortName,N=c.arrIndexOf(this.upgradeTransports,G);return this.upgradeTransports.slice(N+1)},Y.prototype.upgradeIfNeeded=function(G){var N=this,U=this.getUpgradePossibilities();d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+m.default.Config.inspect(U)),U.length&&c.arrForEach(U,function(K){var j=N.createTransportParams(G.host,"upgrade");N.tryATransport(j,K,x)})},Y.prototype.closeImpl=function(){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),c.safeArrForEach(this.pendingTransports,function(G){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+G),G&&G.close()}),c.safeArrForEach(this.proposedTransports,function(G){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+G),G&&G.dispose()}),this.activeProtocol&&(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},Y.prototype.onAuthUpdated=function(G,N){var U=this,K;switch(this.state.state){case"connected":{if(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var j=this.activeProtocol.getTransport().params;m.default.Config.nextTick(function(){U.state.state==="connected"&&U.upgradeIfNeeded(j)})}var nt=(K=this.activeProtocol)===null||K===void 0?void 0:K.getTransport();nt&&nt.onAuthUpdated&&nt.onAuthUpdated(G);var ct=l.default.fromValues({action:T.AUTH,auth:{accessToken:G.token}});this.send(ct);var Et=function(){U.off(bt),N(null,G)},bt=function(Kt){Kt.current==="failed"&&(U.off(Et),U.off(bt),N(Kt.reason||U.getStateError()))};this.once("connectiondetails",Et),this.on("connectionstate",bt);break}case"connecting":d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var _t=function(Kt){switch(Kt.current){case"connected":U.off(_t),N(null,G);break;case"failed":case"closed":case"suspended":U.off(_t),N(Kt.reason||U.getStateError());break;default:break}};this.on("connectionstate",_t),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},Y.prototype.disconnectAllTransports=function(G){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(G?" except the active transport":"")),this.connectCounter++,c.safeArrForEach(this.pendingTransports,function(N){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+N),N&&N.disconnect()}),this.pendingTransports=[],c.safeArrForEach(this.proposedTransports,function(N){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+N),N&&N.dispose()}),this.proposedTransports=[],this.activeProtocol&&!G&&(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},Y.prototype.send=function(G,N,U){U=U||x;var K=this.state;if(K.sendEvents){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new u.PendingMessage(G,U));return}var j=N&&K.queueEvents||K.forceQueueEvents;if(!j){var nt="rejecting event, queueEvent was "+N+", state was "+K.state;d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.send()",nt),U(this.errorReason||new M.default(nt,9e4,400));return}d.default.shouldLog(d.default.LOG_MICRO)&&d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+l.default.stringify(G)),this.queue(G,U)},Y.prototype.sendImpl=function(G){var N=G.message;G.ackRequired&&!G.sendAttempted&&(N.msgSerial=this.msgSerial++,this.setRecoveryKey());try{this.activeProtocol.send(G)}catch(U){d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+U.stack)}},Y.prototype.queue=function(G,N){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var U=this.queuedMessages.last(),K=this.options.maxMessageSize;U&&!U.sendAttempted&&$(U.message,G,K)?(U.merged||(U.callback=w.default.create([U.callback]),U.merged=!0),U.callback.push(N)):this.queuedMessages.push(new u.PendingMessage(G,N))},Y.prototype.sendQueuedMessages=function(){d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var G;G=this.queuedMessages.shift();)this.sendImpl(G)},Y.prototype.queuePendingMessages=function(G){G&&G.length&&(d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+G.length+" pending messages"),this.queuedMessages.prepend(G))},Y.prototype.failQueuedMessages=function(G){var N=this.queuedMessages.count();N>0&&(d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+N+" queued messages, err = "+c.inspectError(G)),this.queuedMessages.completeAllMessages(G))},Y.prototype.onChannelMessage=function(G,N){var U=this.activeProtocol&&N===this.activeProtocol.getTransport(),K=c.arrIn(this.pendingTransports,N)&&this.state==this.states.synchronizing,j=G.action===T.MESSAGE||G.action===T.PRESENCE;if(U||K){if(j){var nt=this.setConnectionSerial(G,!1,!0);if(nt)return;if(l.default.isDuplicate(G,this.mostRecentMsg)){d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.onChannelMessage()","received message with different connectionSerial, but same message id as a previous; discarding; id = "+G.id);return}this.mostRecentMsg=G}this.realtime.channels.onChannelMessage(G)}else c.arrIndexOf([T.ACK,T.NACK,T.ERROR],G.action)>-1?this.realtime.channels.onChannelMessage(G):d.default.logAction(d.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(G)+"on defunct transport; discarding")},Y.prototype.ping=function(G,N){var U=this;if(G){d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+G);var K=function(){G.off("heartbeat",ct),N(new M.default("Timeout waiting for heartbeat response",5e4,500))},j=c.now(),nt=c.cheapRandStr(),ct=function(pt){if(pt===nt){G.off("heartbeat",ct),clearTimeout(Et);var Vt=c.now()-j;N(null,Vt)}},Et=setTimeout(K,this.options.timeouts.realtimeRequestTimeout);G.on("heartbeat",ct),G.ping(nt);return}if(this.state.state!=="connected"){N(new M.default("Unable to ping service; not connected",4e4,400));return}var bt=!1,_t=function(pt,Vt){U.off("transport.active",Kt),bt||(bt=!0,N(pt,Vt))},Kt=function(){bt||(bt=!0,m.default.Config.nextTick(function(){U.ping(null,N)}))};this.on("transport.active",Kt),this.ping(this.activeProtocol.getTransport(),_t)},Y.prototype.abort=function(G){this.activeProtocol.getTransport().fail(G)},Y.prototype.registerProposedTransport=function(G){this.proposedTransports.push(G)},Y.prototype.getTransportPreference=function(){var G,N;return this.transportPreference||v()&&((N=(G=m.default.WebStorage)===null||G===void 0?void 0:G.get)===null||N===void 0?void 0:N.call(G,L))},Y.prototype.persistTransportPreference=function(G){var N,U;c.arrIn(f.default.upgradeTransports,G.shortName)&&(this.transportPreference=G.shortName,v()&&((U=(N=m.default.WebStorage)===null||N===void 0?void 0:N.set)===null||U===void 0||U.call(N,L,G.shortName)))},Y.prototype.unpersistTransportPreference=function(){var G,N;this.transportPreference=null,v()&&((N=(G=m.default.WebStorage)===null||G===void 0?void 0:G.remove)===null||N===void 0||N.call(G,L))},Y.prototype.actOnErrorFromAuthorize=function(G){if(G.code===40171)this.notifyState({state:"failed",error:G});else if(G.statusCode===g.default.Forbidden){var N="Client configured authentication provider returned 403; failing the connection";d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",N),this.notifyState({state:"failed",error:new M.default(N,80019,403,G)})}else{var N="Client configured authentication provider request failed";d.default.logAction(d.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",N),this.notifyState({state:this.state.failState,error:new M.default(N,80019,401,G)})}},Y.prototype.onConnectionDetailsUpdate=function(G,N){if(!!G){this.connectionDetails=G,G.maxMessageSize&&(this.options.maxMessageSize=G.maxMessageSize);var U=G.clientId;if(U){var K=this.realtime.auth._uncheckedSetClientId(U);if(K){d.default.logAction(d.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",K.message),N.fail(K);return}}var j=G.connectionStateTtl;j&&(this.connectionStateTtl=j),this.maxIdleInterval=G.maxIdleInterval,this.emit("connectiondetails",G)}},Y.supportedTransports={},Y}(E.default);t.default=Z}).call(this,n(12))},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(10)),l=i.__importStar(n(2)),c=i.__importDefault(n(7)),u=i.__importDefault(n(3)),f=i.__importDefault(n(19)),m=i.__importDefault(n(5)),E=i.__importDefault(n(0)),O=o.default.Action,d=o.default.fromValues({action:O.CLOSE}),A=o.default.fromValues({action:O.DISCONNECT}),I=function(M){i.__extends(C,M);function C(S,w,p,y){var g=M.call(this)||this;return y&&(p.format=void 0,p.heartbeats=!0),g.connectionManager=S,S.registerProposedTransport(g),g.auth=w,g.params=p,g.timeouts=p.options.timeouts,g.format=p.format,g.isConnected=!1,g.isFinished=!1,g.isDisposed=!1,g.maxIdleInterval=null,g.idleTimer=null,g.lastActivity=null,g}return C.prototype.connect=function(){},C.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",f.default.closed)},C.prototype.disconnect=function(S){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",S||f.default.disconnected)},C.prototype.fail=function(S){this.isConnected&&this.requestDisconnect(),this.finish("failed",S||f.default.failed)},C.prototype.finish=function(S,w){var p;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((p=this.idleTimer)!==null&&p!==void 0?p:void 0),this.idleTimer=null,this.emit(S,w),this.dispose())},C.prototype.onProtocolMessage=function(S){switch(u.default.shouldLog(u.default.LOG_MICRO)&&u.default.logAction(u.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+o.default.stringify(S)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),S.action){case O.HEARTBEAT:u.default.logAction(u.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",S.id);break;case O.CONNECTED:this.onConnect(S),this.emit("connected",S.error,S.connectionId,S.connectionDetails,S);break;case O.CLOSED:this.onClose(S);break;case O.DISCONNECTED:this.onDisconnect(S);break;case O.ACK:this.emit("ack",S.msgSerial,S.count);break;case O.NACK:this.emit("nack",S.msgSerial,S.count,S.error);break;case O.SYNC:if(S.connectionId!==void 0){this.emit("sync",S.connectionId,S);break}this.connectionManager.onChannelMessage(S,this);break;case O.AUTH:this.auth.authorize(function(w){w&&u.default.logAction(u.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+l.inspectError(w))});break;case O.ERROR:if(u.default.logAction(u.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(S.error)+(S.channel?", channel: "+S.channel:"")),S.channel===void 0){this.onFatalError(S);break}this.connectionManager.onChannelMessage(S,this);break;default:this.connectionManager.onChannelMessage(S,this)}},C.prototype.onConnect=function(S){if(this.isConnected=!0,!S.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var w=S.connectionDetails.maxIdleInterval;w&&(this.maxIdleInterval=w+this.timeouts.realtimeRequestTimeout,this.onActivity())},C.prototype.onDisconnect=function(S){var w=S&&S.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onDisconnect()","err = "+l.inspectError(w)),this.finish("disconnected",w)},C.prototype.onFatalError=function(S){var w=S&&S.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onFatalError()","err = "+l.inspectError(w)),this.finish("failed",w)},C.prototype.onClose=function(S){var w=S&&S.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onClose()","err = "+l.inspectError(w)),this.finish("closed",w)},C.prototype.requestClose=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.requestClose()",""),this.send(d)},C.prototype.requestDisconnect=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(A)},C.prototype.ping=function(S){var w={action:o.default.Action.HEARTBEAT};S&&(w.id=S),this.send(o.default.fromValues(w))},C.prototype.dispose=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},C.prototype.onActivity=function(){!this.maxIdleInterval||(this.lastActivity=this.connectionManager.lastActivity=l.now(),this.setIdleTimer(this.maxIdleInterval+100))},C.prototype.setIdleTimer=function(S){var w=this;this.idleTimer||(this.idleTimer=setTimeout(function(){w.onIdleTimerExpire()},S))},C.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var S=l.now()-this.lastActivity,w=this.maxIdleInterval-S;if(w<=0){var p="No activity seen from realtime in "+S+"ms; assuming connection has dropped";u.default.logAction(u.default.LOG_ERROR,"Transport.onIdleTimerExpire()",p),this.disconnect(new m.default(p,80003,408))}else this.setIdleTimer(w+100)},C.tryConnect=function(S,w,p,y,g){var v=new S(w,p,y),h,T=function(L){clearTimeout(h),g({event:this.event,error:L})},x=w.options.timeouts.realtimeRequestTimeout;h=setTimeout(function(){v.off(["preconnect","disconnected","failed"]),v.dispose(),T.call({event:"disconnected"},new m.default("Timeout waiting for transport to indicate itself viable",5e4,500))},x),v.on(["failed","disconnected"],T),v.on("preconnect",function(){u.default.logAction(u.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+v),clearTimeout(h),v.off(["failed","disconnected"],T),g(null,v)}),v.connect()},C}(c.default);t.default=I},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(39),n(23))})(this,function(i){return function(){var o=i,l=o.lib,c=l.Base,u=l.WordArray,f=o.algo,m=f.MD5,E=f.EvpKDF=c.extend({cfg:c.extend({keySize:128/32,hasher:m,iterations:1}),init:function(O){this.cfg=this.cfg.extend(O)},compute:function(O,d){for(var A,I=this.cfg,M=I.hasher.create(),C=u.create(),S=C.words,w=I.keySize,p=I.iterations;S.length<w;){A&&M.update(A),A=M.update(O).finalize(d),M.reset();for(var y=1;y<p;y++)A=M.finalize(A),M.reset();C.concat(A)}return C.sigBytes=w*4,C}});o.EvpKDF=function(O,d,A){return E.create(A).compute(O,d)}}(),i.EvpKDF})},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(27))})(this,function(i){i.lib.Cipher||function(o){var l=i,c=l.lib,u=c.Base,f=c.WordArray,m=c.BufferedBlockAlgorithm,E=l.enc,O=E.Utf8,d=E.Base64,A=l.algo,I=A.EvpKDF,M=c.Cipher=m.extend({cfg:u.extend(),createEncryptor:function(R,P){return this.create(this._ENC_XFORM_MODE,R,P)},createDecryptor:function(R,P){return this.create(this._DEC_XFORM_MODE,R,P)},init:function(R,P,$){this.cfg=this.cfg.extend($),this._xformMode=R,this._key=P,this.reset()},reset:function(){m.reset.call(this),this._doReset()},process:function(R){return this._append(R),this._process()},finalize:function(R){R&&this._append(R);var P=this._doFinalize();return P},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function R(P){return typeof P=="string"?F:L}return function(P){return{encrypt:function($,W,Z){return R(W).encrypt(P,$,W,Z)},decrypt:function($,W,Z){return R(W).decrypt(P,$,W,Z)}}}}()}),C=c.StreamCipher=M.extend({_doFinalize:function(){var R=this._process(!0);return R},blockSize:1}),S=l.mode={},w=c.BlockCipherMode=u.extend({createEncryptor:function(R,P){return this.Encryptor.create(R,P)},createDecryptor:function(R,P){return this.Decryptor.create(R,P)},init:function(R,P){this._cipher=R,this._iv=P}}),p=S.CBC=function(){var R=w.extend();R.Encryptor=R.extend({processBlock:function($,W){var Z=this._cipher,et=Z.blockSize;P.call(this,$,W,et),Z.encryptBlock($,W),this._prevBlock=$.slice(W,W+et)}}),R.Decryptor=R.extend({processBlock:function($,W){var Z=this._cipher,et=Z.blockSize,Y=$.slice(W,W+et);Z.decryptBlock($,W),P.call(this,$,W,et),this._prevBlock=Y}});function P($,W,Z){var et,Y=this._iv;Y?(et=Y,this._iv=o):et=this._prevBlock;for(var G=0;G<Z;G++)$[W+G]^=et[G]}return R}(),y=l.pad={},g=y.Pkcs7={pad:function(R,P){for(var $=P*4,W=$-R.sigBytes%$,Z=W<<24|W<<16|W<<8|W,et=[],Y=0;Y<W;Y+=4)et.push(Z);var G=f.create(et,W);R.concat(G)},unpad:function(R){var P=R.words[R.sigBytes-1>>>2]&255;R.sigBytes-=P}},v=c.BlockCipher=M.extend({cfg:M.cfg.extend({mode:p,padding:g}),reset:function(){var R;M.reset.call(this);var P=this.cfg,$=P.iv,W=P.mode;this._xformMode==this._ENC_XFORM_MODE?R=W.createEncryptor:(R=W.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==R?this._mode.init(this,$&&$.words):(this._mode=R.call(W,this,$&&$.words),this._mode.__creator=R)},_doProcessBlock:function(R,P){this._mode.processBlock(R,P)},_doFinalize:function(){var R,P=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(P.pad(this._data,this.blockSize),R=this._process(!0)):(R=this._process(!0),P.unpad(R)),R},blockSize:128/32}),h=c.CipherParams=u.extend({init:function(R){this.mixIn(R)},toString:function(R){return(R||this.formatter).stringify(this)}}),T=l.format={},x=T.OpenSSL={stringify:function(R){var P,$=R.ciphertext,W=R.salt;return W?P=f.create([1398893684,1701076831]).concat(W).concat($):P=$,P.toString(d)},parse:function(R){var P,$=d.parse(R),W=$.words;return W[0]==1398893684&&W[1]==1701076831&&(P=f.create(W.slice(2,4)),W.splice(0,4),$.sigBytes-=16),h.create({ciphertext:$,salt:P})}},L=c.SerializableCipher=u.extend({cfg:u.extend({format:x}),encrypt:function(R,P,$,W){W=this.cfg.extend(W);var Z=R.createEncryptor($,W),et=Z.finalize(P),Y=Z.cfg;return h.create({ciphertext:et,key:$,iv:Y.iv,algorithm:R,mode:Y.mode,padding:Y.padding,blockSize:R.blockSize,formatter:W.format})},decrypt:function(R,P,$,W){W=this.cfg.extend(W),P=this._parse(P,W.format);var Z=R.createDecryptor($,W).finalize(P.ciphertext);return Z},_parse:function(R,P){return typeof R=="string"?P.parse(R,this):R}}),z=l.kdf={},H=z.OpenSSL={execute:function(R,P,$,W){W||(W=f.random(64/8));var Z=I.create({keySize:P+$}).compute(R,W),et=f.create(Z.words.slice(P),$*4);return Z.sigBytes=P*4,h.create({key:Z,iv:et,salt:W})}},F=c.PasswordBasedCipher=L.extend({cfg:L.cfg.extend({kdf:H}),encrypt:function(R,P,$,W){W=this.cfg.extend(W);var Z=W.kdf.execute($,R.keySize,R.ivSize);W.iv=Z.iv;var et=L.encrypt.call(this,R,P,Z.key,W);return et.mixIn(Z),et},decrypt:function(R,P,$,W){W=this.cfg.extend(W),P=this._parse(P,W.format);var Z=W.kdf.execute($,R.keySize,R.ivSize,P.salt);W.iv=Z.iv;var et=L.decrypt.call(this,R,P,Z.key,W);return et}})}()})},function(s,t,n){"use strict";t.__esModule=!0,t.Request=t.createRequest=void 0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(11)),c=i.__importDefault(n(0)),u=i.__importDefault(n(7)),f=i.__importDefault(n(5)),m=i.__importDefault(n(8)),E=i.__importDefault(n(3)),O=i.__importDefault(n(20)),d=o.getGlobalObject(),A=function(){},I=d._ablyjs_jsonp={};I._=function(g){return I["_"+g]||A};var M=1,C="jsonp";function S(g,v,h,T,x,L,z){return L=L||m.default.TIMEOUTS,new p(void 0,g,v,o.copy(h),T,x,L,z)}t.createRequest=S;var w=function(g){i.__extends(v,g);function v(h,T,x){var L=g.call(this,h,T,x)||this;return L.shortName=C,x.stream=!1,L}return v.isAvailable=function(){return c.default.Config.jsonpSupported&&c.default.Config.allowComet},v.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},v.prototype.createRequest=function(h,T,x,L,z,H,F){return H=(this===null||this===void 0?void 0:this.timeouts)||H||m.default.TIMEOUTS,S(h,T,x,L,z,H,F)},v}(l.default),p=function(g){i.__extends(v,g);function v(h,T,x,L,z,H,F,R){var P=g.call(this)||this;return h===void 0&&(h=M++),P.id=h,P.uri=T,P.params=L||{},P.params.rnd=o.cheapRandStr(),x&&(x["X-Ably-Version"]&&(P.params.v=x["X-Ably-Version"]),x["X-Ably-Lib"]&&(P.params.lib=x["X-Ably-Lib"])),P.body=z,P.method=R,P.requestMode=H,P.timeouts=F,P.requestComplete=!1,P}return v.prototype.exec=function(){var h=this,T=this.id,x=this.body,L=this.method,z=this.uri,H=this.params;H.callback="_ablyjs_jsonp._("+T+")",H.envelope="jsonp",x&&(H.body=x),L&&L!=="get"&&(H.method=L);var F=this.script=document.createElement("script"),R=z+o.toQueryString(H);F.src=R,F.src.split("/").slice(-1)[0]!==R.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),F.async=!0,F.type="text/javascript",F.charset="UTF-8",F.onerror=function(W){h.complete(new f.default("JSONP script error (event: "+c.default.Config.inspect(W)+")",null,400))},I["_"+T]=function(W){if(W.statusCode){var Z=W.response;if(W.statusCode==204)h.complete(null,null,null,W.statusCode);else if(!Z)h.complete(new f.default("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||o.isArray(Z))h.complete(null,Z,W.headers,W.statusCode);else{var et=Z.error||new f.default("Error response received from server",null,W.statusCode);h.complete(et)}}else h.complete(null,W)};var P=this.requestMode==O.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),P);var $=document.getElementsByTagName("head")[0];$.insertBefore(F,$.firstChild)},v.prototype.complete=function(h,T,x,L){if(x=x||{},!this.requestComplete){this.requestComplete=!0;var z=void 0;T&&(z=typeof T=="string"?"text/plain":"application/json",x["content-type"]=z,this.emit("data",T)),this.emit("complete",h,T,x,!0,L),this.dispose()}},v.prototype.abort=function(){this.dispose()},v.prototype.dispose=function(){var h=this.timer;h&&(clearTimeout(h),this.timer=null);var T=this.script;T.parentNode&&T.parentNode.removeChild(T),delete I[this.id],this.emit("disposed")},v}(u.default);t.Request=p;function y(g){return d.JSONPTransport=w,w.isAvailable()&&(g.supportedTransports[C]=w),w}t.default=y},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(3)),c=i.__importDefault(n(8)),u=i.__importDefault(n(16)),f=i.__importDefault(n(45)),m=i.__importDefault(n(18)),E=i.__importDefault(n(33)),O=i.__importDefault(n(5)),d=i.__importDefault(n(48)),A=i.__importDefault(n(17)),I=i.__importDefault(n(0)),M=function(){},C=function(){function w(p){if(!p){var y="no options provided";throw l.default.logAction(l.default.LOG_ERROR,"Rest()",y),new Error(y)}var g=c.default.objectifyOptions(p);g.log&&l.default.setLog(g.log.level,g.log.handler),l.default.logAction(l.default.LOG_MICRO,"Rest()","initialized with clientOptions "+I.default.Config.inspect(p));var v=this.options=c.default.normaliseOptions(g);if(v.key){var h=v.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!h){var y="invalid key parameter";throw l.default.logAction(l.default.LOG_ERROR,"Rest()",y),new O.default(y,40400,404)}v.keyName=h[1],v.keySecret=h[2]}if("clientId"in v)if(typeof v.clientId=="string"||v.clientId===null){if(v.clientId==="*")throw new O.default('Can\u2019t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new O.default("clientId must be either a string or null",40012,400);l.default.logAction(l.default.LOG_MINOR,"Rest()","started; version = "+c.default.version),this.baseUri=this.authority=function(T){return c.default.getHttpScheme(v)+T+":"+c.default.getPort(v,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new I.default.Http,this.auth=new u.default(this,v),this.channels=new S(this),this.push=new f.default(this)}return w.prototype.stats=function(p,y){if(y===void 0)if(typeof p=="function")y=p,p=null;else{if(this.options.promises)return o.promisify(this,"stats",arguments);y=M}var g=o.defaultGetHeaders(),v=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,h=this.http.supportsLinkHeaders?void 0:v;this.options.headers&&o.mixin(g,this.options.headers),new m.default(this,"/stats",g,h,function(T,x,L){for(var z=L?T:JSON.parse(T),H=0;H<z.length;H++)z[H]=d.default.fromValues(z[H]);return z}).get(p,y)},w.prototype.time=function(p,y){var g=this;if(y===void 0){if(typeof p=="function")y=p,p=null;else if(this.options.promises)return o.promisify(this,"time",arguments)}var v=y||M,h=o.defaultGetHeaders();this.options.headers&&o.mixin(h,this.options.headers);var T=function(x){return g.authority(x)+"/time"};this.http.do(A.default.Get,this,T,h,null,p,function(x,L,z,H){if(x){v(x);return}H||(L=JSON.parse(L));var F=L[0];if(!F){v(new O.default("Internal error (unexpected result type from GET /time)",5e4,500));return}g.serverTimeOffset=F-o.now(),v(null,F)})},w.prototype.request=function(p,y,g,v,h,T){var x=this.options.useBinaryProtocol,L=x?I.default.Config.msgpack.encode:JSON.stringify,z=x?I.default.Config.msgpack.decode:JSON.parse,H=x?o.Format.msgpack:o.Format.json,F=this.http.supportsLinkHeaders?void 0:H;g=g||{};var R=p.toLowerCase(),P=R=="get"?o.defaultGetHeaders(H):o.defaultPostHeaders(H);if(T===void 0){if(this.options.promises)return o.promisify(this,"request",arguments);T=M}typeof v!="string"&&(v=L(v)),this.options.headers&&o.mixin(P,this.options.headers),h&&o.mixin(P,h);var $=new m.default(this,y,P,F,function(W,Z,et){return o.ensureArray(et?W:z(W))},!0);if(!o.arrIn(I.default.Http.methods,R))throw new O.default("Unsupported method "+R,40500,405);o.arrIn(I.default.Http.methodsWithBody,R)?$[R](g,v,T):$[R](g,T)},w.prototype.setLog=function(p){l.default.setLog(p.level,p.handler)},w.Promise=function(p){return p=c.default.objectifyOptions(p),p.promises=!0,new w(p)},w.Callbacks=w,w.Platform=I.default,w}(),S=function(){function w(p){this.rest=p,this.all={}}return w.prototype.get=function(p,y){p=String(p);var g=this.all[p];return g?y&&g.setOptions(y):this.all[p]=g=new E.default(this.rest,p,y),g},w.prototype.release=function(p){delete this.all[String(p)]},w}();t.default=C},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(o){var l=i,c=l.lib,u=c.WordArray,f=c.Hasher,m=l.algo,E=[],O=[];(function(){function I(w){for(var p=o.sqrt(w),y=2;y<=p;y++)if(!(w%y))return!1;return!0}function M(w){return(w-(w|0))*4294967296|0}for(var C=2,S=0;S<64;)I(C)&&(S<8&&(E[S]=M(o.pow(C,1/2))),O[S]=M(o.pow(C,1/3)),S++),C++})();var d=[],A=m.SHA256=f.extend({_doReset:function(){this._hash=new u.init(E.slice(0))},_doProcessBlock:function(I,M){for(var C=this._hash.words,S=C[0],w=C[1],p=C[2],y=C[3],g=C[4],v=C[5],h=C[6],T=C[7],x=0;x<64;x++){if(x<16)d[x]=I[M+x]|0;else{var L=d[x-15],z=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,H=d[x-2],F=(H<<15|H>>>17)^(H<<13|H>>>19)^H>>>10;d[x]=z+d[x-7]+F+d[x-16]}var R=g&v^~g&h,P=S&w^S&p^w&p,$=(S<<30|S>>>2)^(S<<19|S>>>13)^(S<<10|S>>>22),W=(g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25),Z=T+W+R+O[x]+d[x],et=$+P;T=h,h=v,v=g,g=y+Z|0,y=p,p=w,w=S,S=Z+et|0}C[0]=C[0]+S|0,C[1]=C[1]+w|0,C[2]=C[2]+p|0,C[3]=C[3]+y|0,C[4]=C[4]+g|0,C[5]=C[5]+v|0,C[6]=C[6]+h|0,C[7]=C[7]+T|0},_doFinalize:function(){var I=this._data,M=I.words,C=this._nDataBytes*8,S=I.sigBytes*8;return M[S>>>5]|=128<<24-S%32,M[(S+64>>>9<<4)+14]=o.floor(C/4294967296),M[(S+64>>>9<<4)+15]=C,I.sigBytes=M.length*4,this._process(),this._hash},clone:function(){var I=f.clone.call(this);return I._hash=this._hash.clone(),I}});l.SHA256=f._createHelper(A),l.HmacSHA256=f._createHmacHelper(A)}(Math),i.SHA256})},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return i.enc.Utf8})},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(7)),c=i.__importDefault(n(3)),u=i.__importDefault(n(34)),f=i.__importDefault(n(9)),m=i.__importDefault(n(5)),E=i.__importDefault(n(18)),O=i.__importDefault(n(24)),d=i.__importDefault(n(0));function A(){}var I=9;function M(w){return o.arrEvery(w,function(p){return!p.id})}function C(w){var p=w||{};if(p.cipher){if(!d.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var y=d.default.Crypto.getCipher(p.cipher);p.cipher=y.cipherParams,p.channelCipher=y.cipher}else"cipher"in p&&(p.cipher=void 0,p.channelCipher=null);return p}var S=function(w){i.__extends(p,w);function p(y,g,v){var h=w.call(this)||this;return c.default.logAction(c.default.LOG_MINOR,"Channel()","started; name = "+g),h.rest=y,h.name=g,h.basePath="/channels/"+encodeURIComponent(g),h.presence=new u.default(h),h.channelOptions=C(v),h}return p.prototype.setOptions=function(y){this.channelOptions=C(y)},p.prototype.history=function(y,g){if(c.default.logAction(c.default.LOG_MICRO,"Channel.history()","channel = "+this.name),g===void 0)if(typeof y=="function")g=y,y=null;else{if(this.rest.options.promises)return o.promisify(this,"history",arguments);g=A}this._history(y,g)},p.prototype._history=function(y,g){var v=this.rest,h=v.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,T=this.rest.http.supportsLinkHeaders?void 0:h,x=o.defaultGetHeaders(h);v.options.headers&&o.mixin(x,v.options.headers);var L=this.channelOptions;new E.default(v,this.basePath+"/messages",x,T,function(z,H,F){return f.default.fromResponseBody(z,L,F?void 0:h)}).get(y,g)},p.prototype.publish=function(){var y=this,g=arguments.length,v=arguments[0],h=arguments[1],T=arguments[g-1],x,L;if(typeof T!="function"){if(this.rest.options.promises)return o.promisify(this,"publish",arguments);T=A}if(typeof v=="string"||v===null)x=[f.default.fromValues({name:v,data:h})],L=arguments[2];else if(o.isObject(v))x=[f.default.fromValues(v)],L=arguments[1];else if(o.isArray(v))x=f.default.fromValuesArray(v),L=arguments[1];else throw new m.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof L!="object"||!L)&&(L={});var z=this.rest,H=z.options,F=H.useBinaryProtocol?o.Format.msgpack:o.Format.json,R=z.options.idempotentRestPublishing,P=o.defaultPostHeaders(F);if(H.headers&&o.mixin(P,H.headers),R&&M(x)){var $=o.randomString(I);o.arrForEach(x,function(W,Z){W.id=$+":"+Z.toString()})}f.default.encodeArray(x,this.channelOptions,function(W){if(W){T(W);return}var Z=f.default.getMessagesSize(x),et=H.maxMessageSize;if(Z>et){T(new m.default("Maximum size of messages that can be published at once exceeded ( was "+Z+" bytes; limit is "+et+" bytes)",40009,400));return}y._publish(f.default.serialize(x,F),P,L,T)})},p.prototype._publish=function(y,g,v,h){O.default.post(this.rest,this.basePath+"/messages",y,g,v,null,h)},p.prototype.status=function(y){if(typeof y!="function"&&this.rest.options.promises)return o.promisify(this,"status",[]);var g=this.rest.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,v=o.defaultPostHeaders(g);O.default.get(this.rest,this.basePath,v,{},g,y||A)},p}(l.default);t.default=S},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(7)),c=i.__importDefault(n(3)),u=i.__importDefault(n(18)),f=i.__importDefault(n(14));function m(){}var E=function(O){i.__extends(d,O);function d(A){var I=O.call(this)||this;return I.channel=A,I.basePath=A.basePath+"/presence",I}return d.prototype.get=function(A,I){if(c.default.logAction(c.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),I===void 0)if(typeof A=="function")I=A,A=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"get",arguments);I=m}var M=this.channel.rest,C=M.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,S=this.channel.rest.http.supportsLinkHeaders?void 0:C,w=o.defaultGetHeaders(C);M.options.headers&&o.mixin(w,M.options.headers);var p=this.channel.channelOptions;new u.default(M,this.basePath,w,S,function(y,g,v){return f.default.fromResponseBody(y,p,v?void 0:C)}).get(A,I)},d.prototype.history=function(A,I){c.default.logAction(c.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(A,I)},d.prototype._history=function(A,I){if(I===void 0)if(typeof A=="function")I=A,A=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"_history",arguments);I=m}var M=this.channel.rest,C=M.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,S=this.channel.rest.http.supportsLinkHeaders?void 0:C,w=o.defaultGetHeaders(C);M.options.headers&&o.mixin(w,M.options.headers);var p=this.channel.channelOptions;new u.default(M,this.basePath+"/history",w,S,function(y,g,v){return f.default.fromResponseBody(y,p,v?void 0:C)}).get(A,I)},d}(l.default);t.default=E},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(7)),l=i.__importDefault(n(3)),c=function(u){i.__extends(f,u);function f(){var m=u.call(this)||this;return m.messages=[],m}return f.prototype.count=function(){return this.messages.length},f.prototype.push=function(m){this.messages.push(m)},f.prototype.shift=function(){return this.messages.shift()},f.prototype.last=function(){return this.messages[this.messages.length-1]},f.prototype.copyAll=function(){return this.messages.slice()},f.prototype.append=function(m){this.messages.push.apply(this.messages,m)},f.prototype.prepend=function(m){this.messages.unshift.apply(this.messages,m)},f.prototype.completeMessages=function(m,E,O){l.default.logAction(l.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+m+"; count = "+E),O=O||null;var d=this.messages;if(d.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var A=d[0];if(A){var I=A.message.msgSerial,M=m+E;if(M>I)for(var C=d.splice(0,M-I),S=0,w=C;S<w.length;S++){var p=w[S];p.callback(O)}d.length==0&&this.emit("idle")}},f.prototype.completeAllMessages=function(m){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,m)},f.prototype.clear=function(){l.default.logAction(l.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},f}(o.default);t.default=c},function(s,t,n){"use strict";t.__esModule=!0;var i=function(){function o(l,c,u,f){this.previous=l,this.current=c,u&&(this.retryIn=u),f&&(this.reason=f)}return o}();t.default=i},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(10)),l=i.__importDefault(n(7)),c=i.__importStar(n(2)),u=i.__importDefault(n(33)),f=i.__importDefault(n(3)),m=i.__importDefault(n(54)),E=i.__importDefault(n(9)),O=i.__importDefault(n(38)),d=i.__importDefault(n(5)),A=i.__importDefault(n(14)),I=i.__importDefault(n(19)),M=o.default.Action,C=function(){},S="statechange",w="sync";function p(g){if(g&&"params"in g&&!c.isObject(g.params))return new d.default("options.params must be an object",4e4,400);if(g&&"modes"in g){if(!c.isArray(g.modes))return new d.default("options.modes must be an array",4e4,400);for(var v=0;v<g.modes.length;v++){var h=g.modes[v];if(!h||typeof h!="string"||!c.arrIn(o.default.channelModes,String.prototype.toUpperCase.call(h)))return new d.default("Invalid channel mode: "+h,4e4,400)}}}var y=function(g){i.__extends(v,g);function v(h,T,x){var L=g.call(this,h,T,x)||this;return L.retryCount=0,L.history=function(z,H){if(f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),H===void 0)if(typeof z=="function")H=z,z=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);H=C}if(z&&z.untilAttach){if(this.state!=="attached"){H(new d.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){H(new d.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete z.untilAttach,z.from_serial=this.properties.attachSerial}u.default.prototype._history.call(this,z,H)},L.whenState=function(z,H){return l.default.prototype.whenState.call(L,z,L.state,H)},f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel()","started; name = "+T),L.realtime=h,L.presence=new m.default(L),L.connectionManager=h.connection.connectionManager,L.state="initialized",L.subscriptions=new l.default,L.syncChannelSerial=void 0,L.properties={attachSerial:void 0},L.setOptions(x),L.errorReason=null,L._requestedFlags=null,L._mode=null,L._attachedMsgIndicator=!1,L._attachResume=!1,L._decodingContext={channelOptions:L.channelOptions,plugins:h.options.plugins||{},baseEncodedPreviousPayload:void 0},L._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},L._allChannelChanges=new l.default,L}return v.invalidStateError=function(h){return{statusCode:400,code:90001,message:"Channel operation failed as channel state is "+h}},v.processListenerArgs=function(h){return h=Array.prototype.slice.call(h),typeof h[0]=="function"&&h.unshift(null),h[h.length-1]==null&&h.pop(),h},v.prototype.setOptions=function(h,T){if(!T&&this.rest.options.promises)return c.promisify(this,"setOptions",arguments);var x=T||function(z){z&&f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+z.toString())},L=p(h);if(L){x(L);return}u.default.prototype.setOptions.call(this,h),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(h)?(this.attachImpl(),this._allChannelChanges.once(function(z){switch(this.event){case"update":case"attached":x==null||x(null);return;default:x==null||x(z.reason);return}})):x()},v.prototype._shouldReattachToSetOptions=function(h){return(this.state==="attached"||this.state==="attaching")&&(h.params||h.modes)},v.prototype.publish=function(){for(var h=this,T=[],x=0;x<arguments.length;x++)T[x]=arguments[x];var L=T[0],z=T.length,H=T[z-1];if(typeof H!="function"){if(this.realtime.options.promises)return c.promisify(this,"publish",arguments);H=C,++z}if(!this.connectionManager.activeState()){H(this.connectionManager.getError());return}if(z==2)if(c.isObject(L))L=[E.default.fromValues(L)];else if(c.isArray(L))L=E.default.fromValuesArray(L);else throw new d.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else L=[E.default.fromValues({name:T[0],data:T[1]})];var F=this.realtime.options.maxMessageSize;E.default.encodeArray(L,this.channelOptions,function(R){if(R){H(R);return}var P=E.default.getMessagesSize(L);if(P>F){H(new d.default("Maximum size of messages that can be published at once exceeded ( was "+P+" bytes; limit is "+F+" bytes)",40009,400));return}h.__publish(L,H)})},v.prototype.__publish=function(h,T){f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+h.length);var x=this.state;switch(x){case"failed":case"suspended":T(d.default.fromValues(v.invalidStateError(x)));break;default:{f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+x);var L=new o.default;L.action=M.MESSAGE,L.channel=this.name,L.messages=h,this.sendMessage(L,T);break}}},v.prototype.onEvent=function(h){f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var T=this.subscriptions,x=0;x<h.length;x++){var L=h[x];T.emit(L.name,L)}},v.prototype.attach=function(h,T){var x;if(typeof h=="function"?(T=h,x=null):x=h,!T){if(this.realtime.options.promises)return c.promisify(this,"attach",arguments);T=function(L){L&&f.default.logAction(f.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+L.toString())}}if(x)f.default.deprecated("channel.attach() with flags","channel.setOptions() with channelOptions.params"),this._requestedFlags=x;else if(this.state==="attached"){T();return}this._attach(!1,null,T)},v.prototype._attach=function(h,T,x){x||(x=function(z){z&&f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+z.toString())});var L=this.connectionManager;if(!L.activeState()){x(L.getError());return}(this.state!=="attaching"||h)&&this.requestState("attaching",T),this.once(function(z){switch(this.event){case"attached":x==null||x();break;case"detached":case"suspended":case"failed":x==null||x(z.reason||L.getError()||new d.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":x==null||x(new d.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},v.prototype.attachImpl=function(){f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message"),this.setInProgress(S,!0);var h=o.default.fromValues({action:M.ATTACH,channel:this.name,params:this.channelOptions.params});this._requestedFlags?h.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&h.encodeModesToFlags(c.allToUpperCase(this.channelOptions.modes)),this._attachResume&&h.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(h.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(h,C)},v.prototype.detach=function(h){if(!h){if(this.realtime.options.promises)return c.promisify(this,"detach",arguments);h=C}var T=this.connectionManager;if(!T.activeState()){h(T.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),h();break;case"detached":h();break;case"failed":h(new d.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(x){switch(this.event){case"detached":h();break;case"attached":case"suspended":case"failed":h(x.reason||T.getError()||new d.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":h(new d.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},v.prototype.detachImpl=function(h){this.connectionManager.mostRecentMsg&&this.connectionManager.mostRecentMsg.channel===this.name&&(this.connectionManager.mostRecentMsg=null),f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message"),this.setInProgress(S,!0);var T=o.default.fromValues({action:M.DETACH,channel:this.name});this.sendMessage(T,h||C)},v.prototype.subscribe=function(){for(var h=[],T=0;T<arguments.length;T++)h[T]=arguments[T];var x=v.processListenerArgs(h),L=x[0],z=x[1],H=x[2];if(!H&&this.realtime.options.promises)return c.promisify(this,"subscribe",[L,z]);if(this.state==="failed"){H==null||H(d.default.fromValues(v.invalidStateError("failed")));return}return L&&typeof L=="object"&&!Array.isArray(L)?this._subscribeFilter(L,z):this.subscriptions.on(L,z),this.attach(H||C)},v.prototype._subscribeFilter=function(h,T){var x=function(L){var z,H,F,R,P,$,W={name:L.name,refTimeserial:(H=(z=L.extras)===null||z===void 0?void 0:z.ref)===null||H===void 0?void 0:H.timeserial,refType:(R=(F=L.extras)===null||F===void 0?void 0:F.ref)===null||R===void 0?void 0:R.type,isRef:!!(!(($=(P=L.extras)===null||P===void 0?void 0:P.ref)===null||$===void 0)&&$.timeserial),clientId:L.clientId};Object.entries(h).find(function(Z){var et=Z[0],Y=Z[1];return Y!==void 0?W[et]!==Y:!1})||T(L)};this._addFilteredSubscription(h,T,x),this.subscriptions.on(x)},v.prototype._addFilteredSubscription=function(h,T,x){var L;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(T)){var z=this.filteredSubscriptions.get(T);z.set(h,((L=z==null?void 0:z.get(h))===null||L===void 0?void 0:L.concat(x))||[x])}else this.filteredSubscriptions.set(T,new Map([[h,[x]]]))},v.prototype._getAndDeleteFilteredSubscriptions=function(h,T){var x=this;if(!this.filteredSubscriptions)return[];if(!T&&h)return Array.from(this.filteredSubscriptions.entries()).map(function(F){var R,P=F[0],$=F[1],W=$.get(h);return $.delete(h),$.size===0&&((R=x.filteredSubscriptions)===null||R===void 0||R.delete(P)),W}).reduce(function(F,R){var P;return R?(P=F).concat.apply(P,R):F},[]);if(!T||!this.filteredSubscriptions.has(T))return[];var L=this.filteredSubscriptions.get(T);if(!h){var z=Array.from(L.values()).reduce(function(F,R){return F.concat.apply(F,R)},[]);return this.filteredSubscriptions.delete(T),z}var H=L.get(h);return L.delete(h),H||[]},v.prototype.unsubscribe=function(){for(var h=this,T,x=[],L=0;L<arguments.length;L++)x[L]=arguments[L];var z=v.processListenerArgs(x),H=z[0],F=z[1];if(typeof H=="object"&&!F||((T=this.filteredSubscriptions)===null||T===void 0?void 0:T.has(F))){this._getAndDeleteFilteredSubscriptions(H,F).forEach(function(R){return h.subscriptions.off(R)});return}this.subscriptions.off(H,F)},v.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new d.default("Unable to sync to channel; not attached",4e4);default:}var h=this.connectionManager;if(!h.activeState())throw h.getError();var T=o.default.fromValues({action:M.SYNC,channel:this.name});this.syncChannelSerial&&(T.channelSerial=this.syncChannelSerial),h.send(T)},v.prototype.sendMessage=function(h,T){this.connectionManager.send(h,this.realtime.options.queueMessages,T)},v.prototype.sendPresence=function(h,T){var x=o.default.fromValues({action:M.PRESENCE,channel:this.name,presence:c.isArray(h)?A.default.fromValuesArray(h):[A.default.fromValues(h)]});this.sendMessage(x,T)},v.prototype.onMessage=function(h){var T,x=!1;switch(h.action){case M.ATTACHED:{this._attachedMsgIndicator=!0,this.properties.attachSerial=h.channelSerial,this._mode=h.getMode(),this.params=h.params||{};var L=h.decodeModesFromFlags();this.modes=L&&c.allToLowerCase(L)||void 0;var z=h.hasFlag("RESUMED"),H=h.hasFlag("HAS_PRESENCE");if(this.state==="attached"){this.setInProgress(S,!1),z||this.presence.onAttached(H);var F=new O.default(this.state,this.state,z,h.error);this._allChannelChanges.emit("update",F),(!z||this.channelOptions.updateOnAttached)&&this.emit("update",F)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",h.error,z,H);break}case M.DETACHED:{var R=h.error?d.default.fromValues(h.error):new d.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",R):this.state==="attaching"?this.notifyState("suspended",R):this.requestState("attaching",R);break}case M.SYNC:if(x=!0,T=this.syncChannelSerial=h.channelSerial,!h.presence)break;case M.PRESENCE:{for(var P=h.presence,$=h.id,W=h.connectionId,Z=h.timestamp,et=this.channelOptions,Y=void 0,G=0;G<P.length;G++)try{Y=P[G],A.default.decode(Y,et),Y.connectionId||(Y.connectionId=W),Y.timestamp||(Y.timestamp=Z),Y.id||(Y.id=$+":"+G)}catch(ct){f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel.onMessage()",ct.toString())}this.presence.setPresence(P,x,T);break}case M.MESSAGE:{if(this.state!=="attached"){f.default.logAction(f.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+h.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var N=h.messages,U=N[0],K=N[N.length-1],$=h.id,W=h.connectionId,Z=h.timestamp;if(U.extras&&U.extras.delta&&U.extras.delta.from!==this._lastPayload.messageId){var j='Delta message decode failure - previous message not available for message "'+h.id+'" on this channel "'+this.name+'".';f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel.onMessage()",j),this._startDecodeFailureRecovery(new d.default(j,40018,400));break}for(var G=0;G<N.length;G++){var j=N[G];try{E.default.decode(j,this._decodingContext)}catch(pt){switch(f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel.onMessage()",pt.toString()),pt.code){case 40018:this._startDecodeFailureRecovery(pt);return;case 40019:case 40021:this.notifyState("failed",pt);return}}j.connectionId||(j.connectionId=W),j.timestamp||(j.timestamp=Z),j.id||(j.id=$+":"+G)}this._lastPayload.messageId=K.id,this._lastPayload.protocolMessageChannelSerial=h.channelSerial,this.onEvent(N);break}case M.ERROR:{var nt=h.error;nt&&nt.code==80016?this.checkPendingState():this.notifyState("failed",d.default.fromValues(nt));break}default:f.default.logAction(f.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+h.action+")"),this.connectionManager.abort(I.default.unknownChannelErr)}},v.prototype._startDecodeFailureRecovery=function(h){var T=this;this._lastPayload.decodeFailureRecoveryInProgress||(f.default.logAction(f.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,h,function(){T._lastPayload.decodeFailureRecoveryInProgress=!1}))},v.prototype.onAttached=function(){f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},v.prototype.notifyState=function(h,T,x,L){if(f.default.logAction(f.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+h),this.clearStateTimer(),h!==this.state){this.presence.actOnChannelState(h,L,T),h==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),T&&(this.errorReason=T);var z=new O.default(this.state,h,x,T),H=h==="failed"?f.default.LOG_ERROR:f.default.LOG_MAJOR;f.default.logAction(H,'Channel state for channel "'+this.name+'"',h+(T?"; reason: "+T:"")),h!=="attaching"&&h!=="suspended"&&(this.retryCount=0),h==="attached"?(this.onAttached(),this.setInProgress(w,L),this.setInProgress(S,!1)):(h==="detached"||h==="failed"||h==="suspended")&&(this.setInProgress(S,!1),this.setInProgress(w,!1)),h==="attached"?this._attachResume=!0:(h==="detaching"||h==="failed")&&(this._attachResume=!1),this.state=h,this._allChannelChanges.emit(h,z),this.emit(h,z)}},v.prototype.requestState=function(h,T){f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+h),this.notifyState(h,T),this.checkPendingState()},v.prototype.checkPendingState=function(){var h=this.connectionManager.state;if(!(h.sendEvents||h.forceQueueEvents)){f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break;default:break}},v.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var h=new d.default("Channel attach timed out",90007,408);this.notifyState("suspended",h);break}case"detaching":{var h=new d.default("Channel detach timed out",90007,408);this.notifyState("attached",h);break}default:this.checkPendingState();break}},v.prototype.startStateTimerIfNotRunning=function(){var h=this;this.stateTimer||(this.stateTimer=setTimeout(function(){f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),h.stateTimer=null,h.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},v.prototype.clearStateTimer=function(){var h=this.stateTimer;h&&(clearTimeout(h),this.stateTimer=null)},v.prototype.startRetryTimer=function(){var h=this;if(!this.retryTimer){this.retryCount++;var T=this.realtime.options.timeouts.channelRetryTimeout*c.getJitterCoefficient()*c.getBackoffCoefficient(this.retryCount);this.retryTimer=setTimeout(function(){h.state==="suspended"&&h.connectionManager.state.sendEvents&&(h.retryTimer=null,f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),h.requestState("attaching"))},T)}},v.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},v.prototype.setInProgress=function(h,T){this.rest.channels.setInProgress(this,h,T)},v.prototype.getReleaseErr=function(){var h=this.state;return h==="initialized"||h==="detached"||h==="failed"?null:new d.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+h,90001,400)},v.progressOps={statechange:S,sync:w},v}(u.default);t.default=y},function(s,t,n){"use strict";t.__esModule=!0;var i=function(){function o(l,c,u,f){this.previous=l,this.current=c,c==="attached"&&(this.resumed=u),f&&(this.reason=f)}return o}();t.default=i},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(){var o=i,l=o.lib,c=l.WordArray,u=l.Hasher,f=o.algo,m=[],E=f.SHA1=u.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(O,d){for(var A=this._hash.words,I=A[0],M=A[1],C=A[2],S=A[3],w=A[4],p=0;p<80;p++){if(p<16)m[p]=O[d+p]|0;else{var y=m[p-3]^m[p-8]^m[p-14]^m[p-16];m[p]=y<<1|y>>>31}var g=(I<<5|I>>>27)+w+m[p];p<20?g+=(M&C|~M&S)+1518500249:p<40?g+=(M^C^S)+1859775393:p<60?g+=(M&C|M&S|C&S)-1894007588:g+=(M^C^S)-899497514,w=S,S=C,C=M<<30|M>>>2,M=I,I=g}A[0]=A[0]+I|0,A[1]=A[1]+M|0,A[2]=A[2]+C|0,A[3]=A[3]+S|0,A[4]=A[4]+w|0},_doFinalize:function(){var O=this._data,d=O.words,A=this._nDataBytes*8,I=O.sigBytes*8;return d[I>>>5]|=128<<24-I%32,d[(I+64>>>9<<4)+14]=Math.floor(A/4294967296),d[(I+64>>>9<<4)+15]=A,O.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var O=u.clone.call(this);return O._hash=this._hash.clone(),O}});o.SHA1=u._createHelper(E),o.HmacSHA1=u._createHmacHelper(E)}(),i.SHA1})},function(s,t,n){"use strict";t.__esModule=!0;function i(p){if(p===void 0)return"undefined";var y,g;if(p instanceof ArrayBuffer?(g="ArrayBuffer",y=new DataView(p)):p instanceof DataView&&(g="DataView",y=p),!y)return JSON.stringify(p);for(var v=[],h=0;h<p.byteLength;h++){if(h>20){v.push("...");break}var T=y.getUint8(h).toString(16);T.length===1&&(T="0"+T),v.push(T)}return"<"+g+" "+v.join(" ")+">"}function o(p,y,g){for(var v=0,h=g.length;v<h;v++){var T=g.charCodeAt(v);if(T<128){p.setUint8(y++,T>>>0&127|0);continue}if(T<2048){p.setUint8(y++,T>>>6&31|192),p.setUint8(y++,T>>>0&63|128);continue}if(T<65536){p.setUint8(y++,T>>>12&15|224),p.setUint8(y++,T>>>6&63|128),p.setUint8(y++,T>>>0&63|128);continue}if(T<1114112){p.setUint8(y++,T>>>18&7|240),p.setUint8(y++,T>>>12&63|128),p.setUint8(y++,T>>>6&63|128),p.setUint8(y++,T>>>0&63|128);continue}throw new Error("bad codepoint "+T)}}function l(p,y,g){for(var v="",h=y,T=y+g;h<T;h++){var x=p.getUint8(h);if((x&128)===0){v+=String.fromCharCode(x);continue}if((x&224)===192){v+=String.fromCharCode((x&15)<<6|p.getUint8(++h)&63);continue}if((x&240)===224){v+=String.fromCharCode((x&15)<<12|(p.getUint8(++h)&63)<<6|(p.getUint8(++h)&63)<<0);continue}if((x&248)===240){v+=String.fromCharCode((x&7)<<18|(p.getUint8(++h)&63)<<12|(p.getUint8(++h)&63)<<6|(p.getUint8(++h)&63)<<0);continue}throw new Error("Invalid byte "+x.toString(16))}return v}function c(p){for(var y=0,g=0,v=p.length;g<v;g++){var h=p.charCodeAt(g);if(h<128){y+=1;continue}if(h<2048){y+=2;continue}if(h<65536){y+=3;continue}if(h<1114112){y+=4;continue}throw new Error("bad codepoint "+h)}return y}function u(p,y){var g=w(p,y);if(g!==0){var v=new ArrayBuffer(g),h=new DataView(v);return S(p,h,0,y),v}}var f=(1<<16)*(1<<16),m=1/f;function E(p,y){return y=y||0,p.getInt32(y)*f+p.getUint32(y+4)}function O(p,y){return y=y||0,p.getUint32(y)*f+p.getUint32(y+4)}function d(p,y,g){g<9223372036854776e3?(p.setInt32(y,Math.floor(g*m)),p.setInt32(y+4,g&-1)):(p.setUint32(y,2147483647),p.setUint32(y+4,2147483647))}function A(p,y,g){g<18446744073709552e3?(p.setUint32(y,Math.floor(g*m)),p.setInt32(y+4,g&-1)):(p.setUint32(y,4294967295),p.setUint32(y+4,4294967295))}var I=function(){function p(y,g){var v=this;this.map=function(h){for(var T={},x=0;x<h;x++){var L=v.parse();T[L]=v.parse()}return T},this.bin=function(h){var T=new ArrayBuffer(h);return new Uint8Array(T).set(new Uint8Array(v.view.buffer,v.offset,h),0),v.offset+=h,T},this.buf=this.bin,this.str=function(h){var T=l(v.view,v.offset,h);return v.offset+=h,T},this.array=function(h){for(var T=new Array(h),x=0;x<h;x++)T[x]=v.parse();return T},this.ext=function(h){return v.offset+=h,{type:v.view.getInt8(v.offset),data:v.buf(h)}},this.parse=function(){var h=v.view.getUint8(v.offset),T,x;if((h&128)===0)return v.offset++,h;if((h&240)===128)return x=h&15,v.offset++,v.map(x);if((h&240)===144)return x=h&15,v.offset++,v.array(x);if((h&224)===160)return x=h&31,v.offset++,v.str(x);if((h&224)===224)return T=v.view.getInt8(v.offset),v.offset++,T;switch(h){case 192:return v.offset++,null;case 193:v.offset++;return;case 194:return v.offset++,!1;case 195:return v.offset++,!0;case 196:return x=v.view.getUint8(v.offset+1),v.offset+=2,v.bin(x);case 197:return x=v.view.getUint16(v.offset+1),v.offset+=3,v.bin(x);case 198:return x=v.view.getUint32(v.offset+1),v.offset+=5,v.bin(x);case 199:return x=v.view.getUint8(v.offset+1),v.offset+=2,v.ext(x);case 200:return x=v.view.getUint16(v.offset+1),v.offset+=3,v.ext(x);case 201:return x=v.view.getUint32(v.offset+1),v.offset+=5,v.ext(x);case 202:return T=v.view.getFloat32(v.offset+1),v.offset+=5,T;case 203:return T=v.view.getFloat64(v.offset+1),v.offset+=9,T;case 204:return T=v.view.getUint8(v.offset+1),v.offset+=2,T;case 205:return T=v.view.getUint16(v.offset+1),v.offset+=3,T;case 206:return T=v.view.getUint32(v.offset+1),v.offset+=5,T;case 207:return T=O(v.view,v.offset+1),v.offset+=9,T;case 208:return T=v.view.getInt8(v.offset+1),v.offset+=2,T;case 209:return T=v.view.getInt16(v.offset+1),v.offset+=3,T;case 210:return T=v.view.getInt32(v.offset+1),v.offset+=5,T;case 211:return T=E(v.view,v.offset+1),v.offset+=9,T;case 212:return x=1,v.offset++,v.ext(x);case 213:return x=2,v.offset++,v.ext(x);case 214:return x=4,v.offset++,v.ext(x);case 215:return x=8,v.offset++,v.ext(x);case 216:return x=16,v.offset++,v.ext(x);case 217:return x=v.view.getUint8(v.offset+1),v.offset+=2,v.str(x);case 218:return x=v.view.getUint16(v.offset+1),v.offset+=3,v.str(x);case 219:return x=v.view.getUint32(v.offset+1),v.offset+=5,v.str(x);case 220:return x=v.view.getUint16(v.offset+1),v.offset+=3,v.array(x);case 221:return x=v.view.getUint32(v.offset+1),v.offset+=5,v.array(x);case 222:return x=v.view.getUint16(v.offset+1),v.offset+=3,v.map(x);case 223:return x=v.view.getUint32(v.offset+1),v.offset+=5,v.map(x)}throw new Error("Unknown type 0x"+h.toString(16))},this.offset=g||0,this.view=y}return p}();function M(p){var y=new DataView(p),g=new I(y),v=g.parse();if(g.offset!==p.byteLength)throw new Error(p.byteLength-g.offset+" trailing bytes");return v}function C(p,y){return Object.keys(p).filter(function(g){var v=p[g],h=typeof v;return(!y||v!=null)&&(h!=="function"||!!v.toJSON)})}function S(p,y,g,v){var h=typeof p;if(typeof p=="string"){var T=c(p);if(T<32)return y.setUint8(g,T|160),o(y,g+1,p),1+T;if(T<256)return y.setUint8(g,217),y.setUint8(g+1,T),o(y,g+2,p),2+T;if(T<65536)return y.setUint8(g,218),y.setUint16(g+1,T),o(y,g+3,p),3+T;if(T<4294967296)return y.setUint8(g,219),y.setUint32(g+1,T),o(y,g+5,p),5+T}if(ArrayBuffer.isView&&ArrayBuffer.isView(p)&&(p=p.buffer),p instanceof ArrayBuffer){var x=p.byteLength;if(x<256)return y.setUint8(g,196),y.setUint8(g+1,x),new Uint8Array(y.buffer).set(new Uint8Array(p),g+2),2+x;if(x<65536)return y.setUint8(g,197),y.setUint16(g+1,x),new Uint8Array(y.buffer).set(new Uint8Array(p),g+3),3+x;if(x<4294967296)return y.setUint8(g,198),y.setUint32(g+1,x),new Uint8Array(y.buffer).set(new Uint8Array(p),g+5),5+x}if(typeof p=="number"){if(Math.floor(p)!==p)return y.setUint8(g,203),y.setFloat64(g+1,p),9;if(p>=0){if(p<128)return y.setUint8(g,p),1;if(p<256)return y.setUint8(g,204),y.setUint8(g+1,p),2;if(p<65536)return y.setUint8(g,205),y.setUint16(g+1,p),3;if(p<4294967296)return y.setUint8(g,206),y.setUint32(g+1,p),5;if(p<18446744073709552e3)return y.setUint8(g,207),A(y,g+1,p),9;throw new Error("Number too big 0x"+p.toString(16))}if(p>=-32)return y.setInt8(g,p),1;if(p>=-128)return y.setUint8(g,208),y.setInt8(g+1,p),2;if(p>=-32768)return y.setUint8(g,209),y.setInt16(g+1,p),3;if(p>=-2147483648)return y.setUint8(g,210),y.setInt32(g+1,p),5;if(p>=-9223372036854776e3)return y.setUint8(g,211),d(y,g+1,p),9;throw new Error("Number too small -0x"+(-p).toString(16).substr(1))}if(h==="undefined")return v?0:(y.setUint8(g,212),y.setUint8(g+1,0),y.setUint8(g+2,0),3);if(p===null)return v?0:(y.setUint8(g,192),1);if(h==="boolean")return y.setUint8(g,p?195:194),1;if(typeof p.toJSON=="function")return S(p.toJSON(),y,g,v);if(h==="object"){var L,z=0,H=void 0,F=Array.isArray(p);if(F?L=p.length:(H=C(p,v),L=H.length),L<16?(y.setUint8(g,L|(F?144:128)),z=1):L<65536?(y.setUint8(g,F?220:222),y.setUint16(g+1,L),z=3):L<4294967296&&(y.setUint8(g,F?221:223),y.setUint32(g+1,L),z=5),F)for(var R=0;R<L;R++)z+=S(p[R],y,g+z,v);else if(H)for(var R=0;R<L;R++){var P=H[R];z+=S(P,y,g+z),z+=S(p[P],y,g+z,v)}return z}if(h==="function")return 0;throw new Error("Unknown type "+h)}function w(p,y){var g=typeof p;if(g==="string"){var v=c(p);if(v<32)return 1+v;if(v<256)return 2+v;if(v<65536)return 3+v;if(v<4294967296)return 5+v}if(ArrayBuffer.isView&&ArrayBuffer.isView(p)&&(p=p.buffer),p instanceof ArrayBuffer){var h=p.byteLength;if(h<256)return 2+h;if(h<65536)return 3+h;if(h<4294967296)return 5+h}if(typeof p=="number"){if(Math.floor(p)!==p)return 9;if(p>=0){if(p<128)return 1;if(p<256)return 2;if(p<65536)return 3;if(p<4294967296)return 5;if(p<18446744073709552e3)return 9;throw new Error("Number too big 0x"+p.toString(16))}if(p>=-32)return 1;if(p>=-128)return 2;if(p>=-32768)return 3;if(p>=-2147483648)return 5;if(p>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+p.toString(16).substr(1))}if(g==="boolean")return 1;if(p===null)return y?0:1;if(p===void 0)return y?0:3;if(typeof p.toJSON=="function")return w(p.toJSON(),y);if(g==="object"){var T,x=0;if(Array.isArray(p)){T=p.length;for(var L=0;L<T;L++)x+=w(p[L],y)}else{var z=C(p,y);T=z.length;for(var L=0;L<T;L++){var H=z[L];x+=w(H)+w(p[H],y)}}if(T<16)return 1+x;if(T<65536)return 3+x;if(T<4294967296)return 5+x;throw new Error("Array or object too long 0x"+T.toString(16))}if(g==="function")return 0;throw new Error("Unknown type "+g)}t.default={encode:u,decode:M,inspect:i,utf8Write:o,utf8Read:l,utf8ByteCount:c}},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(30)),l=i.__importDefault(n(49)),c=i.__importDefault(n(0)),u=i.__importDefault(n(55)),f=i.__importDefault(n(57)),m=i.__importDefault(n(62)),E=i.__importDefault(n(63)),O=i.__importDefault(n(67)),d=i.__importDefault(n(3)),A=n(8),I=i.__importDefault(n(25)),M=i.__importDefault(n(64)),C=i.__importDefault(n(65)),S=i.__importDefault(n(40)),w=i.__importDefault(n(9)),p=i.__importDefault(n(14));c.default.Crypto=f.default,c.default.BufferUtils=u.default,c.default.Http=m.default,c.default.Config=E.default,c.default.Transports=O.default,c.default.WebStorage=M.default,o.default.Crypto=f.default,l.default.Crypto=f.default,o.default.Message=w.default,l.default.Message=w.default,o.default.PresenceMessage=p.default,l.default.PresenceMessage=p.default,l.default.ConnectionManager=I.default,d.default.initLogHandlers(),c.default.Defaults=A.getDefaults(C.default),c.default.Config.agent&&(c.default.Defaults.agent+=" "+c.default.Config.agent),c.default.Config.noUpgrade&&(c.default.Defaults.upgradeTransports=[]),t.default={Rest:o.default,Realtime:l.default,msgpack:S.default}},function(s){s.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.29","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.2","ws":"^5.1"},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@types/crypto-js":"^4.0.1","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","async":"ably-forks/async#requirejs","aws-sdk":"^2.1075.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"~2.7","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.4.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","null-loader":"^4.0.1","playwright":"^1.10.0","prettier":"^2.5.1","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^3.5.2","tslib":"^2.3.1","typescript":"^4.2.4","webpack":"^4.44.2","webpack-cli":"^4.2.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"browser/static"},"main":"ably"},"scripts":{"grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","concat":"grunt concat","build":"grunt build:all","build:node":"grunt build:node","build:browser":"grunt build:browser","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","format:check":"prettier --check --ignore-path .gitignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js"}}')},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(31),n(23))})(this,function(i){return i.HmacSHA256})},function(s,t){},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(46)),c=i.__importDefault(n(24)),u=i.__importDefault(n(18)),f=i.__importDefault(n(5)),m=i.__importDefault(n(47)),E=function(){},O=function(){function M(C){this.rest=C,this.admin=new d(C)}return M}(),d=function(){function M(C){this.rest=C,this.deviceRegistrations=new A(C),this.channelSubscriptions=new I(C)}return M.prototype.publish=function(C,S,w){var p=this.rest,y=p.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,g=o.defaultPostHeaders(y),v={},h=o.mixin({recipient:C},S);if(typeof w!="function"){if(this.rest.options.promises)return o.promisify(this,"publish",arguments);w=E}p.options.headers&&o.mixin(g,p.options.headers),p.options.pushFullWait&&o.mixin(v,{fullWait:"true"});var T=o.encodeBody(h,y);c.default.post(p,"/push/publish",T,g,v,null,function(x){return w(x)})},M}(),A=function(){function M(C){this.rest=C}return M.prototype.save=function(C,S){var w=this.rest,p=l.default.fromValues(C),y=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,g=o.defaultPostHeaders(y),v={};if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"save",arguments);S=E}w.options.headers&&o.mixin(g,w.options.headers),w.options.pushFullWait&&o.mixin(v,{fullWait:"true"});var h=o.encodeBody(p,y);c.default.put(w,"/push/deviceRegistrations/"+encodeURIComponent(C.id),h,g,v,null,function(T,x,L,z){S(T,T?void 0:l.default.fromResponseBody(x,z?void 0:y))})},M.prototype.get=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=o.defaultGetHeaders(p),g=C.id||C;if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"get",arguments);S=E}if(typeof g!="string"||!g.length){S(new f.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}w.options.headers&&o.mixin(y,w.options.headers),c.default.get(w,"/push/deviceRegistrations/"+encodeURIComponent(g),y,{},null,function(v,h,T,x){S(v,v?void 0:l.default.fromResponseBody(h,x?void 0:p))})},M.prototype.list=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=this.rest.http.supportsLinkHeaders?void 0:p,g=o.defaultGetHeaders(p);if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"list",arguments);S=E}w.options.headers&&o.mixin(g,w.options.headers),new u.default(w,"/push/deviceRegistrations",g,y,function(v,h,T){return l.default.fromResponseBody(v,T?void 0:p)}).get(C,S)},M.prototype.remove=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=o.defaultGetHeaders(p),g={},v=C.id||C;if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"remove",arguments);S=E}if(typeof v!="string"||!v.length){S(new f.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}w.options.headers&&o.mixin(y,w.options.headers),w.options.pushFullWait&&o.mixin(g,{fullWait:"true"}),c.default.delete(w,"/push/deviceRegistrations/"+encodeURIComponent(v),y,g,null,function(h){return S(h)})},M.prototype.removeWhere=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=o.defaultGetHeaders(p);if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);S=E}w.options.headers&&o.mixin(y,w.options.headers),w.options.pushFullWait&&o.mixin(C,{fullWait:"true"}),c.default.delete(w,"/push/deviceRegistrations",y,C,null,function(g){return S(g)})},M}(),I=function(){function M(C){this.remove=M.prototype.removeWhere,this.rest=C}return M.prototype.save=function(C,S){var w=this.rest,p=m.default.fromValues(C),y=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,g=o.defaultPostHeaders(y),v={};if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"save",arguments);S=E}w.options.headers&&o.mixin(g,w.options.headers),w.options.pushFullWait&&o.mixin(v,{fullWait:"true"});var h=o.encodeBody(p,y);c.default.post(w,"/push/channelSubscriptions",h,g,v,null,function(T,x,L,z){S(T,!T&&m.default.fromResponseBody(x,z?void 0:y))})},M.prototype.list=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=this.rest.http.supportsLinkHeaders?void 0:p,g=o.defaultGetHeaders(p);if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"list",arguments);S=E}w.options.headers&&o.mixin(g,w.options.headers),new u.default(w,"/push/channelSubscriptions",g,y,function(v,h,T){return m.default.fromResponseBody(v,T?void 0:p)}).get(C,S)},M.prototype.removeWhere=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=o.defaultGetHeaders(p);if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);S=E}w.options.headers&&o.mixin(y,w.options.headers),w.options.pushFullWait&&o.mixin(C,{fullWait:"true"}),c.default.delete(w,"/push/channelSubscriptions",y,C,null,function(g){return S(g)})},M.prototype.listChannels=function(C,S){var w=this.rest,p=w.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=this.rest.http.supportsLinkHeaders?void 0:p,g=o.defaultGetHeaders(p);if(typeof S!="function"){if(this.rest.options.promises)return o.promisify(this,"listChannels",arguments);S=E}w.options.headers&&o.mixin(g,w.options.headers),w.options.pushFullWait&&o.mixin(C,{fullWait:"true"}),new u.default(w,"/push/channels",g,y,function(v,h,T){for(var x=!T&&p?o.decodeBody(v,p):v,L=0;L<x.length;L++)x[L]=String(x[L]);return x}).get(C,S)},M}();t.default=O},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(5)),c;(function(m){m.Phone="phone",m.Tablet="tablet",m.Desktop="desktop",m.TV="tv",m.Watch="watch",m.Car="car",m.Embedded="embedded",m.Other="other"})(c||(c={}));var u;(function(m){m.Android="android",m.IOS="ios",m.Browser="browser"})(u||(u={}));var f=function(){function m(){}return m.prototype.toJSON=function(){var E,O,d;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(O=this.push)===null||O===void 0?void 0:O.state,error:(d=this.push)===null||d===void 0?void 0:d.error}}},m.prototype.toString=function(){var E,O,d,A,I="[DeviceDetails";return this.id&&(I+="; id="+this.id),this.platform&&(I+="; platform="+this.platform),this.formFactor&&(I+="; formFactor="+this.formFactor),this.clientId&&(I+="; clientId="+this.clientId),this.metadata&&(I+="; metadata="+this.metadata),this.deviceIdentityToken&&(I+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(I+="; push.recipient="+JSON.stringify(this.push.recipient)),!((O=this.push)===null||O===void 0)&&O.state&&(I+="; push.state="+this.push.state),!((d=this.push)===null||d===void 0)&&d.error&&(I+="; push.error="+JSON.stringify(this.push.error)),!((A=this.push)===null||A===void 0)&&A.metadata&&(I+="; push.metadata="+this.push.metadata),I+="]",I},m.fromResponseBody=function(E,O){return O&&(E=o.decodeBody(E,O)),o.isArray(E)?m.fromValuesArray(E):m.fromValues(E)},m.fromValues=function(E){return E.error=E.error&&l.default.fromValues(E.error),Object.assign(new m,E)},m.fromValuesArray=function(E){for(var O=E.length,d=new Array(O),A=0;A<O;A++)d[A]=m.fromValues(E[A]);return d},m.toRequestBody=o.encodeBody,m}();t.default=f},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=function(){function c(){}return c.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},c.prototype.toString=function(){var u="[PushChannelSubscription";return this.channel&&(u+="; channel="+this.channel),this.deviceId&&(u+="; deviceId="+this.deviceId),this.clientId&&(u+="; clientId="+this.clientId),u+="]",u},c.fromResponseBody=function(u,f){return f&&(u=o.decodeBody(u,f)),o.isArray(u)?c.fromValuesArray(u):c.fromValues(u)},c.fromValues=function(u){return Object.assign(new c,u)},c.fromValuesArray=function(u){for(var f=u.length,m=new Array(f),E=0;E<f;E++)m[E]=c.fromValues(u[E]);return m},c.toRequestBody=o.encodeBody,c}();t.default=l},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=function(){function w(p){this.count=p&&p.count||0,this.data=p&&p.data||0,this.uncompressedData=p&&p.uncompressedData||0,this.failed=p&&p.failed||0,this.refused=p&&p.refused||0}return w}(),c=function(w){i.__extends(p,w);function p(y){var g=w.call(this,y)||this;return y&&y.category&&(g.category={},o.forInOwnNonNullProperties(y.category,function(v){g.category[v]=new l(y.category[v])})),g}return p}(l),u=function(){function w(p){this.peak=p&&p.peak||0,this.min=p&&p.min||0,this.mean=p&&p.mean||0,this.opened=p&&p.opened||0,this.refused=p&&p.refused||0}return w}(),f=function(){function w(p){this.succeeded=p&&p.succeeded||0,this.failed=p&&p.failed||0,this.refused=p&&p.refused||0}return w}(),m=function(){function w(p){this.plain=new u(p&&p.plain),this.tls=new u(p&&p.tls),this.all=new u(p&&p.all)}return w}(),E=function(){function w(p){this.messages=new c(p&&p.messages),this.presence=new c(p&&p.presence),this.all=new c(p&&p.all)}return w}(),O=function(){function w(p){this.realtime=new E(p&&p.realtime),this.rest=new E(p&&p.rest),this.webhook=new E(p&&p.webhook),this.sharedQueue=new E(p&&p.sharedQueue),this.externalQueue=new E(p&&p.externalQueue),this.httpEvent=new E(p&&p.httpEvent),this.push=new E(p&&p.push),this.all=new E(p&&p.all)}return w}(),d=function(){function w(p){this.all=new E(p&&p.all),this.inbound=new O(p&&p.inbound),this.outbound=new O(p&&p.outbound)}return w}(),A=function(){function w(p){this.all=new E(p&&p.all),this.producerPaid=new d(p&&p.producerPaid),this.consumerPaid=new d(p&&p.consumerPaid)}return w}(),I=function(){function w(p){this.messages=p&&p.messages||0;var y=p&&p.notifications;this.notifications={invalid:y&&y.invalid||0,attempted:y&&y.attempted||0,successful:y&&y.successful||0,failed:y&&y.failed||0},this.directPublishes=p&&p.directPublishes||0}return w}(),M=function(){function w(p){this.succeeded=p&&p.succeeded||0,this.skipped=p&&p.skipped||0,this.failed=p&&p.failed||0}return w}(),C=function(){function w(p){var y=this;this.delta=void 0,p&&p.delta&&(this.delta={},o.forInOwnNonNullProperties(p.delta,function(g){y.delta[g]=new M(p.delta[g])}))}return w}(),S=function(w){i.__extends(p,w);function p(y){var g=w.call(this,y)||this;return g.persisted=new E(y&&y.persisted),g.connections=new m(y&&y.connections),g.channels=new u(y&&y.channels),g.apiRequests=new f(y&&y.apiRequests),g.tokenRequests=new f(y&&y.tokenRequests),g.xchgProducer=new A(y&&y.xchgProducer),g.xchgConsumer=new A(y&&y.xchgConsumer),g.push=new I(y&&y.pushStats),g.processed=new C(y&&y.processed),g.inProgress=y&&y.inProgress||void 0,g.unit=y&&y.unit||void 0,g.intervalId=y&&y.intervalId||void 0,g}return p.fromValues=function(y){return new p(y)},p}(d);t.default=S},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(30)),c=i.__importDefault(n(7)),u=i.__importDefault(n(3)),f=i.__importDefault(n(50)),m=i.__importDefault(n(37)),E=i.__importDefault(n(8)),O=i.__importDefault(n(5)),d=i.__importDefault(n(10)),A=i.__importDefault(n(25)),I=i.__importDefault(n(0)),M=i.__importDefault(n(9)),C=function(w){i.__extends(p,w);function p(y){var g=w.call(this,y)||this;return u.default.logAction(u.default.LOG_MINOR,"Realtime()",""),g.connection=new f.default(g,g.options),g.channels=new S(g),y.autoConnect!==!1&&g.connect(),g}return p.prototype.connect=function(){u.default.logAction(u.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},p.prototype.close=function(){u.default.logAction(u.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},p.Promise=function(y){return y=E.default.objectifyOptions(y),y.promises=!0,new p(y)},p.Callbacks=p,p.Utils=o,p.ConnectionManager=A.default,p.Platform=I.default,p.ProtocolMessage=d.default,p.Message=M.default,p}(l.default),S=function(w){i.__extends(p,w);function p(y){var g=w.call(this)||this;return g.realtime=y,g.all={},g.inProgress={},y.connection.connectionManager.on("transport.active",function(){g.onTransportActive()}),g}return p.prototype.onChannelMessage=function(y){var g=y.channel;if(g===void 0){u.default.logAction(u.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+y.action);return}var v=this.all[g];if(!v){u.default.logAction(u.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+g);return}v.onMessage(y)},p.prototype.onTransportActive=function(){for(var y in this.all){var g=this.all[y];g.state==="attaching"||g.state==="detaching"?g.checkPendingState():g.state==="suspended"&&g.attach()}},p.prototype.reattach=function(y){for(var g in this.all){var v=this.all[g];v.state==="attached"&&v.requestState("attaching",y)}},p.prototype.resetAttachedMsgIndicators=function(){for(var y in this.all){var g=this.all[y];g.state==="attached"&&(g._attachedMsgIndicator=!1)}},p.prototype.checkAttachedMsgIndicators=function(y){for(var g in this.all){var v=this.all[g];if(v.state==="attached"&&v._attachedMsgIndicator===!1){var h="30s after a resume, found channel which has not received an attached; channelId = "+g+"; connectionId = "+y;u.default.logAction(u.default.LOG_ERROR,"Channels.checkAttachedMsgIndicators()",h),v.requestState("attaching")}}},p.prototype.propogateConnectionInterruption=function(y,g){var v={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},h=["attaching","attached","detaching","suspended"],T=v[y];for(var x in this.all){var L=this.all[x];o.arrIn(h,L.state)&&L.notifyState(T,g)}},p.prototype.get=function(y,g){y=String(y);var v=this.all[y];if(!v)v=this.all[y]=new m.default(this.realtime,y,g);else if(g){if(v._shouldReattachToSetOptions(g))throw new O.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);v.setOptions(g)}return v},p.prototype.release=function(y){y=String(y);var g=this.all[y];if(!!g){var v=g.getReleaseErr();if(v)throw v;delete this.all[y],delete this.inProgress[y]}},p.prototype.setInProgress=function(y,g,v){this.inProgress[y.name]=this.inProgress[y.name]||{},this.inProgress[y.name][g]=v,!v&&this.hasNopending()&&this.emit("nopending")},p.prototype.onceNopending=function(y){if(this.hasNopending()){y();return}this.once("nopending",y)},p.prototype.hasNopending=function(){return o.arrEvery(o.valuesArray(this.inProgress,!0),function(y){return!o.containsValue(y,!0)})},p}(c.default);t.default=C},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(7)),c=i.__importDefault(n(25)),u=i.__importDefault(n(3)),f=i.__importDefault(n(36)),m=i.__importDefault(n(0));function E(){}var O=function(d){i.__extends(A,d);function A(I,M){var C=d.call(this)||this;return C.whenState=function(S,w){return l.default.prototype.whenState.call(C,S,C.state,w,new f.default(void 0,S))},C.ably=I,C.connectionManager=new c.default(I,M),C.state=C.connectionManager.state.state,C.key=void 0,C.id=void 0,C.serial=void 0,C.timeSerial=void 0,C.recoveryKey=void 0,C.errorReason=null,C.connectionManager.on("connectionstate",function(S){var w=C.state=S.current;m.default.Config.nextTick(function(){C.emit(w,S)})}),C.connectionManager.on("update",function(S){m.default.Config.nextTick(function(){C.emit("update",S)})}),C}return A.prototype.connect=function(){u.default.logAction(u.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},A.prototype.ping=function(I){if(u.default.logAction(u.default.LOG_MINOR,"Connection.ping()",""),!I){if(this.ably.options.promises)return o.promisify(this,"ping",arguments);I=E}this.connectionManager.ping(null,I)},A.prototype.close=function(){u.default.logAction(u.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},A}(l.default);t.default=O},function(s,t,n){"use strict";t.__esModule=!0,t.PendingMessage=void 0;var i=n(1),o=i.__importDefault(n(10)),l=i.__importStar(n(2)),c=i.__importDefault(n(7)),u=i.__importDefault(n(3)),f=i.__importDefault(n(35)),m=i.__importDefault(n(5)),E=o.default.Action,O=function(){function A(I,M){this.message=I,this.callback=M,this.merged=!1;var C=I.action;this.sendAttempted=!1,this.ackRequired=C==E.MESSAGE||C==E.PRESENCE}return A}();t.PendingMessage=O;var d=function(A){i.__extends(I,A);function I(M){var C=A.call(this)||this;return C.transport=M,C.messageQueue=new f.default,M.on("ack",function(S,w){C.onAck(S,w)}),M.on("nack",function(S,w,p){C.onNack(S,w,p)}),C}return I.prototype.onAck=function(M,C){u.default.logAction(u.default.LOG_MICRO,"Protocol.onAck()","serial = "+M+"; count = "+C),this.messageQueue.completeMessages(M,C)},I.prototype.onNack=function(M,C,S){u.default.logAction(u.default.LOG_ERROR,"Protocol.onNack()","serial = "+M+"; count = "+C+"; err = "+l.inspectError(S)),S||(S=new m.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(M,C,S)},I.prototype.onceIdle=function(M){var C=this.messageQueue;if(C.count()===0){M();return}C.once("idle",M)},I.prototype.send=function(M){M.ackRequired&&this.messageQueue.push(M),u.default.shouldLog(u.default.LOG_MICRO)&&u.default.logAction(u.default.LOG_MICRO,"Protocol.send()","sending msg; "+o.default.stringify(M.message)),M.sendAttempted=!0,this.transport.send(M.message)},I.prototype.getTransport=function(){return this.transport},I.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},I.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},I.prototype.finish=function(){var M=this.transport;this.onceIdle(function(){M.disconnect()})},I}(c.default);t.default=d},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(0)),l=i.__importStar(n(2)),c=i.__importDefault(n(26)),u=i.__importDefault(n(8)),f=i.__importDefault(n(3)),m=i.__importDefault(n(10)),E=i.__importDefault(n(5)),O="web_socket";function d(M){return!!M.on}var A=function(M){i.__extends(C,M);function C(S,w,p){var y=M.call(this,S,w,p)||this;return y.shortName=O,p.heartbeats=o.default.Config.useProtocolHeartbeats,y.wsHost=u.default.getHost(p.options,p.host,!0),y}return C.isAvailable=function(){return!!o.default.Config.WebSocket},C.prototype.createWebSocket=function(S,w){var p=0;if(w)for(var y in w)S+=(p++?"&":"?")+y+"="+w[y];return this.uri=S,new o.default.Config.WebSocket(S)},C.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},C.prototype.connect=function(){f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),c.default.prototype.connect.call(this);var S=this,w=this.params,p=w.options,y=p.tls?"wss://":"ws://",g=y+this.wsHost+":"+u.default.getPort(p)+"/";f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+g),this.auth.getAuthParams(function(v,h){if(!S.isDisposed){var T="";for(var x in h)T+=" "+x+": "+h[x]+";";if(f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+T+" err: "+v),v){S.disconnect(v);return}var L=w.getConnectParams(h);try{var z=S.wsConnection=S.createWebSocket(g,L);z.binaryType=o.default.Config.binaryType,z.onopen=function(){S.onWsOpen()},z.onclose=function(H){S.onWsClose(H)},z.onmessage=function(H){S.onWsData(H.data)},z.onerror=function(H){S.onWsError(H)},d(z)&&z.on("ping",function(){S.onActivity()})}catch(H){f.default.logAction(f.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(H.stack||H.message)),S.disconnect(H)}}})},C.prototype.send=function(S){var w=this.wsConnection;if(!w){f.default.logAction(f.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{w.send(m.default.serialize(S,this.params.format))}catch(y){var p="Exception from ws connection when trying to send: "+l.inspectError(y);f.default.logAction(f.default.LOG_ERROR,"WebSocketTransport.send()",p),this.finish("disconnected",new E.default(p,5e4,500))}},C.prototype.onWsData=function(S){f.default.logAction(f.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+S.length+"; type = "+typeof S);try{this.onProtocolMessage(m.default.deserialize(S,this.format))}catch(w){f.default.logAction(f.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+w.stack)}},C.prototype.onWsOpen=function(){f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},C.prototype.onWsClose=function(S){var w,p;if(typeof S=="object"?(p=S.code,w=S.wasClean||p===1e3):(p=S,w=p==1e3),delete this.wsConnection,w){f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var y=new E.default("Websocket closed",80003,400);this.finish("disconnected",y)}else{var g="Unclean disconnection of WebSocket ; code = "+p,y=new E.default(g,80003,400);f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.onWsClose()",g),this.finish("disconnected",y)}this.emit("disposed")},C.prototype.onWsError=function(S){var w=this;f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+S.message),o.default.Config.nextTick(function(){w.disconnect(Error(S.message))})},C.prototype.dispose=function(){f.default.logAction(f.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var S=this.wsConnection;S&&(S.onmessage=function(){},delete this.wsConnection,o.default.Config.nextTick(function(){if(f.default.logAction(f.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!S)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");S.close()}))},C}(c.default);function I(M){return A.isAvailable()&&(M.supportedTransports[O]=A),A}t.default=I},function(s,t,n){"use strict";t.__esModule=!0,t.isSuccessCode=void 0;var i;(function(l){l[l.Success=200]="Success",l[l.NoContent=204]="NoContent",l[l.BadRequest=400]="BadRequest",l[l.Unauthorized=401]="Unauthorized",l[l.Forbidden=403]="Forbidden",l[l.RequestTimeout=408]="RequestTimeout",l[l.InternalServerError=500]="InternalServerError"})(i||(i={}));function o(l){return l>=i.Success&&l<i.BadRequest}t.isSuccessCode=o,t.default=i},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importStar(n(2)),l=i.__importDefault(n(34)),c=i.__importDefault(n(7)),u=i.__importDefault(n(3)),f=i.__importDefault(n(14)),m=i.__importDefault(n(5)),E=i.__importDefault(n(37)),O=i.__importDefault(n(22)),d=i.__importDefault(n(38)),A=function(){};function I(g){return g.clientId+":"+g.connectionId}function M(g){return g.channel.realtime.auth.clientId}function C(g){var v=g.channel.realtime,h=v.auth.clientId;return(!h||h==="*")&&v.connection.state==="connected"}function S(g,v,h){switch(g.state){case"attached":case"suspended":h();break;case"initialized":case"detached":case"detaching":case"attaching":g.attach(function(T){T?v(T):h()});break;default:v(m.default.fromValues(E.default.invalidStateError(g.state)))}}function w(g,v){if(g.isSynthesized()||v.isSynthesized())return g.timestamp>v.timestamp;var h=g.parseId(),T=v.parseId();return h.msgSerial===T.msgSerial?h.index>T.index:h.msgSerial>T.msgSerial}var p=function(g){i.__extends(v,g);function v(h){var T=g.call(this,h)||this;return T.channel=h,T.syncComplete=!1,T.members=new y(T),T._myMembers=new y(T),T.subscriptions=new c.default,T.pendingPresence=[],T}return v.prototype.enter=function(h,T){if(C(this))throw new m.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,h,"enter",T)},v.prototype.update=function(h,T){if(C(this))throw new m.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,h,"update",T)},v.prototype.enterClient=function(h,T,x){return this._enterOrUpdateClient(h,T,"enter",x)},v.prototype.updateClient=function(h,T,x){return this._enterOrUpdateClient(h,T,"update",x)},v.prototype._enterOrUpdateClient=function(h,T,x,L){var z=this;if(!L)if(typeof T=="function")L=T,T=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"_enterOrUpdateClient",[h,T,x]);L=A}var H=this.channel;if(!H.connectionManager.activeState()){L(H.connectionManager.getError());return}u.default.logAction(u.default.LOG_MICRO,"RealtimePresence."+x+"Client()","channel = "+H.name+", client = "+(h||"(implicit) "+M(this)));var F=f.default.fromValues({action:x,data:T});h&&(F.clientId=h),f.default.encode(F,H.channelOptions,function(R){if(R){L(R);return}switch(H.state){case"attached":H.sendPresence(F,L);break;case"initialized":case"detached":H.attach();case"attaching":z.pendingPresence.push({presence:F,callback:L});break;default:R=new m.default("Unable to "+x+" presence channel while in "+H.state+" state",90001),R.code=90001,L(R)}})},v.prototype.leave=function(h,T){if(C(this))throw new m.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,h,T)},v.prototype.leaveClient=function(h,T,x){if(!x)if(typeof T=="function")x=T,T=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"leaveClient",[h,T]);x=A}var L=this.channel;if(!L.connectionManager.activeState()){x==null||x(L.connectionManager.getError());return}u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+h);var z=f.default.fromValues({action:"leave",data:T});switch(h&&(z.clientId=h),L.state){case"attached":L.sendPresence(z,x);break;case"attaching":this.pendingPresence.push({presence:z,callback:x});break;case"initialized":case"failed":{var H=new m.default("Unable to leave presence channel (incompatible state)",90001);x==null||x(H);break}default:x==null||x(E.default.invalidStateError(L.state))}},v.prototype.get=function(h,T){var x=this,L=Array.prototype.slice.call(arguments);L.length==1&&typeof L[0]=="function"&&L.unshift(null),h=L[0],T=L[1];var z=!h||("waitForSync"in h?h.waitForSync:!0);if(!T){if(this.channel.realtime.options.promises)return o.promisify(this,"get",L);T=A}function H(F){T(null,h?F.list(h):F.values())}if(this.channel.state==="suspended"){z?T(m.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):H(this.members);return}S(this.channel,T,function(){var F=x.members;z?F.waitSync(function(){H(F)}):H(F)})},v.prototype.history=function(h,T){if(u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),T===void 0)if(typeof h=="function")T=h,h=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"history",arguments);T=A}h&&h.untilAttach&&(this.channel.state==="attached"?(delete h.untilAttach,h.from_serial=this.channel.properties.attachSerial):T(new m.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),l.default.prototype._history.call(this,h,T)},v.prototype.setPresence=function(h,T,x){u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+h.length+" participants; syncChannelSerial = "+x);var L,z,H=this.members,F=this._myMembers,R=[],P=this.channel.connectionManager.connectionId;T&&(this.members.startSync(),x&&(z=x.match(/^[\w-]+:(.*)$/))&&(L=z[1]));for(var $=0;$<h.length;$++){var W=f.default.fromValues(h[$]);switch(W.action){case"leave":H.remove(W)&&R.push(W),W.connectionId===P&&!W.isSynthesized()&&F.remove(W);break;case"enter":case"present":case"update":H.put(W)&&R.push(W),W.connectionId===P&&F.put(W);break}}T&&!L&&(H.endSync(),this._ensureMyMembersPresent(),this.channel.setInProgress(E.default.progressOps.sync,!1),this.channel.syncChannelSerial=null);for(var $=0;$<R.length;$++){var W=R[$];this.subscriptions.emit(W.action,W)}},v.prototype.onAttached=function(h){u.default.logAction(u.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+h),h?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear(),this._ensureMyMembersPresent());var T=this.pendingPresence,x=T.length;if(x){this.pendingPresence=[];var L=[],z=O.default.create();u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+x+" queued presence messages");for(var H=0;H<x;H++){var F=T[H];L.push(F.presence),z.push(F.callback)}this.channel.sendPresence(L,z)}},v.prototype.actOnChannelState=function(h,T,x){switch(h){case"attached":this.onAttached(T);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(x);break}},v.prototype.failPendingPresence=function(h){if(this.pendingPresence.length){u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+o.inspectError(h));for(var T=0;T<this.pendingPresence.length;T++)try{this.pendingPresence[T].callback(h)}catch(x){}this.pendingPresence=[]}},v.prototype._clearMyMembers=function(){this._myMembers.clear()},v.prototype._ensureMyMembersPresent=function(){var h=this,T=this.members,x=this._myMembers,L=function(F){if(F){var R="Presence auto-re-enter failed: "+F.toString(),P=new m.default(R,91004,400);u.default.logAction(u.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",R);var $=new d.default(h.channel.state,h.channel.state,!0,P);h.channel.emit("update",$)}};for(var z in x.map)if(!(z in T.map)){var H=x.map[z];u.default.logAction(u.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+H.clientId+'" into the presence set'),this._enterOrUpdateClient(H.clientId,H.data,"enter",L),delete x.map[z]}},v.prototype._synthesizeLeaves=function(h){var T=this.subscriptions;o.arrForEach(h,function(x){var L=f.default.fromValues({action:"leave",connectionId:x.connectionId,clientId:x.clientId,data:x.data,encoding:x.encoding,timestamp:o.now()});T.emit("leave",L)})},v.prototype.on=function(){for(var h=[],T=0;T<arguments.length;T++)h[T]=arguments[T];u.default.deprecated("presence.on","presence.subscribe"),this.subscribe.apply(this,h)},v.prototype.off=function(){for(var h=[],T=0;T<arguments.length;T++)h[T]=arguments[T];u.default.deprecated("presence.off","presence.unsubscribe"),this.unsubscribe.apply(this,h)},v.prototype.subscribe=function(){for(var h=[],T=0;T<arguments.length;T++)h[T]=arguments[T];var x=E.default.processListenerArgs(h),L=x[0],z=x[1],H=x[2],F=this.channel;if(!H){if(this.channel.realtime.options.promises)return o.promisify(this,"subscribe",[L,z]);H=A}if(F.state==="failed"){H(m.default.fromValues(E.default.invalidStateError("failed")));return}this.subscriptions.on(L,z),F.attach(H)},v.prototype.unsubscribe=function(){for(var h=[],T=0;T<arguments.length;T++)h[T]=arguments[T];var x=E.default.processListenerArgs(h),L=x[0],z=x[1];this.subscriptions.off(L,z)},v}(l.default),y=function(g){i.__extends(v,g);function v(h){var T=g.call(this)||this;return T.presence=h,T.map={},T.syncInProgress=!1,T.residualMembers=null,T}return v.prototype.get=function(h){return this.map[h]},v.prototype.getClient=function(h){var T=this.map,x=[];for(var L in T){var z=T[L];z.clientId==h&&z.action!="absent"&&x.push(z)}return x},v.prototype.list=function(h){var T=this.map,x=h&&h.clientId,L=h&&h.connectionId,z=[];for(var H in T){var F=T[H];F.action!=="absent"&&(x&&x!=F.clientId||L&&L!=F.connectionId||z.push(F))}return z},v.prototype.put=function(h){(h.action==="enter"||h.action==="update")&&(h=f.default.fromValues(h),h.action="present");var T=this.map,x=I(h);this.residualMembers&&delete this.residualMembers[x];var L=T[x];return L&&!w(h,L)?!1:(T[x]=h,!0)},v.prototype.values=function(){var h=this.map,T=[];for(var x in h){var L=h[x];L.action!="absent"&&T.push(L)}return T},v.prototype.remove=function(h){var T=this.map,x=I(h),L=T[x];return L&&!w(h,L)?!1:(this.syncInProgress?(h=f.default.fromValues(h),h.action="absent",T[x]=h):delete T[x],!0)},v.prototype.startSync=function(){var h=this.map,T=this.syncInProgress;u.default.logAction(u.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+T),this.syncInProgress||(this.residualMembers=o.copy(h),this.setInProgress(!0))},v.prototype.endSync=function(){var h=this.map,T=this.syncInProgress;if(u.default.logAction(u.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+T),T){for(var x in h){var L=h[x];L.action==="absent"&&delete h[x]}this.presence._synthesizeLeaves(o.valuesArray(this.residualMembers));for(var z in this.residualMembers)delete h[z];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},v.prototype.waitSync=function(h){var T=this.syncInProgress;if(u.default.logAction(u.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+T),!T){h();return}this.once("sync",h)},v.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},v.prototype.setInProgress=function(h){u.default.logAction(u.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+h),this.syncInProgress=h,this.presence.syncComplete=!h},v}(c.default);t.default=p},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=n(56),l=n(32),c=n(13),u=i.__importDefault(n(4)),f=i.__importDefault(n(0)),m=function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(O){return O!=null&&O.sigBytes!==void 0},E.prototype.isArrayBuffer=function(O){return O!=null&&O.constructor===ArrayBuffer},E.prototype.isTypedArray=function(O){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(O)},E.prototype.uint8ViewToBase64=function(O){for(var d="",A=this.base64CharSet,I=O.byteLength,M=I%3,C=I-M,S,w,p,y,g,v=0;v<C;v=v+3)g=O[v]<<16|O[v+1]<<8|O[v+2],S=(g&16515072)>>18,w=(g&258048)>>12,p=(g&4032)>>6,y=g&63,d+=A[S]+A[w]+A[p]+A[y];return M==1?(g=O[C],S=(g&252)>>2,w=(g&3)<<4,d+=A[S]+A[w]+"=="):M==2&&(g=O[C]<<8|O[C+1],S=(g&64512)>>10,w=(g&1008)>>4,p=(g&15)<<2,d+=A[S]+A[w]+A[p]+"="),d},E.prototype.base64ToArrayBuffer=function(O){for(var d=atob==null?void 0:atob(O),A=d.length,I=new Uint8Array(A),M=0;M<A;M++){var C=d.charCodeAt(M);I[M]=C}return I.buffer},E.prototype.isBuffer=function(O){return this.isArrayBuffer(O)||this.isWordArray(O)||this.isTypedArray(O)},E.prototype.toBuffer=function(O){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(O))return new Uint8Array(O);if(this.isTypedArray(O))return new Uint8Array(O.buffer);if(this.isWordArray(O)){for(var d=new ArrayBuffer(O.sigBytes),A=new Uint8Array(d),I=0;I<O.sigBytes;I++)A[I]=O.words[I>>>2]>>>24-I%4*8&255;return A}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(O){return this.isArrayBuffer(O)?O:this.toBuffer(O).buffer},E.prototype.toWordArray=function(O){return this.isTypedArray(O)&&(O=O.buffer),this.isWordArray(O)?O:u.default.create(O)},E.prototype.base64Encode=function(O){return this.isWordArray(O)?c.stringify(O):this.uint8ViewToBase64(this.toBuffer(O))},E.prototype.base64Decode=function(O){return ArrayBuffer&&f.default.Config.atob?this.base64ToArrayBuffer(O):c.parse(O)},E.prototype.hexEncode=function(O){return o.stringify(this.toWordArray(O))},E.prototype.hexDecode=function(O){var d=o.parse(O);return ArrayBuffer?this.toArrayBuffer(d):d},E.prototype.utf8Encode=function(O){return TextEncoder?new TextEncoder().encode(O).buffer:l.parse(O)},E.prototype.utf8Decode=function(O){if(!this.isBuffer(O))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(O)?new TextDecoder().decode(O):(O=this.toWordArray(O),l.stringify(O))},E.prototype.bufferCompare=function(O,d){if(!O)return-1;if(!d)return 1;var A=this.toWordArray(O),I=this.toWordArray(d);A.clamp(),I.clamp();var M=A.sigBytes-I.sigBytes;if(M!=0)return M;for(var C=A.words,S=I.words,w=0;w<C.length;w++)if(M=C[w]-S[w],M!=0)return M;return 0},E.prototype.byteLength=function(O){return this.isArrayBuffer(O)||this.isTypedArray(O)?O.byteLength:this.isWordArray(O)?O.sigBytes:-1},E.prototype.typedArrayToBuffer=function(O){return O.buffer},E}();t.default=new m},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return i.enc.Hex})},function(s,t,n){"use strict";n.r(t);var i=n(4),o=n.n(i),l=n(13),c=n.n(l),u=n(21),f=n.n(u),m=n(0),E=n.n(m),O=n(3),d=n.n(O),A=function(){var I="aes",M=256,C="cbc",S=16,w=4,p=4294967296,y=2147483648,g;if(E.a.getRandomWordArray)g=E.a.getRandomWordArray;else if(typeof Uint32Array!="undefined"&&E.a.getRandomValues){var v=new Uint32Array(w);g=function(R,P){var $=R/4,W=$==w?v:new Uint32Array($);E.a.getRandomValues(W,function(Z){P(Z,E.a.BufferUtils.toWordArray(W))})}}else g=function(R,P){d.a.logAction(d.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var $=R/4,W=new Array($),Z=0;Z<$;Z++)W[Z]=Math.floor(Math.random()*p)-y;P(null,o.a.create(W))};function h(R){return R+S&-S}function T(R){if(R.algorithm==="aes"&&R.mode==="cbc"){if(R.keyLength===128||R.keyLength===256)return;throw new Error("Unsupported key length "+R.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function x(R){return R.replace("_","/").replace("-","+")}var L=[o.a.create([269488144,269488144,269488144,269488144],16),o.a.create([16777216],1),o.a.create([33685504],2),o.a.create([50529024],3),o.a.create([67372036],4),o.a.create([84215045,83886080],5),o.a.create([101058054,101056512],6),o.a.create([117901063,117901056],7),o.a.create([134744072,134744072],8),o.a.create([151587081,151587081,150994944],9),o.a.create([168430090,168430090,168427520],10),o.a.create([185273099,185273099,185273088],11),o.a.create([202116108,202116108,202116108],12),o.a.create([218959117,218959117,218959117,218103808],13),o.a.create([235802126,235802126,235802126,235798528],14),o.a.create([252645135,252645135,252645135,252645135],15),o.a.create([269488144,269488144,269488144,269488144],16)];function z(){}function H(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}z.CipherParams=H,z.getDefaultParams=function(R){var P;if(typeof R=="function"||typeof R=="string"){if(d.a.deprecated("Crypto.getDefaultParams(key, callback)","Crypto.getDefaultParams({key: key})"),typeof R=="function")z.generateRandomKey(function(W){R(null,z.getDefaultParams({key:W}))});else if(typeof arguments[1]=="function")arguments[1](null,z.getDefaultParams({key:R}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!R.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof R.key=="string"?P=Object(l.parse)(x(R.key)):P=E.a.BufferUtils.toWordArray(R.key);var $=new H;if($.key=P,$.algorithm=R.algorithm||I,$.keyLength=P.words.length*(4*8),$.mode=R.mode||C,R.keyLength&&R.keyLength!==$.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+R.keyLength+" was specified, but the key actually has length "+$.keyLength);return T($),$},z.generateRandomKey=function(R,P){arguments.length==1&&typeof R=="function"&&(P=R,R=void 0),g((R||M)/8,P)},z.getCipher=function(R){var P=R instanceof H?R:z.getDefaultParams(R);return{cipherParams:P,cipher:new F(P,w,R.iv)}};function F(R,P,$){this.algorithm=R.algorithm+"-"+String(R.keyLength)+"-"+R.mode,this.cjsAlgorithm=R.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=E.a.BufferUtils.toWordArray(R.key),$&&(this.iv=E.a.BufferUtils.toWordArray($).clone()),this.blockLengthWords=P}return F.prototype.encrypt=function(R,P){d.a.logAction(d.a.LOG_MICRO,"CBCCipher.encrypt()",""),R=E.a.BufferUtils.toWordArray(R);var $=R.sigBytes,W=h($),Z=this,et=function(){Z.getIv(function(Y,G){if(Y){P(Y);return}var N=Z.encryptCipher.process(R.concat(L[W-$])),U=G.concat(N);P(null,U)})};this.encryptCipher?et():this.iv?(this.encryptCipher=f.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),et()):g(S,function(Y,G){if(Y){P(Y);return}Z.encryptCipher=f.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:G}),Z.iv=G,et()})},F.prototype.decrypt=function(R){d.a.logAction(d.a.LOG_MICRO,"CBCCipher.decrypt()",""),R=E.a.BufferUtils.toWordArray(R);var P=this.blockLengthWords,$=R.words,W=o.a.create($.slice(0,P)),Z=o.a.create($.slice(P)),et=f.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:W}),Y=et.process(Z),G=et.finalize();return et.reset(),G&&G.sigBytes&&Y.concat(G),Y},F.prototype.getIv=function(R){if(this.iv){var P=this.iv;this.iv=null,R(null,P);return}var $=this;g(S,function(W,Z){if(W){R(W);return}R(null,$.encryptCipher.process(Z))})},z}();t.default=A},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(){var o=i,l=o.lib,c=l.WordArray,u=o.enc,f=u.Utf16=u.Utf16BE={stringify:function(E){for(var O=E.words,d=E.sigBytes,A=[],I=0;I<d;I+=2){var M=O[I>>>2]>>>16-I%4*8&65535;A.push(String.fromCharCode(M))}return A.join("")},parse:function(E){for(var O=E.length,d=[],A=0;A<O;A++)d[A>>>1]|=E.charCodeAt(A)<<16-A%2*16;return c.create(d,O*2)}};u.Utf16LE={stringify:function(E){for(var O=E.words,d=E.sigBytes,A=[],I=0;I<d;I+=2){var M=m(O[I>>>2]>>>16-I%4*8&65535);A.push(String.fromCharCode(M))}return A.join("")},parse:function(E){for(var O=E.length,d=[],A=0;A<O;A++)d[A>>>1]|=m(E.charCodeAt(A)<<16-A%2*16);return c.create(d,O*2)}};function m(E){return E<<8&4278255360|E>>>8&16711935}}(),i.enc.Utf16})},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(28))})(this,function(i){return function(o){var l=i,c=l.lib,u=c.CipherParams,f=l.enc,m=f.Hex,E=l.format,O=E.Hex={stringify:function(d){return d.ciphertext.toString(m)},parse:function(d){var A=m.parse(d);return u.create({ciphertext:A})}}}(),i.format.Hex})},function(s,t,n){(function(i,o){s.exports=t=o(n(6),n(13),n(61),n(27),n(28))})(this,function(i){return function(){var o=i,l=o.lib,c=l.BlockCipher,u=o.algo,f=[],m=[],E=[],O=[],d=[],A=[],I=[],M=[],C=[],S=[];(function(){for(var y=[],g=0;g<256;g++)g<128?y[g]=g<<1:y[g]=g<<1^283;for(var v=0,h=0,g=0;g<256;g++){var T=h^h<<1^h<<2^h<<3^h<<4;T=T>>>8^T&255^99,f[v]=T,m[T]=v;var x=y[v],L=y[x],z=y[L],H=y[T]*257^T*16843008;E[v]=H<<24|H>>>8,O[v]=H<<16|H>>>16,d[v]=H<<8|H>>>24,A[v]=H;var H=z*16843009^L*65537^x*257^v*16843008;I[T]=H<<24|H>>>8,M[T]=H<<16|H>>>16,C[T]=H<<8|H>>>24,S[T]=H,v?(v=x^y[y[y[z^x]]],h^=y[y[h]]):v=h=1}})();var w=[0,1,2,4,8,16,32,64,128,27,54],p=u.AES=c.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var g=this._keyPriorReset=this._key,v=g.words,h=g.sigBytes/4,T=this._nRounds=h+6,x=(T+1)*4,L=this._keySchedule=[],z=0;z<x;z++)z<h?L[z]=v[z]:(y=L[z-1],z%h?h>6&&z%h==4&&(y=f[y>>>24]<<24|f[y>>>16&255]<<16|f[y>>>8&255]<<8|f[y&255]):(y=y<<8|y>>>24,y=f[y>>>24]<<24|f[y>>>16&255]<<16|f[y>>>8&255]<<8|f[y&255],y^=w[z/h|0]<<24),L[z]=L[z-h]^y);for(var H=this._invKeySchedule=[],F=0;F<x;F++){var z=x-F;if(F%4)var y=L[z];else var y=L[z-4];F<4||z<=4?H[F]=y:H[F]=I[f[y>>>24]]^M[f[y>>>16&255]]^C[f[y>>>8&255]]^S[f[y&255]]}}},encryptBlock:function(y,g){this._doCryptBlock(y,g,this._keySchedule,E,O,d,A,f)},decryptBlock:function(y,g){var v=y[g+1];y[g+1]=y[g+3],y[g+3]=v,this._doCryptBlock(y,g,this._invKeySchedule,I,M,C,S,m);var v=y[g+1];y[g+1]=y[g+3],y[g+3]=v},_doCryptBlock:function(y,g,v,h,T,x,L,z){for(var H=this._nRounds,F=y[g]^v[0],R=y[g+1]^v[1],P=y[g+2]^v[2],$=y[g+3]^v[3],W=4,Z=1;Z<H;Z++){var et=h[F>>>24]^T[R>>>16&255]^x[P>>>8&255]^L[$&255]^v[W++],Y=h[R>>>24]^T[P>>>16&255]^x[$>>>8&255]^L[F&255]^v[W++],G=h[P>>>24]^T[$>>>16&255]^x[F>>>8&255]^L[R&255]^v[W++],N=h[$>>>24]^T[F>>>16&255]^x[R>>>8&255]^L[P&255]^v[W++];F=et,R=Y,P=G,$=N}var et=(z[F>>>24]<<24|z[R>>>16&255]<<16|z[P>>>8&255]<<8|z[$&255])^v[W++],Y=(z[R>>>24]<<24|z[P>>>16&255]<<16|z[$>>>8&255]<<8|z[F&255])^v[W++],G=(z[P>>>24]<<24|z[$>>>16&255]<<16|z[F>>>8&255]<<8|z[R&255])^v[W++],N=(z[$>>>24]<<24|z[F>>>16&255]<<16|z[R>>>8&255]<<8|z[P&255])^v[W++];y[g]=et,y[g+1]=Y,y[g+2]=G,y[g+3]=N},keySize:256/32});o.AES=c._createHelper(p)}(),i.AES})},function(s,t,n){(function(i,o){s.exports=t=o(n(6))})(this,function(i){return function(o){var l=i,c=l.lib,u=c.WordArray,f=c.Hasher,m=l.algo,E=[];(function(){for(var C=0;C<64;C++)E[C]=o.abs(o.sin(C+1))*4294967296|0})();var O=m.MD5=f.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(C,S){for(var w=0;w<16;w++){var p=S+w,y=C[p];C[p]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var g=this._hash.words,v=C[S+0],h=C[S+1],T=C[S+2],x=C[S+3],L=C[S+4],z=C[S+5],H=C[S+6],F=C[S+7],R=C[S+8],P=C[S+9],$=C[S+10],W=C[S+11],Z=C[S+12],et=C[S+13],Y=C[S+14],G=C[S+15],N=g[0],U=g[1],K=g[2],j=g[3];N=d(N,U,K,j,v,7,E[0]),j=d(j,N,U,K,h,12,E[1]),K=d(K,j,N,U,T,17,E[2]),U=d(U,K,j,N,x,22,E[3]),N=d(N,U,K,j,L,7,E[4]),j=d(j,N,U,K,z,12,E[5]),K=d(K,j,N,U,H,17,E[6]),U=d(U,K,j,N,F,22,E[7]),N=d(N,U,K,j,R,7,E[8]),j=d(j,N,U,K,P,12,E[9]),K=d(K,j,N,U,$,17,E[10]),U=d(U,K,j,N,W,22,E[11]),N=d(N,U,K,j,Z,7,E[12]),j=d(j,N,U,K,et,12,E[13]),K=d(K,j,N,U,Y,17,E[14]),U=d(U,K,j,N,G,22,E[15]),N=A(N,U,K,j,h,5,E[16]),j=A(j,N,U,K,H,9,E[17]),K=A(K,j,N,U,W,14,E[18]),U=A(U,K,j,N,v,20,E[19]),N=A(N,U,K,j,z,5,E[20]),j=A(j,N,U,K,$,9,E[21]),K=A(K,j,N,U,G,14,E[22]),U=A(U,K,j,N,L,20,E[23]),N=A(N,U,K,j,P,5,E[24]),j=A(j,N,U,K,Y,9,E[25]),K=A(K,j,N,U,x,14,E[26]),U=A(U,K,j,N,R,20,E[27]),N=A(N,U,K,j,et,5,E[28]),j=A(j,N,U,K,T,9,E[29]),K=A(K,j,N,U,F,14,E[30]),U=A(U,K,j,N,Z,20,E[31]),N=I(N,U,K,j,z,4,E[32]),j=I(j,N,U,K,R,11,E[33]),K=I(K,j,N,U,W,16,E[34]),U=I(U,K,j,N,Y,23,E[35]),N=I(N,U,K,j,h,4,E[36]),j=I(j,N,U,K,L,11,E[37]),K=I(K,j,N,U,F,16,E[38]),U=I(U,K,j,N,$,23,E[39]),N=I(N,U,K,j,et,4,E[40]),j=I(j,N,U,K,v,11,E[41]),K=I(K,j,N,U,x,16,E[42]),U=I(U,K,j,N,H,23,E[43]),N=I(N,U,K,j,P,4,E[44]),j=I(j,N,U,K,Z,11,E[45]),K=I(K,j,N,U,G,16,E[46]),U=I(U,K,j,N,T,23,E[47]),N=M(N,U,K,j,v,6,E[48]),j=M(j,N,U,K,F,10,E[49]),K=M(K,j,N,U,Y,15,E[50]),U=M(U,K,j,N,z,21,E[51]),N=M(N,U,K,j,Z,6,E[52]),j=M(j,N,U,K,x,10,E[53]),K=M(K,j,N,U,$,15,E[54]),U=M(U,K,j,N,h,21,E[55]),N=M(N,U,K,j,R,6,E[56]),j=M(j,N,U,K,G,10,E[57]),K=M(K,j,N,U,H,15,E[58]),U=M(U,K,j,N,et,21,E[59]),N=M(N,U,K,j,L,6,E[60]),j=M(j,N,U,K,W,10,E[61]),K=M(K,j,N,U,T,15,E[62]),U=M(U,K,j,N,P,21,E[63]),g[0]=g[0]+N|0,g[1]=g[1]+U|0,g[2]=g[2]+K|0,g[3]=g[3]+j|0},_doFinalize:function(){var C=this._data,S=C.words,w=this._nDataBytes*8,p=C.sigBytes*8;S[p>>>5]|=128<<24-p%32;var y=o.floor(w/4294967296),g=w;S[(p+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,S[(p+64>>>9<<4)+14]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,C.sigBytes=(S.length+1)*4,this._process();for(var v=this._hash,h=v.words,T=0;T<4;T++){var x=h[T];h[T]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}return v},clone:function(){var C=f.clone.call(this);return C._hash=this._hash.clone(),C}});function d(C,S,w,p,y,g,v){var h=C+(S&w|~S&p)+y+v;return(h<<g|h>>>32-g)+S}function A(C,S,w,p,y,g,v){var h=C+(S&p|w&~p)+y+v;return(h<<g|h>>>32-g)+S}function I(C,S,w,p,y,g,v){var h=C+(S^w^p)+y+v;return(h<<g|h>>>32-g)+S}function M(C,S,w,p,y,g,v){var h=C+(w^(S|~p))+y+v;return(h<<g|h>>>32-g)+S}l.MD5=f._createHelper(O),l.HmacMD5=f._createHmacHelper(O)}(Math),i.MD5})},function(s,t,n){"use strict";var i;t.__esModule=!0;var o=n(1),l=o.__importDefault(n(0)),c=o.__importStar(n(2)),u=o.__importDefault(n(8)),f=o.__importDefault(n(5)),m=o.__importDefault(n(17)),E=o.__importDefault(n(15)),O=o.__importDefault(n(20)),d=o.__importDefault(n(3)),A=n(29);function I(S){var w=S.statusCode;return w===408&&!S.code||w===400&&!S.code||w>=500&&w<=504}function M(S){var w=S.connection,p=w&&w.connectionManager.host;return p?[p].concat(u.default.getFallbackHosts(S.options)):u.default.getHosts(S.options)}var C=(i=function(){function S(){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,l.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(w,p,y,g,v,h,T){var x=E.default.createRequest(y,g,v,h,O.default.REQ_SEND,p&&p.options.timeouts,w);return x.once("complete",T),x.exec(),x},this.checkConnectivity=function(w){var p=u.default.internetUpUrl;d.default.logAction(d.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+p),this.doUri(m.default.Get,null,p,null,null,null,function(y,g){var v,h=!y&&((v=g)===null||v===void 0?void 0:v.replace(/\n/,""))=="yes";d.default.logAction(d.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+h),w(null,h)})}):l.default.Config.jsonpSupported&&(this.Request=function(w,p,y,g,v,h,T){var x=A.createRequest(y,g,v,h,O.default.REQ_SEND,p&&p.options.timeouts,w);return x.once("complete",T),l.default.Config.nextTick(function(){x.exec()}),x},this.checkConnectivity=function(w){var p=this,y=u.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(w);return}this.checksInProgress=[w],d.default.logAction(d.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+y);var g=new A.Request("isTheInternetUp",y,null,null,null,O.default.REQ_SEND,u.default.TIMEOUTS);g.once("complete",function(v,h){var T=!v&&h;d.default.logAction(d.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+T);for(var x=0;x<p.checksInProgress.length;x++)p.checksInProgress[x](null,T);p.checksInProgress=null}),l.default.Config.nextTick(function(){g.exec()})})}return S.prototype.do=function(w,p,y,g,v,h,T){var x=this,L=typeof y=="function"?y:function(R){return p.baseUri(R)+y},z=p._currentFallback;if(z)if(z.validUntil>c.now()){if(!this.Request){T==null||T(new f.default("Request invoked before assigned to",null,500));return}this.Request(w,p,L(z.host),g,h,v,function(R){for(var P=[],$=1;$<arguments.length;$++)P[$-1]=arguments[$];if(R&&I(R)){p._currentFallback=null,x.do(w,p,y,g,v,h,T);return}T==null||T.apply(void 0,o.__spreadArray([R],P))});return}else p._currentFallback=null;var H=M(p);if(H.length===1){this.doUri(w,p,L(H[0]),g,v,h,T);return}var F=function(R,P){var $=R.shift();x.doUri(w,p,L($),g,v,h,function(W){for(var Z=[],et=1;et<arguments.length;et++)Z[et-1]=arguments[et];if(W&&I(W)&&R.length){F(R,!0);return}P&&(p._currentFallback={host:$,validUntil:c.now()+p.options.timeouts.fallbackRetryTimeout}),T==null||T.apply(void 0,o.__spreadArray([W],Z))})};F(H)},S.prototype.doUri=function(w,p,y,g,v,h,T){if(!this.Request){T(new f.default("Request invoked before assigned to",null,500));return}this.Request(w,p,y,g,h,v,T)},S}(),i.methods=[m.default.Get,m.default.Delete,m.default.Post,m.default.Put,m.default.Patch],i.methodsWithoutBody=[m.default.Get,m.default.Delete],i.methodsWithBody=[m.default.Post,m.default.Put,m.default.Patch],i);t.default=C},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(40)),l=i.__importStar(n(2)),c=l.getGlobalObject();function u(){var O=c.location;return!c.WebSocket||!O||!O.origin||O.origin.indexOf("http")>-1}var f=c.navigator&&c.navigator.userAgent.toString(),m=c.location&&c.location.href,E={agent:"browser",logTimestamps:!0,userAgent:f,currentUrl:m,noUpgrade:f&&!!f.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:c.WebSocket,xhrSupported:c.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document!="undefined",allowComet:u(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:o.default,supportsBinary:!!c.TextDecoder,preferBinary:!1,ArrayBuffer:c.ArrayBuffer,atob:c.atob,nextTick:typeof c.setImmediate!="undefined"?c.setImmediate.bind(c):function(O){setTimeout(O,0)},addEventListener:c.addEventListener,inspect:JSON.stringify,stringByteSize:function(O){return c.TextDecoder&&new c.TextEncoder().encode(O).length||O.length},TextEncoder:c.TextEncoder,TextDecoder:c.TextDecoder,Promise:c.Promise,getRandomValues:function(O){if(O!==void 0)return function(d,A){O.getRandomValues(d),A&&A(null)}}(c.crypto||msCrypto)};t.default=E},function(s,t,n){"use strict";(function(i){t.__esModule=!0;var o=n(1),l=o.__importStar(n(2)),c="ablyjs-storage-test",u=function(){function f(){try{i.sessionStorage.setItem(c,c),i.sessionStorage.removeItem(c),this.sessionSupported=!0}catch(m){this.sessionSupported=!1}try{i.localStorage.setItem(c,c),i.localStorage.removeItem(c),this.localSupported=!0}catch(m){this.localSupported=!1}}return f.prototype.get=function(m){return this._get(m,!1)},f.prototype.getSession=function(m){return this._get(m,!0)},f.prototype.remove=function(m){return this._remove(m,!1)},f.prototype.removeSession=function(m){return this._remove(m,!0)},f.prototype.set=function(m,E,O){return this._set(m,E,O,!1)},f.prototype.setSession=function(m,E,O){return this._set(m,E,O,!0)},f.prototype._set=function(m,E,O,d){var A={value:E};return O&&(A.expires=l.now()+O),this.storageInterface(d).setItem(m,JSON.stringify(A))},f.prototype._get=function(m,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var O=this.storageInterface(E).getItem(m);if(!O)return null;var d=JSON.parse(O);return d.expires&&d.expires<l.now()?(this.storageInterface(E).removeItem(m),null):d.value},f.prototype._remove=function(m,E){return this.storageInterface(E).removeItem(m)},f.prototype.storageInterface=function(m){return m?i.sessionStorage:i.localStorage},f}();t.default=new u}).call(this,n(12))},function(s,t,n){"use strict";t.__esModule=!0;var i=n(1),o=i.__importDefault(n(66)),l={internetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[o.default.XhrPolling,o.default.XhrStreaming,o.default.JsonP,o.default.WebSocket],baseTransportOrder:[o.default.XhrPolling,o.default.XhrStreaming,o.default.JsonP,o.default.WebSocket],transportPreferenceOrder:[o.default.JsonP,o.default.XhrPolling,o.default.XhrStreaming,o.default.WebSocket],upgradeTransports:[o.default.XhrStreaming,o.default.WebSocket]};t.default=l},function(s,t,n){"use strict";t.__esModule=!0;var i;(function(o){o.WebSocket="web_socket",o.Comet="comet",o.XhrStreaming="xhr_streaming",o.XhrPolling="xhr_polling",o.JsonP="jsonp"})(i||(i={})),t.default=i},function(s,t,n){"use strict";n.r(t);var i=n(29),o=n.n(i),l=n(2),c=n(0),u=n.n(c),f=n(11),m=n.n(f),E=n(15),O=n.n(E),d=function(S){var w="xhr_polling";function p(y,g,v){v.stream=!1,m.a.call(this,y,g,v),this.shortName=w}return l.inherits(p,m.a),p.isAvailable=function(){return u.a.Config.xhrSupported&&u.a.Config.allowComet},p.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},p.prototype.createRequest=function(y,g,v,h,T){return O.a.createRequest(y,g,v,h,T,this.timeouts)},typeof S!="undefined"&&p.isAvailable()&&(S.supportedTransports[w]=p),p},A=d,I=function(S){var w="xhr_streaming";function p(y,g,v){m.a.call(this,y,g,v),this.shortName=w}return l.inherits(p,m.a),p.isAvailable=function(){return u.a.Config.xhrSupported&&u.a.Config.streamingSupported&&u.a.Config.allowComet},p.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},p.prototype.createRequest=function(y,g,v,h,T){return O.a.createRequest(y,g,v,h,T,this.timeouts)},typeof S!="undefined"&&p.isAvailable()&&(S.supportedTransports[w]=p),p},M=I,C=t.default=[o.a,A,M]}]).default})});k();k();var zi=(y=>(y.MEETING_START="meeting.start",y.MEETING_LEAVE="meeting.leave",y.MEETING_PARTICIPANT_AMOUNT_UPDATE="meeting.amount-of-participants-update",y.MEETING_PARTICIPANT_LIST_UPDATE="meeting.participant-list-update",y.MEETING_PARTICIPANT_JOINED="meeting.participant-joined",y.MEETING_PARTICIPANT_LEFT="meeting.participant-left",y.MEETING_JOIN="meeting.join",y.MEETING_PARTICIPANT_PROPERTIES="meeting.participant-properties",y.MEETING_HOST_CHANGE="meeting.host-change",y.MEETING_SAME_PARTICIPANT_ERROR="meeting.same-participant-error",y.MEETING_DEVICES_CHANGE="meeting.devices-change",y.MEETING_KICK_PARTICIPANTS="meeting.kick-all-participants",y.MEETING_STATE_UPDATE="meeting.state-update",y.MEETING_CONNECTION_STATUS_CHANGE="meeting.connection-status-change",y.MEETING_WAITING_FOR_HOST="meeting.waiting-for-host",y.MY_PARTICIPANT_UPDATED="my-participant.update",y.MY_PARTICIPANT_LEFT="my-participant.left",y.MY_PARTICIPANT_JOINED="my-participant.joined",y.MEETING_KICK_PARTICIPANT="meeting.kick-participant",y.DESTROY="destroy",y))(zi||{}),$i=(c=>(c.FRAME_LOAD="frame.load",c.FRAME_DIMENSIONS_UPDATE="frame.dimensions-update",c.FRAME_PARENT_SIZE_UPDATE="frame.parent-window-size-update",c.FRAME_LOCALE_UPDATE="frame.locales-update",c.FRAME_AVATAR_LIST_UPDATE="frame.avatar-list-update",c.FRAME_COLOR_LIST_UPDATE="frame.color-list-update",c))($i||{}),Is=(u=>(u.TOGGLE_MEETING_CHAT="meeting-controls.toggle-chat",u.TOGGLE_MEETING_SETUP="meeting-controls.toggle-setup",u.TOGGLE_MICROPHONE="meeting-controls.toggle-microphone",u.TOGGLE_CAM="meeting-controls.toggle-cam",u.TOGGLE_SCREENSHARE="meeting-controls.toggle-screenshare",u.TOGGLE_TRANSCRIPT="meeting-controls.toggle-transcript",u.HANG_UP="hang-up",u))(Is||{}),fr=(A=>(A.REALTIME_PARTICIPANT_LIST_UPDATE="realtime.participant-list-update",A.REALTIME_HOST_CHANGE="realtime.host-change",A.REALTIME_HOST_AVAILABLE="realtime.host-available",A.REALTIME_NO_HOST_AVAILABLE="realtime.no-host-available",A.REALTIME_GRID_MODE_CHANGE="realtime.grid-mode-change",A.REALTIME_WAIT_FOR_HOST="realtime.wait-for-host",A.REALTIME_AUTHENTICATION_FAILED="realtime.authentication-failed",A.REALTIME_GO_TO_PARTICIPANT="realtime.go-to-participant",A.REALTIME_GATHER="realtime.gather",A.REALTIME_FOLLOW_PARTICIPANT="realtime.follow-participant",A.REALTIME_SET_AVATAR="realtime.set-avatar",A.REALTIME_DRAWING_CHANGE="realtime.drawing-change",A.REALTIME_TRANSCRIPT_CHANGE="realtime.transcript-change",A))(fr||{});var xs=(E=>(E[E.MEETING_FAILED=-1]="MEETING_FAILED",E[E.MEETING_DISCONNECTED=0]="MEETING_DISCONNECTED",E[E.MEETING_INITIALIZING=1]="MEETING_INITIALIZING",E[E.MEETING_READY_TO_JOIN=2]="MEETING_READY_TO_JOIN",E[E.MEETING_CONNECTING=3]="MEETING_CONNECTING",E[E.MEETING_CONNECTED=4]="MEETING_CONNECTED",E[E.MEETING_RECONNECT=5]="MEETING_RECONNECT",E[E.FRAME_INITIALIZING=6]="FRAME_INITIALIZING",E[E.FRAME_INITIALIZED=7]="FRAME_INITIALIZED",E[E.FRAME_UNINITIALIZED=8]="FRAME_UNINITIALIZED",E))(xs||{}),Rs=(c=>(c.JOINED="participant.joined",c.LOCAL_JOINED="participant.local-joined",c.LEFT="participant.left",c.LOCAL_LEFT="participant.local-left",c.LOCAL_UPDATED="participant.updated",c.LIST_UPDATED="participant.list-updated",c))(Rs||{}),Vi=(u=>(u[u.NOT_AVAILABLE=0]="NOT_AVAILABLE",u[u.GOOD=1]="GOOD",u[u.BAD=2]="BAD",u[u.POOR=3]="POOR",u[u.DISCONNECTED=4]="DISCONNECTED",u[u.RECONNECTING=5]="RECONNECTING",u[u.LOST_CONNECTION=6]="LOST_CONNECTION",u))(Vi||{}),Fu=(c=>(c.NO_CAM="devices.no-cam",c.NO_DEVICES="devices.no-devices",c.DEVICES_BLOCKED="devices.blocked",c.DEVICES_CAM_BLOCKED="devices.cam-blocked",c.DEVICES_INITIALIZATION_ERROR="devices.inititalization-error",c.DEVICES_UNKNOWN_ERROR="devices.unknown-error",c))(Fu||{});k();k();k();k();var Re=(o,l,c,...u)=>Lt(void 0,[o,l,c,...u],function*(s,t,n,i={}){let f=yield fetch(s,{method:t,headers:dt({"Content-Type":"application/json"},i),body:n?JSON.stringify(n):null});if(!f.ok)throw f;return f.json()});k();var oh=Pn(Uu()),re=class{constructor(t){this.debug=(0,oh.default)(t)}log(t,...n){this.debug(t,...n)}};k();k();var kh=Pn(Hu());var xt=class{constructor(t={}){this.subscribe=t=>{this.callbacks.push(t)};this.unsubscribe=t=>{this.callbacks=this.callbacks.filter(n=>n!==t)};this.publish=(...t)=>{!this.callbacks||this.callbacks.forEach(n=>{this.callListener(n,t).catch(i=>{this.logger.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${n}
            Event: ${JSON.stringify(t)}
            Error: ${i}
          `)})})};this.reset=()=>{this.callbacks=[]};this.destroy=()=>{delete this.logger,delete this.callbacks};this.callListener=(t,n)=>new Promise((i,o)=>{try{let l=t(...n);i(l)}catch(l){o(l)}});let{logger:n,throttleTime:i}=t;this.logger=n!=null?n:new re("@superviz/sdk/observer-helper"),this.throttle=i,this.callbacks=[],this.throttle&&(this.publish=(0,kh.default)(this.publish,this.throttle))}};var hr=class{constructor(){this.observers={};this.subscribe=(t,n)=>{this.logger.log(`subscribed to ${t} event`),this.observers[t]||(this.observers[t]=new xt({logger:this.logger})),this.observers[t].subscribe(n)};this.unsubscribe=(t,n)=>{this.logger.log(`unsubscribed from ${t} event`),this.observers[t]&&(this.observers[t].reset(),delete this.observers[t])};this.publish=(t,n)=>{t in this.observers&&this.observers[t].publish(n)}}};k();k();k();var Gh=Pn(Ls()),Wu=class{setConfig(t){this.configuration=t}get(t,n){if(!this.configuration)throw new Error("configs is not available");return(0,Gh.get)(this.configuration,t,n)}},Ot=new Wu;var ve=class{static createUrl(t,n,i={}){let o=new URL(n,t);return Object.keys(i).forEach(l=>o.searchParams.append(l,i[l])),o.toString()}static validateApiKey(t,n){let i="/user/checkapikey",o=this.createUrl(t,i);return Re(o,"POST",{apiKey:n})}static fetchConfig(t,n){let i="/immersive-config",o=this.createUrl(t,i);return Re(o,"POST",{apiKey:n})}static fetchLimits(t,n){return Lt(this,null,function*(){let i="/user/check_limits",o=this.createUrl(t,i);return(yield Re(o,"GET","",{apikey:n})).usage})}static fetchWaterMark(t,n){return Lt(this,null,function*(){let i="/user/watermark",o=this.createUrl(t,i),{message:l}=yield Re(o,"POST",{apiKey:n});return l})}static createAnnotations(t,n,i){return Lt(this,null,function*(){let o="/annotations",l=this.createUrl(t,o);return Re(l,"POST",dt({},i),{apikey:n})})}static updateComment(t,n,i,o){return Lt(this,null,function*(){let l=`/comments/${i}`,c=this.createUrl(t,l);return Re(c,"PUT",{text:o},{apikey:n})})}static createComment(t,n,i){return Lt(this,null,function*(){let o="/comments",l=this.createUrl(t,o);return Re(l,"POST",dt({},i),{apikey:n})})}static fetchAnnotation(t,n,i){return Lt(this,null,function*(){let o="/annotations",l=this.createUrl(t,o,{roomId:i.roomId,url:i.url});return Re(l,"GET",void 0,{apikey:n})})}static resolveAnnotation(t,n,i){return Lt(this,null,function*(){let o=`/annotations/resolve/${i}`,l=this.createUrl(t,o);return Re(l,"POST",{},{apikey:n})})}static deleteComment(t,n,i){return Lt(this,null,function*(){let o=`/comments/${i}`,l=this.createUrl(t,o);return Re(l,"DELETE",{},{apikey:n})})}static deleteAnnotation(t,n,i){return Lt(this,null,function*(){let o=`/annotations/${i}`,l=this.createUrl(t,o);return Re(l,"DELETE",{},{apikey:n})})}static createOrUpdateParticipant(t,n){return Lt(this,null,function*(){let i=Ot.get("apiUrl"),o="/participants",l=this.createUrl(i,o);return Re(l,"POST",dt({},n),{apikey:t})})}static sendActivity(t,n,i,o){return Lt(this,null,function*(){let l="/activity",c=Ot.get("apiUrl"),u=Ot.get("roomId"),f=Ot.get("apiKey"),m=this.createUrl(c,l);return Re(m,"POST",{groupId:n,groupName:i,meetingId:u,product:o,userId:t},{apikey:f})})}};k();var Ds=(n=>(n.GRID="grid",n.LIST="list",n))(Ds||{});k();var yn=class extends hr{constructor(){super(...arguments);this.isAttached=!1;this.attach=n=>{if(Object.values(n).includes(null)||Object.values(n).includes(void 0)){let f=`${this.name} @ attach - params are required`;throw this.logger.log(f),new Error(f)}let{realtime:i,localParticipant:o,group:l,config:c,eventBus:u}=n;if(Ot.setConfig(c),this.realtime=i,this.localParticipant=o,this.group=l,this.eventBus=u,this.isAttached=!0,!this.realtime.isJoinedRoom){this.logger.log(`${this.name} @ attach - not joined yet`),setTimeout(()=>{this.logger.log(`${this.name} @ attach - retrying`),this.attach(n)},1e3);return}this.logger.log(`${this.name} @ attached`),this.start()};this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached}`);return}this.logger.log("detached"),this.destroy(),this.realtime=void 0,this.localParticipant=void 0,this.isAttached=!1,Object.keys(this.observers).forEach(n=>this.unsubscribe(n))}}};k();var zu=(i=>(i.presence3dMatterport="presence3d",i.presence3dAutodesk="presence3d",i.presence3dThreejs="presence3d",i))(zu||{});var Ji=class extends yn{constructor(n){super();this.sidebarOpen=!1;this.onFixedPin=n=>{document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:dt({},n),composed:!0,bubbles:!0}))};this.toggleAnnotationSidebar=()=>{this.element.toggleAttribute("open"),this.sidebarOpen=this.element.hasAttribute("open"),this.pinAdapter.setActive(this.sidebarOpen),document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:void 0,composed:!0,bubbles:!0}))};this.createAnnotation=i=>Lt(this,[i],function*({detail:n}){try{let{position:o,text:l}=n,{url:c}=this,u=yield ve.createAnnotations(Ot.get("apiUrl"),Ot.get("apiKey"),{roomId:Ot.get("roomId"),position:JSON.stringify(o),url:c,userId:this.localParticipant.id}),f=yield this.createComment(u.uuid,l);this.addAnnotation([oe(dt({},u),{comments:[f]})]),this.pinAdapter.removeAnnotationPin("temporary-pin"),document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:u.uuid},composed:!0,bubbles:!0}))}catch(o){this.logger.log("error when creating annotation",o)}});this.deleteAnnotation=i=>Lt(this,[i],function*({detail:n}){try{let{uuid:o}=n;yield ve.deleteAnnotation(Ot.get("apiUrl"),Ot.get("apiKey"),o);let l=this.annotations.filter(c=>c.uuid!==o);this.updateAnnotationList(l),this.pinAdapter.removeAnnotationPin(o)}catch(o){this.logger.log("error when deleting annotation",o)}});this.updateComment=i=>Lt(this,[i],function*({detail:n}){try{let{uuid:o,text:l}=n;yield ve.updateComment(Ot.get("apiUrl"),Ot.get("apiKey"),o,l);let c=this.annotations.map(u=>Object.assign({},u,{comments:u.comments.map(f=>f.uuid===o?Object.assign({},f,{text:l}):f)}));this.updateAnnotationList(c)}catch(o){this.logger.log("error when updating comment",o)}});this.resolveAnnotation=i=>Lt(this,[i],function*({detail:n}){try{let{uuid:o}=n;yield ve.resolveAnnotation(Ot.get("apiUrl"),Ot.get("apiKey"),o);let l=this.annotations.map(c=>c.uuid===o?Object.assign({},c,{resolved:!0}):c);this.updateAnnotationList(l)}catch(o){this.logger.log("error when resolve annotation",o)}});this.deleteComment=i=>Lt(this,[i],function*({detail:n}){try{let{uuid:o}=n;yield ve.deleteComment(Ot.get("apiUrl"),Ot.get("apiKey"),o);let l=this.annotations.findIndex(f=>f.comments.some(m=>m.uuid===o));if(l===-1)return;let c=this.annotations[l];c.comments=c.comments.filter(f=>f.uuid!==o);let u=[...this.annotations.slice(0,l),c,...this.annotations.slice(l+1)];this.updateAnnotationList(u)}catch(o){this.logger.log("error when deleting comment",o)}});this.onAnnotationListUpdate=n=>{this.annotations=n,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)};this.name="comments",this.logger=new re("@superviz/sdk/comments-component"),this.annotations=[],this.pinAdapter=n}start(){this.url=window.location.href,this.element=document.createElement("superviz-comments"),this.element.setAttribute("comments",JSON.stringify([])),document.body.appendChild(this.element),this.button=document.createElement("superviz-comments-button"),document.body.appendChild(this.button),this.fetchAnnotations(),this.waterMarkState(),this.addListeners()}destroy(){this.destroyListeners(),document.body.removeChild(this.element),this.element=void 0,this.pinAdapter.destroy()}addListeners(){this.button.addEventListener("toggle",this.toggleAnnotationSidebar),this.element.addEventListener("toggle",this.toggleAnnotationSidebar),this.element.addEventListener("create-annotation",this.createAnnotation),this.element.addEventListener("resolve-annotation",this.resolveAnnotation),this.element.addEventListener("delete-annotation",this.deleteAnnotation),this.element.addEventListener("create-comment",({detail:n})=>{this.createComment(n.uuid,n.text,!0)}),this.element.addEventListener("update-comment",this.updateComment),this.element.addEventListener("delete-comment",this.deleteComment),this.realtime.commentsObserver.subscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.subscribe(this.onFixedPin)}destroyListeners(){this.button.removeEventListener("toggle",this.toggleAnnotationSidebar),this.element.removeEventListener("toggle",this.toggleAnnotationSidebar),this.element.removeEventListener("create-annotation",this.createAnnotation),this.element.removeEventListener("resolve-annotation",this.resolveAnnotation),this.element.removeEventListener("create-comment",({detail:n})=>{this.createComment(n.uuid,n.text,!0)}),this.element.removeEventListener("update-comment",this.updateComment),this.element.removeEventListener("delete-comment",this.deleteComment),this.realtime.commentsObserver.unsubscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.unsubscribe(this.onFixedPin)}createComment(n,i,o=!1){return Lt(this,null,function*(){try{let l=yield ve.createComment(Ot.get("apiUrl"),Ot.get("apiKey"),{annotationId:n,userId:this.localParticipant.id,text:i});return o&&this.addComment(n,l),l}catch(l){this.logger.log("error when creating comment",l)}})}addAnnotation(n){let i=[...this.annotations,...n];this.updateAnnotationList(i)}updateAnnotationList(n){this.annotations=n,this.realtime.updateComments(n)}addComment(n,i){let o=this.annotations.findIndex(u=>u.uuid===n);if(o===-1)return;let l=this.annotations[o];l.comments=[...l.comments,i];let c=[...this.annotations.slice(0,o),l,...this.annotations.slice(o+1)];this.updateAnnotationList(c)}fetchAnnotations(){return Lt(this,null,function*(){try{let n=yield ve.fetchAnnotation(Ot.get("apiUrl"),Ot.get("apiKey"),{roomId:Ot.get("roomId"),url:this.url});this.annotations=n,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)}catch(n){this.logger.log("error when fetching annotations",n)}})}waterMarkState(){return Lt(this,null,function*(){try{let n=yield ve.fetchWaterMark(Ot.get("apiUrl"),Ot.get("apiKey")),i=["all","powered-by","powered-by"].includes(n);this.element.waterMarkStatus(i)}catch(n){this.logger.log("error when fetching waterMark",n)}})}};k();k();var Ns=(n=>(n.ADD="add",n.SHOW="show",n))(Ns||{});k();var ju=Pn(Ls());k();var bn=Pn(Hh()),qi=class{constructor(){this.browser=bn.default.getParser(navigator.userAgent)}get clientStats(){return this.browser.getResult()}get isFirefox(){return this.browser.isBrowser(bn.default.BROWSER_MAP.firefox)}get isSafari(){return this.browser.isBrowser(bn.default.BROWSER_MAP.safari)}get isChrome(){return this.browser.isBrowser(bn.default.BROWSER_MAP.chrome)}get isIE(){return this.browser.isBrowser(bn.default.BROWSER_MAP.ie)}get isEdge(){return this.browser.isBrowser(bn.default.BROWSER_MAP.edge)}get isMobileDevice(){return(this.browser.is(bn.default.PLATFORMS_MAP.mobile)||this.browser.is(bn.default.PLATFORMS_MAP.tablet))&&!navigator.userAgent.match(/iPad/i)}get isTabletDevice(){return this.browser.is(bn.default.PLATFORMS_MAP.tablet)}get isAndroid(){return this.isMobileDevice&&!!navigator.userAgent.match(/Android/i)}get isIpad(){return!!navigator.userAgent.match(/iPad/i)}get isIphone(){return this.isMobileDevice&&!!navigator.userAgent.match(/iPhone/i)}get isAppleMobileDevice(){return this.isIpad||this.isIphone}};k();var Fs=class{constructor(){this.updateMeetingConnectionStatus=t=>{this.oldConnectionStatus=this.connectionStatus,this.connectionStatus=t,this.connectionStatusObserver.publish(t),this.logger.log("CONNECTION STATUS CHANGE",t)};this.onUpdateBrowserOnlineStatus=t=>{let{type:n}=t;if(n==="online"){this.updateMeetingConnectionStatus(1);return}this.updateMeetingConnectionStatus(4)};this.logger=new re("@superviz/sdk/connection-service"),this.connectionStatus=0,this.connectionStatusObserver=new xt({logger:this.logger})}addListeners(){window.addEventListener("online",this.onUpdateBrowserOnlineStatus),window.addEventListener("offline",this.onUpdateBrowserOnlineStatus)}removeListeners(){window.removeEventListener("online",this.onUpdateBrowserOnlineStatus),window.removeEventListener("offline",this.onUpdateBrowserOnlineStatus)}};k();k();var Us=class{build(t,n,i,o={},l={}){let c=document.querySelector(`#${t}`),u=new URL(n);if(this.wrapperId||this.element)throw new Error("Tried to initialize two frames with the same FrameBricklayer instance");this.element=document.createElement("iframe"),Object.entries(o).forEach(([f,m])=>{u.searchParams.set(f,m)}),Object.entries(l).forEach(([f,m])=>{this.element.setAttribute(f,m)}),this.element.src=u.toString(),this.element.id=i,c.appendChild(this.element),this.wrapperId=t}destroy(){if(!this.wrapperId)throw new Error("Tried to destroy a frame before it was initialized");let t=document.querySelector(`#${this.wrapperId}`);!!t&&!!t.querySelector(`#${this.element.id}`)&&t.removeChild(this.element),this.wrapperId=null,this.element=null}};k();var Bs=class{constructor(t){this.observers={};this.sourceBlockList=["vue-devtools-proxy","vue-devtools-backend"];this.originBlockList=["https://sketchfab.com"];this.publish=(t,n={})=>{this.logger.log("MessageBridge","Posting message to frame",t,n),this.contentWindow.postMessage({type:t,data:n},this.allowedOrigins)};this.listen=(t,n)=>{this.observers[t]||(this.observers[t]=new xt({logger:this.logger})),this.observers[t].subscribe(n)};this.onReceiveMessage=t=>{let{type:n,data:i,source:o}=t.data;if(this.sourceBlockList.includes(o)||this.originBlockList.includes(t.origin))return;let l=!!n,c=!this.domains.length||this.domains.includes(t.origin),u=this.observers.hasOwnProperty(n);if(this.logger.log("MessageBridge",`Message received -
        TYPE: ${t.type}
        ORIGIN: ${t.origin}
        DATA: ${JSON.stringify(t.data)} `),!l||!c||!u){this.logger.log("MessageBridge","Message discarded");return}this.observers[n].publish(i)};let{contentWindow:n,domains:i=[],allowedOrigins:o="*",sourceBlockList:l=[],logger:c}=t;if(this.logger=c,this.domains=i,this.allowedOrigins=o,this.sourceBlockList.push(...l),typeof window=="undefined")throw new Error("MessageBridge: window is undefined");this.contentWindow=n,window.addEventListener("message",this.onReceiveMessage)}destroy(){Object.entries(this.observers).forEach(([t,n])=>{n.reset(),delete this.observers[t]}),window.removeEventListener("message",this.onReceiveMessage),delete this.logger,delete this.allowedOrigins,delete this.contentWindow,delete this.domains,delete this.observers,delete this.sourceBlockList}};var Wh="sv-video-frame",Yi=class{constructor(t){this.logger=new re("@superviz/sdk/video-conference-manager");this.frameStateObserver=new xt({logger:this.logger});this.frameSizeObserver=new xt({logger:this.logger});this.waitingForHostObserver=new xt({logger:this.logger});this.realtimeEventsObserver=new xt({logger:this.logger});this.sameAccountErrorObserver=new xt({logger:this.logger});this.devicesObserver=new xt({logger:this.logger});this.meetingStateObserver=new xt({logger:this.logger});this.meetingConnectionObserver=new xt({logger:this.logger});this.participantJoinedObserver=new xt({logger:this.logger});this.participantLeftObserver=new xt({logger:this.logger});this.participantListObserver=new xt({logger:this.logger});this.frameState=0;this.layoutModalsAndCamerasConfig=(t,n)=>{let i=t,o=n,l=["left","right","bottom","top"].includes(o),c=["left","right","center"].includes(i);return l||(o="right"),c||(i="right"),this.browserService.isMobileDevice?(o="bottom",{layoutPosition:i,camerasPosition:o}):(i==="left"&&o==="right"&&(i="right"),i==="right"&&o==="left"&&(i="left"),{layoutPosition:i,camerasPosition:o})};this.onFrameLoad=()=>{this.messageBridge=new Bs({logger:this.logger,contentWindow:this.bricklayer.element.contentWindow}),this.addMessagesListeners(),this.updateFrameState(2),this.updateFrameLocale(),this.updateMeetingAvatars(),this.onWindowResize(),this.setCustomColors()};this.setFrameOffset=t=>{let n=t!=null?t:{};["top","bottom","left","right"].forEach(i=>{Object.keys(n).includes(i)||(n[i]=0)}),this.frameOffset=n};this.setCustomColors=()=>{!this.customColors||this.messageBridge.publish("frame.color-list-update",this.customColors)};this.setFrameStyle=t=>{let n=document.createElement("style"),{bottom:i,left:o,right:l,top:c}=this.frameOffset;if(n.innerHTML=`
      :root {
        --superviz-offset-top: ${c}px;
        --superviz-offset-right: ${l}px;
        --superviz-offset-left: ${o}px;
        --superviz-offset-bottom: ${i}px;
      }     
    `,document.head.appendChild(n),this.browserService.isMobileDevice){this.bricklayer.element.classList.add("sv-video-frame--bottom");return}this.bricklayer.element.classList.add(`sv-video-frame--${t}`)};this.onFrameDimensionsUpdate=({width:t,height:n})=>{let i=document.getElementById(Wh),{bottom:o,right:l,left:c,top:u}=this.frameOffset,f=this.isWaterMarkEnabled?40:0,m=`${t}px`,E=`${n+f}px`;(t>=window.innerWidth||this.isHorizontalCameraEnabled)&&(m=`calc(100% - ${l}px - ${c}px)`),n>=window.innerHeight&&(E=`calc(100% - ${u}px - ${o}px)`),i.style.width=m,i.style.height=E,this.frameSizeObserver.publish({width:i.offsetWidth,height:i.offsetHeight})};this.onWindowResize=()=>{let{top:t,bottom:n,right:i,left:o}=this.frameOffset,{innerHeight:l,innerWidth:c}=window,u=l-t-n,f=c-i-o;!this.messageBridge||this.messageBridge.publish("frame.parent-window-size-update",{height:u,width:f})};this.updateFrameLocale=()=>{var l,c;if(!this.frameLocale||!((l=this.frameLocale)!=null&&l.language)&&((c=this.frameLocale)==null?void 0:c.locales))return;let{language:t,locales:n}=this.frameLocale,i=n.map(u=>u==null?void 0:u.language),o=["en",...i];if(t&&!o.includes(t))throw new Error("The default language is not available in the language listing.");this.messageBridge.publish("frame.locales-update",this.frameLocale)};this.updateMeetingAvatars=()=>{this.messageBridge.publish("frame.avatar-list-update",this.meetingAvatars)};this.onParticipantJoined=t=>{this.participantJoinedObserver.publish(t)};this.onParticipantLeft=t=>{this.participantLeftObserver.publish(t)};this.onMeetingHostChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.host-change",data:t})};this.onMeetingKickParticipant=t=>{this.realtimeEventsObserver.publish({event:"meeting.kick-participant",data:t})};this.onFollowParticipantDidChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.follow-participant",data:t})};this.onGoToDidChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.go-to-participant",data:t})};this.onGather=()=>{this.realtimeEventsObserver.publish({event:"realtime.gather",data:!0})};this.onGridModeChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.grid-mode-change",data:t})};this.onDrawingChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.drawing-change",data:t})};this.onTranscriptChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.transcript-change",data:t})};this.onSameAccountError=t=>{this.sameAccountErrorObserver.publish(t)};this.onDevicesChange=t=>{this.devicesObserver.publish(t)};this.meetingStateUpdate=t=>{this.meetingStateObserver.publish(t)};this.onConnectionStatusChange=t=>{this.meetingConnectionObserver.publish(t)};this.onWaitingForHostDidChange=t=>{this.waitingForHostObserver.publish(t)};this.onParticipantListUpdate=t=>{this.participantListObserver.publish(t)};var T,x,L,z;let{language:n,canUseCams:i,canUseChat:o,canUseScreenshare:l,canUseDefaultAvatars:c,canUseFollow:u,canUseGoTo:f,canUseGather:m,browserService:E,offset:O,canUseDefaultToolbar:d,locales:A,avatars:I,customColors:M,waterMark:C,layoutPosition:S,camerasPosition:w,skipMeetingSettings:p,devices:y,layoutMode:g}=t;this.browserService=E;let v=this.layoutModalsAndCamerasConfig(S,w),h=document.createElement("div");this.frameConfig={apiKey:Ot.get("apiKey"),apiUrl:Ot.get("apiUrl"),ablyKey:Ot.get("ablyKey"),debug:Ot.get("debug"),canUseFollow:u,canUseGoTo:f,canUseCams:i,canUseChat:o,canUseGather:m,canUseScreenshare:l,canUseDefaultAvatars:c,camerasPosition:(T=v.camerasPosition)!=null?T:"right",canUseDefaultToolbar:d,roomId:Ot.get("roomId"),devices:{audioInput:(x=y==null?void 0:y.audioInput)!=null?x:!0,audioOutput:(L=y==null?void 0:y.audioOutput)!=null?L:!0,videoInput:(z=y==null?void 0:y.videoInput)!=null?z:!0},waterMark:C,layoutMode:g,skipMeetingSettings:p,layoutPosition:v.layoutPosition},this.customColors=M,h.classList.add("sv_video_wrapper"),h.id="sv-video-wrapper",document.body.appendChild(h),this.updateFrameState(1),this.bricklayer=new Us,this.bricklayer.build(h.id,Ot.get("conferenceLayerUrl"),Wh,void 0,{allow:"camera *;microphone *; display-capture *;"}),this.setFrameOffset(O),this.setFrameStyle(v.camerasPosition),this.bricklayer.element.addEventListener("load",this.onFrameLoad),this.frameLocale={language:n,locales:A},this.meetingAvatars=I,window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.onWindowResize)}get isWaterMarkEnabled(){return this.browserService.isMobileDevice?!1:["all","powered-by"].includes(this.frameConfig.waterMark)}get isHorizontalCameraEnabled(){return this.browserService.isMobileDevice?!1:["top","bottom"].includes(this.frameConfig.camerasPosition)}addMessagesListeners(){this.messageBridge.listen("meeting.waiting-for-host",this.onWaitingForHostDidChange),this.messageBridge.listen("meeting.participant-joined",this.onParticipantJoined),this.messageBridge.listen("meeting.participant-list-update",this.onParticipantListUpdate),this.messageBridge.listen("meeting.participant-left",this.onParticipantLeft),this.messageBridge.listen("meeting.host-change",this.onMeetingHostChange),this.messageBridge.listen("meeting.kick-participant",this.onMeetingKickParticipant),this.messageBridge.listen("meeting.same-participant-error",this.onSameAccountError),this.messageBridge.listen("meeting.state-update",this.meetingStateUpdate),this.messageBridge.listen("meeting.connection-status-change",this.onConnectionStatusChange),this.messageBridge.listen("meeting.devices-change",this.onDevicesChange),this.messageBridge.listen("realtime.grid-mode-change",this.onGridModeChange),this.messageBridge.listen("realtime.drawing-change",this.onDrawingChange),this.messageBridge.listen("realtime.transcript-change",this.onTranscriptChange),this.messageBridge.listen("frame.dimensions-update",this.onFrameDimensionsUpdate),this.messageBridge.listen("realtime.follow-participant",this.onFollowParticipantDidChange),this.messageBridge.listen("realtime.go-to-participant",this.onGoToDidChange),this.messageBridge.listen("realtime.gather",this.onGather)}updateFrameState(t){t!==this.frameState&&(this.frameState=t,this.frameStateObserver.publish(this.frameState));let n={[1]:6,[2]:7,[0]:8};this.meetingStateUpdate(n[t])}start(t){this.messageBridge.publish("meeting.start",oe(dt({},t),{config:this.frameConfig}))}leave(){this.messageBridge.publish("meeting.leave"),this.destroy()}destroy(){var t,n;(t=this.messageBridge)==null||t.destroy(),(n=this.bricklayer)==null||n.destroy(),this.frameSizeObserver.destroy(),this.realtimeEventsObserver.destroy(),this.sameAccountErrorObserver.destroy(),this.devicesObserver.destroy(),this.meetingStateObserver.destroy(),this.meetingConnectionObserver.destroy(),this.participantJoinedObserver.destroy(),this.participantLeftObserver.destroy(),this.bricklayer=null,this.frameState=null}publishMessageToFrame(t,n){this.messageBridge.publish(t,n)}};var Qi=class extends yn{constructor(n){super();this.participantToFrameList=[];this.participantsOnMeeting=[];this.startVideo=()=>{var n,i,o,l,c,u,f,m,E,O,d,A,I,M,C,S,w,p,y,g,v,h,T,x;this.videoConfig={language:(n=this.params)==null?void 0:n.language,canUseChat:!((i=this.params)!=null&&i.chatOff),canUseCams:!((o=this.params)!=null&&o.camsOff),canUseScreenshare:!((l=this.params)!=null&&l.screenshareOff),canUseDefaultAvatars:!!((c=this.params)!=null&&c.defaultAvatars)&&!((f=(u=this.localParticipant)==null?void 0:u.avatar)!=null&&f.model3DUrl),canUseGather:!!((m=this.params)!=null&&m.enableGather),canUseFollow:!!((E=this.params)!=null&&E.enableFollow),canUseGoTo:!!((O=this.params)!=null&&O.enableGoTo),canUseDefaultToolbar:(A=(d=this.params)==null?void 0:d.defaultToolbar)!=null?A:!0,camerasPosition:(I=this.params)==null?void 0:I.camerasPosition,devices:(M=this.params)==null?void 0:M.devices,skipMeetingSettings:(C=this.params)==null?void 0:C.skipMeetingSettings,browserService:this.browserService,offset:(S=this.params)==null?void 0:S.offset,locales:(p=(w=this.params)==null?void 0:w.locales)!=null?p:[],avatars:(g=(y=this.params)==null?void 0:y.avatars)!=null?g:[],customColors:(v=this.params)==null?void 0:v.customColors,layoutPosition:(h=this.params)==null?void 0:h.layoutPosition,layoutMode:(x=(T=this.params)==null?void 0:T.layoutMode)!=null?x:"list"},this.logger.log("video component @ start video",this.videoConfig),this.videoManager=new Yi(this.videoConfig),this.subscribeToVideoEvents()};this.subscribeToVideoEvents=()=>{this.logger.log("video component @ subscribe to video events"),this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError),this.videoManager.devicesObserver.subscribe(this.onDevicesChange)};this.unsubscribeFromVideoEvents=()=>{this.logger.log("video component @ unsubscribe from video events"),this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError),this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange)};this.suscribeToRealtimeEvents=()=>{this.logger.log("video component @ subscribe to realtime events"),this.realtime.kickAllParticipantsObserver.subscribe(this.onKickAllParticipantsDidChange),this.realtime.kickParticipantObserver.subscribe(this.onKickLocalParticipant),this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.subscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.subscribe(this.onRealtimeParticipantsDidChange),this.realtime.hostObserver.subscribe(this.onHostParticipantDidChange)};this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("video component @ unsubscribe from realtime events"),this.realtime.kickAllParticipantsObserver.unsubscribe(this.onKickAllParticipantsDidChange),this.realtime.participantJoinedObserver.unsubscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.unsubscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.unsubscribe(this.onRealtimeParticipantsDidChange),this.realtime.hostObserver.unsubscribe(this.onHostParticipantDidChange)};this.createParticipantFromAblyPresence=n=>{var i;return{id:n.clientId,color:this.realtime.getSlotColor((i=n.data)==null?void 0:i.slotIndex).color,avatar:n.data.avatar,type:n.data.type,name:n.data.name,isHost:this.realtime.hostClientId===n.clientId}};this.onFrameSizeDidChange=n=>{this.publish("frame.dimensions-update",n)};this.onWaitingForHost=n=>{this.publish("meeting.waiting-for-host",n)};this.onConnectionStatusChange=n=>{this.logger.log("video component @ on connection status change",n);let i=[2,4,3,6];i.includes(n)&&this.realtime.freezeSync(!0),i.includes(this.connectionService.oldConnectionStatus)&&!i.includes(n)&&this.realtime.freezeSync(!1),this.publish("meeting.connection-status-change",n)};this.onMeetingStateChange=n=>{this.logger.log("video component @ on meeting state change",n),this.publish("meeting.state-update",n)};this.onSameAccountError=n=>{this.publish("meeting.same-participant-error",n),this.detach()};this.onDevicesChange=n=>{this.publish("meeting.devices-change",n)};this.onFrameStateChange=n=>{this.logger.log("video component @ on frame state change",n),n===2&&this.videoManager.start({group:this.group,participant:this.localParticipant,roomId:Ot.get("roomId")})};this.onRealtimeEventFromFrame=({event:n,data:i})=>{this.logger.log("video component @ on realtime event from frame",n,i);let o={["realtime.host-change"]:l=>this.realtime.setHost(l),["realtime.gather"]:l=>this.realtime.setGather(l),["realtime.grid-mode-change"]:l=>this.realtime.setGridMode(l),["realtime.drawing-change"]:l=>{this.realtime.setDrawing(l)},["realtime.follow-participant"]:l=>{this.realtime.setFollowParticipant(l)},["meeting.kick-participant"]:l=>{this.realtime.setKickParticipant(l)},["realtime.transcript-change"]:l=>{this.realtime.setTranscript(l)},["realtime.go-to-participant"]:l=>{this.eventBus.publish("realtime.go-to-participant",l)}}[n](i);this.publish(n,i)};this.onParticipantJoined=n=>{if(this.logger.log("video component @ on participant joined",n),this.localParticipant=n,this.publish("meeting.participant-joined",n),this.publish("my-participant.joined",n),this.videoConfig.canUseDefaultAvatars){this.realtime.updateMyProperties({avatar:n.avatar,name:n.name});return}this.realtime.updateMyProperties({name:n.name})};this.onParticipantLeft=n=>{this.logger.log("video component @ on participant left",this.localParticipant),this.publish("my-participant.left",this.localParticipant),this.detach()};this.onParticipantListUpdate=n=>{this.logger.log("video component @ on participant list update",n),!(0,ju.isEqual)(this.participantsOnMeeting,n)&&(this.publish("meeting.participant-list-update",n),this.participantsOnMeeting.length!==n.length&&this.publish("meeting.amount-of-participants-update",n.length),this.participantsOnMeeting=n)};this.onKickAllParticipantsDidChange=n=>{this.logger.log("video component @ on kick all participants did change",n),this.publish("meeting.kick-all-participants",n),this.detach()};this.onKickLocalParticipant=()=>{this.logger.log("video component @ on kick local participant"),this.publish("meeting.kick-participant",this.localParticipant),this.detach()};this.onRoomInfoUpdated=n=>{this.logger.log("video component @ on room info updated",n);let{isGridModeEnable:i,followParticipantId:o,gather:l,drawing:c,transcript:u}=n;this.videoManager.publishMessageToFrame("realtime.grid-mode-change",i),this.videoManager.publishMessageToFrame("realtime.drawing-change",c),this.videoManager.publishMessageToFrame("realtime.follow-participant",o),this.videoManager.publishMessageToFrame("realtime.transcript-change",u),this.realtime.hostClientId===this.localParticipant.id&&l&&this.realtime.setGather(!1)};this.onRealtimeParticipantsDidChange=n=>{this.logger.log("video component @ on participants did change",n);let i=Object.values(n).map(o=>({timestamp:o.timestamp,connectionId:o.connectionId,participantId:o.clientId,color:this.realtime.getSlotColor(o.data.slotIndex).name,name:o.data.name,isHost:this.realtime.hostClientId===o.clientId,avatar:o.data.avatar,type:o.data.type}));(0,ju.isEqual)(this.participantToFrameList,i)||this.videoManager.publishMessageToFrame("realtime.participant-list-update",i),this.participantToFrameList=i};this.onHostParticipantDidChange=n=>{this.logger.log("video component @ on host participant did change",n),this.videoManager.publishMessageToFrame("realtime.host-change",n==null?void 0:n.newHostParticipantId)};this.onParticipantJoinedOnRealtime=n=>{this.logger.log("video component @ on participant joined on realtime",n),this.publish("meeting.participant-joined",this.createParticipantFromAblyPresence(n))};this.onParticipantLeftOnRealtime=n=>{this.logger.log("video component @ on participant left on realtime",n),this.publish("meeting.participant-left",this.createParticipantFromAblyPresence(n))};this.params=n,this.name="videoConference",this.logger=new re(`@superviz/sdk/${"videoConference"}`),this.browserService=new qi,this.connectionService=new Fs,this.connectionService.addListeners(),this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange)}toggleMeetingSetup(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-setup")}toggleMicrophone(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-microphone")}toggleCam(){this.videoManager.publishMessageToFrame("meeting-controls.toggle-cam")}toggleScreenShare(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-screenshare")}toggleChat(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-chat")}toggleTranscript(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-transcript")}hangUp(){this.videoManager.publishMessageToFrame("hang-up")}start(){this.logger.log("video component @ start"),this.publish("meeting.start"),this.suscribeToRealtimeEvents(),this.startVideo()}destroy(){this.logger.log("video component @ destroy"),this.publish("destroy"),this.unsubscribeFromRealtimeEvents(),this.unsubscribeFromVideoEvents(),this.videoManager.leave(),this.connectionService.removeListeners()}};k();var Xi=class extends yn{constructor(n){super();this.subscribeToRealtimeEvents=()=>{this.logger.log("presence-mouse component @ subscribe to realtime events"),this.realtime.participantLeaveObserver.subscribe(this.onParticipantLeftOnRealtime),this.realtime.participantsObserver.subscribe(this.onParticipantsDidChange)};this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.realtime.participantLeaveObserver.unsubscribe(this.onParticipantLeftOnRealtime),this.realtime.participantsObserver.unsubscribe(this.onParticipantsDidChange)};this.onMyParticipantMouseMove=n=>{let i=this.divWrapper.getBoundingClientRect();this.realtime.updateMyProperties({mousePositionX:n.x-i.x,mousePositionY:n.y-i.y,originalWidth:i.width,originalHeight:i.height,containerId:this.containerId})};this.onParticipantsDidChange=n=>{this.logger.log("presence-mouse component @ on participants did change",n),Object.values(n).forEach(i=>{var u;let o=i.data,l=(o==null?void 0:o.mousePositionX)&&this.presenceMouseElement,c=(o==null?void 0:o.id)===((u=this.localParticipant)==null?void 0:u.id);o.color=this.realtime.getSlotColor(i.data.slotIndex).color,o.slotIndex=i.data.slotIndex,!c&&l&&this.presenceMouseElement.updatePresenceMouseParticipant(o)})};this.onParticipantLeftOnRealtime=n=>{this.presenceMouseElement.removePresenceMouseParticipant(n.clientId)};if(this.name="presence",this.logger=new re(`@superviz/sdk/${"presence"}`),this.containerId=n,this.container=document.getElementById(n),!this.container){let i=`Container with id ${n} not found`;throw this.logger.log(i),new Error(i)}this.divWrapper=this.createDivWrapper()}start(){this.logger.log("presence-mouse component @ start"),this.presenceMouseElement=document.createElement("superviz-presence-mouse"),this.divWrapper.appendChild(this.presenceMouseElement),this.container.addEventListener("mousemove",this.onMyParticipantMouseMove),this.subscribeToRealtimeEvents()}destroy(){this.logger.log("presence-mouse component @ destroy"),this.unsubscribeFromRealtimeEvents(),this.container.removeEventListener("mousemove",this.onMyParticipantMouseMove),this.divWrapper.removeChild(this.presenceMouseElement)}createDivWrapper(){let n=this.container.getBoundingClientRect(),i=document.createElement("div");return this.container.parentElement.style.position="relative",i.style.position="absolute",i.style.top=`${n.top}px`,i.style.left=`${n.left}px`,i.style.width=`${n.width}px`,i.style.height=`${n.height}px`,i.style.pointerEvents="none",this.container.parentElement.appendChild(i),i}};k();k();var ks=class{constructor(t){this.observers=new Map;this.subscribe=(t,n)=>{this.logger.log("pubsub service @ subscribe",{event:t,callback:n}),this.observers.has(t)||this.observers.set(t,new xt),this.observers.get(t).subscribe(n)};this.unsubscribe=(t,n)=>{this.logger.log("pubsub service @ unsubscribe",{event:t,callback:n}),this.observers.has(t)&&(this.observers.get(t).reset(),this.observers.delete(t))};this.publish=(t,n)=>{this.logger.log("pubsub service @ publish",{event:t,data:n}),this.realtime.setSyncProperty(t,n)};this.publishEventToClient=(t,n)=>{this.logger.log("pubsub service @ publishEventToClient",{event:t,data:n}),this.observers.has(t)&&this.observers.get(t).publish(n)};this.destroy=()=>{this.logger.log("pubsub service @ destroy"),this.realtime.syncPropertiesObserver.unsubscribe(this.onSyncPropertiesChange),this.observers.forEach(t=>t.destroy()),this.observers.clear()};this.onSyncPropertiesChange=t=>{this.logger.log("pubsub service @ onSyncPropertiesChange",{properties:t}),Object.entries(t).forEach(([n,i])=>{this.publishEventToClient(n,i)})};this.logger=new re("@superviz/sdk/pubsub"),this.realtime=t,this.realtime.syncPropertiesObserver.subscribe(this.onSyncPropertiesChange),this.logger.log("PubSub created")}fetchHistory(t){return this.realtime.fetchSyncClientProperty(t)}};var to=class extends yn{constructor(){super();this.publish=(n,i)=>{this.pubsub.publish(n,i)};this.subscribe=(n,i)=>{this.pubsub.subscribe(n,i)};this.unsubscribe=(n,i)=>{this.pubsub.unsubscribe(n,i)};this.name="realtime",this.logger=new re("@superviz/sdk/realtime-component")}destroy(){this.logger.log("destroyed"),this.pubsub.destroy()}start(){this.logger.log("started"),this.pubsub=new ks(this.realtime)}fetchHistory(n){return this.pubsub.fetchHistory(n)}};k();var el=Pn(Uu());k();var Gs=(i=>(i.HOST="host",i.GUEST="guest",i.AUDIENCE="audience",i))(Gs||{});k();function NT(s,t){return Lt(this,null,function*(){try{return(yield ve.validateApiKey(s,t))===!0}catch(n){if(n.status===404)return!1;throw new Error("Unable to validate API key")}})}var zh=NT;k();k();var ei=class{static getRemoteConfig(){return Lt(this,arguments,function*(t="prod"){let{version:n}=yield Promise.resolve().then(()=>(Vh(),$h));if(t==="local"){let{remoteConfig:l}=yield Promise.resolve().then(()=>(Kh(),jh));return l}let i={version:n,environment:t},o=this.createUrl(i);return Re(o,"GET",null)})}static createUrl({version:t,environment:n}){return`${this.REMOTE_CONFIG_BASE_URL}/${t}?env=${n}`}};ei.REMOTE_CONFIG_BASE_URL="https://remote-config.superviz.com/sdk";k();var Xu=Pn(Ls());k();var eo=class{constructor(){this.observers=new Map;this.subscribe=(t,n)=>{this.logger.log("event bus service @ subscribe",{event:t,callback:n}),this.observers.has(t)||this.observers.set(t,new xt),this.observers.get(t).subscribe(n)};this.unsubscribe=(t,n)=>{this.logger.log("event bus service @ unsubscribe",{event:t,callback:n}),this.observers.has(t)&&(this.observers.get(t).reset(),this.observers.delete(t))};this.publish=(t,n)=>{this.logger.log("event bus service @ publish",{event:t,data:n}),this.observers.has(t)&&this.observers.get(t).publish(n)};this.logger=new re("@superviz/sdk/event-bus"),this.logger.log("event bus created")}};k();var no=class{static checkComponentLimit(t){var o;let n=(o=zu[t])!=null?o:t,i=Ot.get("limits");return!0}};k();k();var Qu=Pn(Jh()),ro=Pn(Hu());k();var Ju=(f=>(f[f.DISCONNECTED=0]="DISCONNECTED",f[f.INITIALIZING=1]="INITIALIZING",f[f.READY_TO_JOIN=2]="READY_TO_JOIN",f[f.CONNECTING=3]="CONNECTING",f[f.CONNECTED=4]="CONNECTED",f[f.JOINED=5]="JOINED",f[f.FAILED=-1]="FAILED",f[f.RETRYING=-2]="RETRYING",f))(Ju||{});k();k();var Zu=(S=>(S[S.yellow=0]="yellow",S[S.turquoise=1]="turquoise",S[S.orange=2]="orange",S[S.blue=3]="blue",S[S.pink=4]="pink",S[S.purple=5]="purple",S[S.green=6]="green",S[S.red=7]="red",S[S.bluedark=8]="bluedark",S[S.pinklight=9]="pinklight",S[S.purplelight=10]="purplelight",S[S.greenlight=11]="greenlight",S[S.orangelight=12]="orangelight",S[S.bluelight=13]="bluelight",S[S.redlight=14]="redlight",S[S.brown=15]="brown",S[S.gray=16]="gray",S))(Zu||{}),qu=(s=>(s[s["#FFEF33"]=0]="#FFEF33",s[s["#31E0B0"]=1]="#31E0B0",s[s["#FF5E10"]=2]="#FF5E10",s[s["#00ABF7"]=3]="#00ABF7",s[s["#FF00BB"]=4]="#FF00BB",s[s["#9C29FF"]=5]="#9C29FF",s[s["#6FDD00"]=6]="#6FDD00",s[s["#E30000"]=7]="#E30000",s[s["#304AFF"]=8]="#304AFF",s[s["#FF89C4"]=9]="#FF89C4",s[s["#D597FF"]=10]="#D597FF",s[s["#C6EC5C"]=11]="#C6EC5C",s[s["#FFA115"]=12]="#FFA115",s[s["#75DEFE"]=13]="#75DEFE",s[s["#FAA291"]=14]="#FAA291",s[s["#BB813F"]=15]="#BB813F",s[s["#878291"]=16]="#878291",s))(qu||{});var Ws=class{constructor(){this.participantObservers=[],this.logger=new re("@superviz/sdk/realtime-service"),this.participantsObserver=new xt({logger:this.logger}),this.participantJoinedObserver=new xt({logger:this.logger}),this.participantLeaveObserver=new xt({logger:this.logger}),this.syncPropertiesObserver=new xt({logger:this.logger}),this.reconnectObserver=new xt({logger:this.logger}),this.roomInfoUpdatedObserver=new xt({logger:this.logger}),this.roomListUpdatedObserver=new xt({logger:this.logger}),this.hostObserver=new xt({logger:this.logger}),this.hostAvailabilityObserver=new xt({logger:this.logger}),this.realtimeStateObserver=new xt({logger:this.logger}),this.kickAllParticipantsObserver=new xt({logger:this.logger}),this.kickParticipantObserver=new xt({logger:this.logger}),this.authenticationObserver=new xt({logger:this.logger}),this.commentsObserver=new xt({logger:this.logger})}subscribeToParticipantUpdate(t,n){this.participantObservers[t]||(this.participantObservers[t]=new xt({logger:this.logger})),this.participantObservers[t].subscribe(n)}unsubscribeFromParticipantUpdate(t,n){this.participantObservers[t]&&this.participantObservers[t].unsubscribe(n)}getSlotColor(t){let n=t!=null?t:16;return{color:qu[n],name:Zu[n]}}};var BT=1e3*60,kT=6e4,GT=1e4,HT=1e3,Yu=null,ni=class extends Ws{constructor(n,i){super();this.participants={};this.hostParticipantId=null;this.myParticipant=null;this.commentsChannel=null;this.supervizChannel=null;this.clientSyncChannel=null;this.clientRoomStateChannel=null;this.broadcastChannel=null;this.clientRoomState={};this.clientSyncPropertiesQueue={};this.clientSyncPropertiesTimeOut=null;this.isReconnecting=!1;this.isJoinedRoom=!1;this.currentReconnectAttempt=0;this.localRoomProperties=null;this.enableSync=!0;this.isSyncFrozen=!1;this.left=!1;this.state=0;this.setHost=n=>{if(!n)return;let i=this.participants[n];this.updateRoomProperties({hostClientId:i.clientId})};this.setKickParticipant=n=>{if(!n)return;let i=this.participants[n];this.updateRoomProperties({kickParticipant:i})};this.freezeSync=n=>{var i,o;if(this.isSyncFrozen=n,n){this.supervizChannel.detach(),this.clientSyncChannel.detach(),(i=this.broadcastChannel)==null||i.detach(),this.supervizChannel.unsubscribe(),this.clientSyncChannel.unsubscribe(),(o=this.broadcastChannel)==null||o.unsubscribe();return}this.join()};this.setParticipantData=n=>{this.myParticipant.data=Object.assign({},this.myParticipant.data,n)};this.publishClientSyncProperties=()=>{this.state===4&&(Object.keys(this.clientSyncPropertiesQueue).forEach(n=>{let i=this.clientSyncPropertiesQueue[n];this.clientSyncPropertiesQueue[n]=[],i.length&&this.clientSyncChannel.publish(n,i)}),clearTimeout(this.clientSyncPropertiesTimeOut),this.clientSyncPropertiesTimeOut=null)};this.saveClientRoomState=(n,i)=>Lt(this,null,function*(){let o=yield this.fetchSyncClientProperty();this.clientRoomState=Object.assign({},o,{[n]:i[i.length-1]}),this.clientRoomStateChannel.publish("update",this.clientRoomState),this.logger.log("REALTIME","setting new room state backup",this.clientRoomState)});this.updateLocalRoomState=n=>Lt(this,null,function*(){this.localRoomProperties=Object.assign({},this.localRoomProperties,n),this.roomInfoUpdatedObserver.publish(this.localRoomProperties),n.hostClientId?(n==null?void 0:n.hostClientId)!==this.hostParticipantId&&this.updateHostInfo(n.hostClientId):(this.hostParticipantId=null,this.hostPassingHandle()),this.updateParticipants(),n.kickParticipant&&n.kickParticipant.clientId===this.myParticipant.clientId&&(this.updateRoomProperties({kickParticipant:null}),this.kickParticipantObserver.publish(this.myParticipant.clientId))});this.updateMyProperties=(0,ro.default)((n={})=>{let i=n;if(!(this.isMessageTooBig(i)||this.left||!this.enableSync||this.isSyncFrozen)&&(i.avatar===void 0&&delete i.avatar,this.myParticipant.data=dt(dt({},this.myParticipant.data),i),!!this.isJoinedRoom))return this.supervizChannel.presence.update(this.myParticipant.data)},HT);this.updateRoomProperties=n=>{if(this.isMessageTooBig(n)||this.isSyncFrozen||this.left)return;let i=dt(dt({},this.localRoomProperties),n);this.supervizChannel.publish("update",i)};this.updateParticipants=()=>{let n={};this.supervizChannel.presence.get((i,o)=>{o.forEach(l=>{n[l.clientId]=dt({},l)}),this.participants=n,this.participantsObserver.publish(this.participants)})};this.updateHostInfo=n=>{let i=[];if(this.supervizChannel.presence.get((l,c)=>{c.forEach(u=>{l||i.push(u.clientId)})}),!n||!i.includes(n)){this.hostPassingHandle();return}Yu&&(clearTimeout(Yu),this.hostAvailabilityObserver.publish(!0));let o=this.hostParticipantId;this.hostParticipantId=n,this.hostObserver.publish({oldHostParticipantId:o,newHostParticipantId:this.hostParticipantId}),this.logger.log("REALTIME",`Master participant has been changed. New Master Participant: ${this.hostParticipantId}`)};this.initializeRoomProperties=()=>{var i;let n={isGridModeEnable:!1,hostClientId:null,followParticipantId:null,gather:!1,drawing:null};((i=this.myParticipant)==null?void 0:i.data.type)==="host"&&(n.hostClientId=this.myParticipant.data.participantId),this.updateParticipants(),this.updateRoomProperties(n)};this.hostPassingHandle=(0,ro.default)(()=>Lt(this,null,function*(){this.localRoomProperties=yield this.fetchRoomProperties(),this.supervizChannel.presence.get((n,i)=>{let o=i.filter(c=>c.data.type==="host").map(c=>c.clientId);if(this.shouldKickParticipantsOnHostLeave&&o.length===0){this.hostAvailabilityObserver.publish(!1),Yu=setTimeout(()=>{this.kickAllParticipantsObserver.publish(!0)},BT);return}let l=o[0];l===this.localParticipantId&&this.setHost(l)})}),1e3);this.findSlotIndex=n=>{let i=n,o=Array.apply(null,{length:15}).map(Number.call,Number);if(this.supervizChannel.presence.get((u,f)=>{if(u){o=[];return}f.forEach(m=>{m.connectionId===i.connectionId&&(i=m),m.connectionId!==i.connectionId&&m.data.hasOwnProperty("slotIndex")&&o.splice(o.indexOf(m.data.slotIndex),1)})}),o.length===0)return;let l=o[0];this.myParticipant.data.slotIndex=l,this.updateMyProperties({slotIndex:l});let c=Math.floor(Math.random()*500);setTimeout(()=>{this.confirmSlot(i)},c)};this.confirmSlot=(0,ro.default)(n=>Lt(this,null,function*(){let i=[],o=n;if(this.supervizChannel.presence.get((l,c)=>{c.forEach(u=>{u.connectionId===o.connectionId&&(o=u),u.connectionId!==o.connectionId&&u.data.slotIndex!==void 0&&i.push(u.data.slotIndex)})}),this.myParticipant.data.slotIndex===void 0||i.includes(this.myParticipant.data.slotIndex))this.findSlotIndex(o);else{let l=yield this.fetchRoomProperties();this.updateRoomProperties(l)}}),1e3);this.onParticipantJoin=n=>{this.updateParticipants(),this.participantJoinedObserver.publish(n),this.updateMyProperties()};this.syncBroadcast=(0,ro.default)(()=>{let n=btoa(this.ablyKey),i=`https://rest.ably.io/channels/${this.roomId.toLowerCase()}/presence`;fetch(i,{headers:{Authorization:`Basic ${n}`}}).then(o=>o.json()).then(o=>{this.broadcastChannel.publish("update",o)})},1e3);this.isMessageTooBig=(n,i=kT)=>{let o=JSON.stringify(n);return new TextEncoder().encode(o).length>i?(this.logger.log("Message too long, the message limit size is 60kb."),!0):!1};this.onCommentsChannelUpdate=n=>{this.logger.log("REALTIME","Comments channel update",n),this.commentsObserver.publish(n.data)};this.updateComments=n=>{this.commentsChannel.publish("update",n)};this.ablyKey=i,this.apiUrl=n,this.onAblyPresenceEnter=this.onAblyPresenceEnter.bind(this),this.onAblyPresenceUpdate=this.onAblyPresenceUpdate.bind(this),this.onAblyPresenceLeave=this.onAblyPresenceLeave.bind(this),this.onAblyRoomUpdate=this.onAblyRoomUpdate.bind(this),this.onClientSyncChannelUpdate=this.onClientSyncChannelUpdate.bind(this),this.onAblyChannelStateChange=this.onAblyChannelStateChange.bind(this),this.onAblyConnectionStateChange=this.onAblyConnectionStateChange.bind(this),this.onReceiveBroadcastSync=this.onReceiveBroadcastSync.bind(this),this.getParticipantSlot=this.getParticipantSlot.bind(this),this.auth=this.auth.bind(this)}get roomProperties(){return this.localRoomProperties}get hostClientId(){var n;return(n=this.roomProperties)==null?void 0:n.hostClientId}get isLocalParticipantHost(){return this.hostClientId===this.localParticipantId}get getParticipants(){return this.participants}get participant(){return this.myParticipant}get localParticipantId(){var n,i;return(i=(n=this.myParticipant.data)==null?void 0:n.participantId)!=null?i:null}get isBroadcast(){return Object.values(this.participants).some(n=>n.data.type==="audience")}start({participant:n,roomId:i,apiKey:o,shouldKickParticipantsOnHostLeave:l}){this.myParticipant={data:oe(dt({},n),{participantId:n.id}),timestamp:null,action:null,clientId:n.id,connectionId:null,encoding:null,id:null},this.enableSync=n.type!=="audience",this.roomId=`superviz:${i.toLowerCase()}-${o}`,this.shouldKickParticipantsOnHostLeave=l,this.apiKey=o,this.client||this.buildClient()}auth(n,i){let o=new Qu.default.Rest({key:this.ablyKey}),{origin:l}=window.location;o.auth.requestToken(n,{authUrl:`${this.apiUrl}/realtime/auth`,key:this.ablyKey,authParams:{domain:l,apiKey:this.apiKey}},(c,u)=>{c&&this.authenticationObserver.publish("realtime.authentication-failed"),i(c,u)})}join(n){let i=n?Object.assign({},n,{participantId:n.id}):this.myParticipant.data;this.logger.log("REALTIME",`Entering room. Room ID: ${this.roomId}`),this.updateMyProperties(i),this.clientSyncChannel=this.client.channels.get(`${this.roomId}:client-sync`),this.clientSyncChannel.subscribe(this.onClientSyncChannelUpdate),this.clientRoomStateChannel=this.client.channels.get(`${this.roomId}:client-state`),this.broadcastChannel=this.client.channels.get(`${this.roomId}:broadcast`),this.enableSync||this.broadcastChannel.subscribe("update",this.onReceiveBroadcastSync),this.supervizChannel=this.client.channels.get(this.roomId),this.supervizChannel.on(this.onAblyChannelStateChange),this.supervizChannel.subscribe("update",this.onAblyRoomUpdate),this.commentsChannel=this.client.channels.get(`${this.roomId}:comments`),this.commentsChannel.subscribe("update",this.onCommentsChannelUpdate),this.supervizChannel.presence.subscribe("enter",this.onAblyPresenceEnter),this.enableSync&&this.supervizChannel.presence.subscribe("update",this.onAblyPresenceUpdate),this.supervizChannel.presence.subscribe("leave",this.onAblyPresenceLeave),this.supervizChannel.presence.enter(this.myParticipant.data)}leave(){this.logger.log("REALTIME","Disconnecting from ably servers"),this.client.close(),this.isJoinedRoom=!1,this.isReconnecting=!1,this.roomId=null,this.participants={},this.hostParticipantId=null,this.myParticipant=null,this.supervizChannel=null,this.clientSyncChannel=null,this.client=null,this.left=!0}setGridMode(n){let i=this.localRoomProperties;this.updateRoomProperties(Object.assign({},i,{isGridModeEnable:n}))}setDrawing(n){let i=this.localRoomProperties;this.updateRoomProperties(Object.assign({},i,{drawing:n}))}setTranscript(n){let i=this.localRoomProperties;this.updateRoomProperties(Object.assign({},i,{transcript:n}))}setSyncProperty(n,i){var c;let o=(c=this.clientSyncPropertiesQueue[n])!=null?c:[],l=(u,f)=>({name:u,data:f,participantId:this.myParticipant.data.participantId,timestamp:Date.now()});this.isMessageTooBig(l(n,i),GT)&&(this.logger.log("REALTIME","Message too big, not sending"),this.throw("Message too long, the message limit size is 10kb.")),this.isMessageTooBig(o)&&(this.logger.log("REALTIME","Message queue too big, publishing"),this.publishClientSyncProperties()),this.logger.log("adding to queue",n,i),this.clientSyncPropertiesQueue[n]||(this.clientSyncPropertiesQueue[n]=[]),this.clientSyncPropertiesQueue[n].push(l(n,i)),this.clientSyncPropertiesTimeOut||(this.clientSyncPropertiesTimeOut=setTimeout(()=>{this.publishClientSyncProperties()},1e3))}setFollowParticipant(n){this.updateRoomProperties({followParticipantId:n})}setGather(n){this.updateRoomProperties({gather:n})}getParticipantSlot(n){var i,o;if(n){let l=n.toString();if(this.participants&&this.participants[l])return(o=(i=this.participants[n])==null?void 0:i.data)==null?void 0:o.slotIndex}return 16}onAblyPresenceEnter(n){n.clientId===this.myParticipant.data.participantId?this.onJoinRoom(n):this.onParticipantJoin(n)}onAblyPresenceUpdate(n){if(!this.isJoinedRoom)return;let{clientId:i}=n,o=Object.assign({},n,{participantId:n.clientId});this.publishParticipantUpdate(o),this.participants&&this.participants[i]&&this.hostParticipantId===this.localParticipantId&&this.isBroadcast&&this.syncBroadcast()}onAblyPresenceLeave(n){this.onParticipantLeave(n)}onClientSyncChannelUpdate(n){let{name:i,data:o}=n,l={};l[i]=o,this.syncPropertiesObserver.publish(l),this.isLocalParticipantHost&&this.saveClientRoomState(i,o)}onReceiveBroadcastSync(n){n.data.forEach(o=>{var c;let l=o.clientId;this.participants[l]=o,(c=o.data)!=null&&c.isAudience||(this.participants[l].data=JSON.parse(this.participants[l].data),this.publishParticipantUpdate(this.participants[l]))})}onAblyRoomUpdate(n){this.updateLocalRoomState(n.data)}buildClient(){this.client&&this.throw("Tried to call buildClient@Ably is already initialized");let n={key:this.ablyKey,disconnectedRetryTimeout:5e3,suspendedRetryTimeout:5e3,clientId:this.myParticipant.data.participantId,authCallback:this.auth};this.client=new Qu.default.Realtime(n),this.client.connection.on(this.onAblyConnectionStateChange)}publishParticipantUpdate(n){this.participants[n.clientId]=n,this.participantsObserver.publish(this.participants),this.participantObservers[n.clientId]&&this.participantObservers[n.clientId].publish(n)}forceReconnect(){if(this.logger.log("REALTIME",`RECONNECT: Starting force realtime reconnect | Current attempt: ${this.currentReconnectAttempt}`),this.roomId||this.throw("Tried to reconnect without roomId set"),this.state===2){this.logger.log("REALTIME","Rejoining room since client already connected to ably servers."),this.join();return}this.logger.log("REALTIME","RECONNECT: Restarting ably server since participant lost connection."),this.buildClient(),this.updateMyProperties(this.myParticipant.data)}throw(n){throw this.logger.log(n),new Error(n)}publishStateUpdate(n){this.state!==n&&(this.state=n,this.logger.log("REALTIME",`Realtime state did change. New state: ${Ju[this.state]}`),this.realtimeStateObserver.publish(this.state))}fetchRoomProperties(){return new Promise((n,i)=>{this.supervizChannel.history((o,l)=>{var u;o&&i(o);let c=(u=l.items[0])==null?void 0:u.data;n(c||null)})})}fetchSyncClientProperty(n){return Lt(this,null,function*(){try{let i=yield new Promise((o,l)=>{this.clientRoomStateChannel.history((c,u)=>{var m;c&&l(c);let f=(m=u==null?void 0:u.items[0])==null?void 0:m.data;o(f||null)})});if(n&&!i[n])throw new Error(`Event ${n} not found in the history`);return n?i[n]:i}catch(i){this.logger.log("REALTIME","Error in fetch client realtime data",i.message),this.throw(i.message)}})}onStateChange(){var E,O,d;let n=(E=this.supervizChannelState)==null?void 0:E.current,i=(O=this.connectionState)==null?void 0:O.current,o=i==="connected",l=["initialized","connecting"].includes(i),c=["closed","closing"].includes(i)||["detaching","detached"].includes(n),u={[0]:c,[1]:l,[2]:!n&&o,[3]:n==="attaching",[4]:n==="attached"&&o,[-1]:n==="failed"||i==="failed",[-2]:i==="suspended"||n==="suspended"},f=Object.entries(u).find(([A,I])=>I&&A)[0],m=Number(f);if(m===2&&(this.currentReconnectAttempt=0),o&&this.isReconnecting&&this.onJoinRoom(this.participant),(m===-2||m===-1)&&this.forceReconnect(),(d=this.connectionState)!=null&&d.retryIn){this.currentReconnectAttempt++,this.isReconnecting=!0,this.publishStateUpdate(-2),this.reconnectObserver.publish(this.currentReconnectAttempt);return}this.publishStateUpdate(m)}onAblyConnectionStateChange(n){this.connectionState=n,this.onStateChange()}onAblyChannelStateChange(n){this.supervizChannelState=n,this.onStateChange()}onJoinRoom(n){return Lt(this,null,function*(){var i;if(this.isJoinedRoom=!0,this.localRoomProperties=yield this.fetchRoomProperties(),this.enableSync&&this.findSlotIndex(n),!this.localRoomProperties)this.initializeRoomProperties();else{this.updateParticipants();let o=this.myParticipant.data.type==="host";(i=this.localRoomProperties)!=null&&i.hostClientId?yield this.updateHostInfo(this.localRoomProperties.hostClientId):o&&(yield this.setHost(this.myParticipant.data.participantId)),this.localRoomProperties=yield this.fetchRoomProperties(),this.updateLocalRoomState(this.localRoomProperties)}this.isReconnecting=!1,this.publishStateUpdate(4),this.participantJoinedObserver.publish(n),this.logger.log("REALTIME","Joined realtime room")})}onParticipantLeave(n){if(this.state===2)return;let i=n.data.participantId===this.hostParticipantId;n.data.participantId===this.localRoomProperties.followParticipantId&&this.setFollowParticipant(),this.participantLeaveObserver.publish(n),i&&this.onHostLeft(),this.updateParticipants()}onHostLeft(){this.updateRoomProperties({hostClientId:null})}};k();var tl=class extends hr{constructor({participant:n,group:i,shouldKickParticipantsOnHostLeave:o}){super();this.eventBus=new eo;this.participants=[];this.addComponent=n=>{var o,l,c;if(!no.checkComponentLimit(n.name)){let u=`You reached the limit usage of ${n.name}`;this.logger.log(u);return}n.attach({localParticipant:this.participant,realtime:this.realtime,group:this.group,config:Ot.configuration,eventBus:this.eventBus}),ve.sendActivity(this.participant.id,this.group.id,this.group.name,n.name),ve.createOrUpdateParticipant(Ot.get("apiKey"),{name:(l=(o=this.participant)==null?void 0:o.name)!=null?l:"Anonymous",participantId:(c=this.participant)==null?void 0:c.id})};this.removeComponent=n=>{n.detach()};this.startRealtime=()=>{this.logger.log("launcher service @ startRealtime"),this.realtime.start({participant:this.participant,apiKey:Ot.get("apiKey"),roomId:Ot.get("roomId"),shouldKickParticipantsOnHostLeave:this.shouldKickParticipantsOnHostLeave}),this.realtime.join(),this.subscribeToRealtimeEvents()};this.subscribeToRealtimeEvents=()=>{this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.participantLeaveObserver.subscribe(this.onParticipantLeave),this.realtime.participantsObserver.subscribe(this.onParticipantListUpdate),this.realtime.hostObserver.subscribe(this.onHostParticipantDidChange),this.realtime.hostAvailabilityObserver.subscribe(this.onHostAvailabilityChange)};this.onParticipantListUpdate=n=>{this.logger.log("launcher service @ onParticipantListUpdate");let i=Object.values(n).map(l=>{var c,u,f,m,E;return{id:l.data.id,name:(c=l.data)==null?void 0:c.name,type:(u=l.data)==null?void 0:u.type,avatar:(f=l.data)==null?void 0:f.avatar,avatarConfig:(m=l.data)==null?void 0:m.avatarConfig,isHost:this.realtime.hostClientId===l.clientId,color:this.realtime.getSlotColor((E=l.data)==null?void 0:E.slotIndex).color}}),o=i.find(l=>{var c;return(l==null?void 0:l.id)===((c=this.participant)==null?void 0:c.id)});(0,Xu.isEqual)(this.participants,i)||(this.participants=i,this.publish("participant.list-updated",i),this.logger.log("Publishing ParticipantEvent.LIST_UPDATED",i)),o&&!(0,Xu.isEqual)(this.participant,o)&&(this.participant=o,this.publish("participant.updated",o),this.logger.log("Publishing ParticipantEvent.UPDATED",o))};this.onParticipantJoined=n=>{this.logger.log("launcher service @ onParticipantJoined");let i=this.participants.find(o=>o.id===n.data.id);!i||(i.id===this.participant.id&&(this.logger.log("launcher service @ onParticipantJoined - local participant joined"),this.publish("participant.local-joined",i)),this.logger.log("launcher service @ onParticipantJoined - participant joined",i),this.publish("participant.joined",i))};this.onParticipantLeave=n=>{this.logger.log("launcher service @ onParticipantLeave");let i=this.participants.find(o=>o.id===n.data.id);!i||(i.id===this.participant.id&&(this.logger.log("launcher service @ onParticipantLeave - local participant left"),this.publish("participant.local-left",i)),this.logger.log("launcher service @ onParticipantLeave - participant left",i),this.publish("participant.left",i))};this.onHostParticipantDidChange=n=>{let i=this.participants.find(o=>o.id===(n==null?void 0:n.newHostParticipantId));this.realtime.isLocalParticipantHost&&(this.realtime.setSyncProperty("realtime.host-change",i),this.publish("realtime.host-change",i))};this.onHostAvailabilityChange=n=>{if(this.logger.log("launcher service @ onHostAvailabilityChange"),n){this.publish("realtime.host-available");return}this.publish("realtime.no-host-available")};this.shouldKickParticipantsOnHostLeave=o!=null?o:!0,this.participant=n,this.group=i,this.logger=new re("@superviz/sdk/launcher"),this.realtime=new ni(Ot.get("apiUrl"),Ot.get("ablyKey")),this.eventBus=new eo,this.logger.log("launcher created"),this.startRealtime()}},Zh=s=>{let t=new tl(s);return{subscribe:t.subscribe,unsubscribe:t.unsubscribe,addComponent:t.addComponent,removeComponent:t.removeComponent}};var WT=({group:s,participant:t,roomId:n})=>{if(!s||!s.name||!s.id)throw new Error("Group fields is required");if(!t||!t.id||!t.name)throw new Error("Participant name and id is required");if(!n)throw new Error("Room id is required")},zT=(s,t)=>Lt(void 0,null,function*(){if(!(s&&s.trim()))throw new Error("API key is required");if(!t)throw new Error("Options is required");WT(t),t.debug?el.debug.enable("*"):el.debug.disable();let{apiUrl:i,conferenceLayerUrl:o}=yield ei.getRemoteConfig(t.environment);if(!(yield zh(i,s)))throw new Error("Failed to validate API key");let c=yield ve.fetchConfig(i,s),u=yield ve.fetchLimits(i,s);if(!c||!c.ablyKey)throw new Error("Failed to load configuration from server");let{ablyKey:f}=c;return Ot.setConfig({apiUrl:i,ablyKey:f,apiKey:s,conferenceLayerUrl:o,environment:c,roomId:t.roomId,debug:t.debug,limits:u}),Zh(Object.assign({},t,{participant:oe(dt({},t.participant),{type:t.participant.type||"guest"})}))}),nl=zT;k();k();k();k();k();var zs=window,$s=zs.ShadowRoot&&(zs.ShadyCSS===void 0||zs.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,rl=Symbol(),qh=new WeakMap,io=class{constructor(t,n,i){if(this._$cssResult$=!0,i!==rl)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o,n=this.t;if($s&&t===void 0){let i=n!==void 0&&n.length===1;i&&(t=qh.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&qh.set(n,t))}return t}toString(){return this.cssText}},Yh=s=>new io(typeof s=="string"?s:s+"",void 0,rl),Rt=(s,...t)=>{let n=s.length===1?s[0]:t.reduce((i,o,l)=>i+(c=>{if(c._$cssResult$===!0)return c.cssText;if(typeof c=="number")return c;throw Error("Value passed to 'css' function must be a 'css' function result: "+c+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+s[l+1],s[0]);return new io(n,s,rl)},il=(s,t)=>{$s?s.adoptedStyleSheets=t.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):t.forEach(n=>{let i=document.createElement("style"),o=zs.litNonce;o!==void 0&&i.setAttribute("nonce",o),i.textContent=n.cssText,s.appendChild(i)})},Vs=$s?s=>s:s=>s instanceof CSSStyleSheet?(t=>{let n="";for(let i of t.cssRules)n+=i.cssText;return Yh(n)})(s):s;var ol,js=window,Qh=js.trustedTypes,$T=Qh?Qh.emptyScript:"",Xh=js.reactiveElementPolyfillSupport,al={toAttribute(s,t){switch(t){case Boolean:s=s?$T:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,t){let n=s;switch(t){case Boolean:n=s!==null;break;case Number:n=s===null?null:Number(s);break;case Object:case Array:try{n=JSON.parse(s)}catch(i){n=null}}return n}},tp=(s,t)=>t!==s&&(t==t||s==s),sl={attribute:!0,type:String,converter:al,reflect:!1,hasChanged:tp},ul="finalized",Ln=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(t)}static get observedAttributes(){this.finalize();let t=[];return this.elementProperties.forEach((n,i)=>{let o=this._$Ep(i,n);o!==void 0&&(this._$Ev.set(o,i),t.push(o))}),t}static createProperty(t,n=sl){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(t,n),!n.noAccessor&&!this.prototype.hasOwnProperty(t)){let i=typeof t=="symbol"?Symbol():"__"+t,o=this.getPropertyDescriptor(t,i,n);o!==void 0&&Object.defineProperty(this.prototype,t,o)}}static getPropertyDescriptor(t,n,i){return{get(){return this[n]},set(o){let l=this[t];this[n]=o,this.requestUpdate(t,l,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||sl}static finalize(){if(this.hasOwnProperty(ul))return!1;this[ul]=!0;let t=Object.getPrototypeOf(this);if(t.finalize(),t.h!==void 0&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){let n=this.properties,i=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(let o of i)this.createProperty(o,n[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){let n=[];if(Array.isArray(t)){let i=new Set(t.flat(1/0).reverse());for(let o of i)n.unshift(Vs(o))}else t!==void 0&&n.push(Vs(t));return n}static _$Ep(t,n){let i=n.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(t=this.constructor.h)===null||t===void 0||t.forEach(n=>n(this))}addController(t){var n,i;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(t),this.renderRoot!==void 0&&this.isConnected&&((i=t.hostConnected)===null||i===void 0||i.call(t))}removeController(t){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var t;let n=(t=this.shadowRoot)!==null&&t!==void 0?t:this.attachShadow(this.constructor.shadowRootOptions);return il(n,this.constructor.elementStyles),n}connectedCallback(){var t;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$ES)===null||t===void 0||t.forEach(n=>{var i;return(i=n.hostConnected)===null||i===void 0?void 0:i.call(n)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$ES)===null||t===void 0||t.forEach(n=>{var i;return(i=n.hostDisconnected)===null||i===void 0?void 0:i.call(n)})}attributeChangedCallback(t,n,i){this._$AK(t,i)}_$EO(t,n,i=sl){var o;let l=this.constructor._$Ep(t,i);if(l!==void 0&&i.reflect===!0){let c=(((o=i.converter)===null||o===void 0?void 0:o.toAttribute)!==void 0?i.converter:al).toAttribute(n,i.type);this._$El=t,c==null?this.removeAttribute(l):this.setAttribute(l,c),this._$El=null}}_$AK(t,n){var i;let o=this.constructor,l=o._$Ev.get(t);if(l!==void 0&&this._$El!==l){let c=o.getPropertyOptions(l),u=typeof c.converter=="function"?{fromAttribute:c.converter}:((i=c.converter)===null||i===void 0?void 0:i.fromAttribute)!==void 0?c.converter:al;this._$El=l,this[l]=u.fromAttribute(n,c.type),this._$El=null}}requestUpdate(t,n,i){let o=!0;t!==void 0&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||tp)(this[t],n)?(this._$AL.has(t)||this._$AL.set(t,n),i.reflect===!0&&this._$El!==t&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(t,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}_$Ej(){return Lt(this,null,function*(){this.isUpdatePending=!0;try{yield this._$E_}catch(n){Promise.reject(n)}let t=this.scheduleUpdate();return t!=null&&(yield t),!this.isUpdatePending})}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((o,l)=>this[l]=o),this._$Ei=void 0);let n=!1,i=this._$AL;try{n=this.shouldUpdate(i),n?(this.willUpdate(i),(t=this._$ES)===null||t===void 0||t.forEach(o=>{var l;return(l=o.hostUpdate)===null||l===void 0?void 0:l.call(o)}),this.update(i)):this._$Ek()}catch(o){throw n=!1,this._$Ek(),o}n&&this._$AE(i)}willUpdate(t){}_$AE(t){var n;(n=this._$ES)===null||n===void 0||n.forEach(i=>{var o;return(o=i.hostUpdated)===null||o===void 0?void 0:o.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){this._$EC!==void 0&&(this._$EC.forEach((n,i)=>this._$EO(i,this[i],n)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}};Ln[ul]=!0,Ln.elementProperties=new Map,Ln.elementStyles=[],Ln.shadowRootOptions={mode:"open"},Xh==null||Xh({ReactiveElement:Ln}),((ol=js.reactiveElementVersions)!==null&&ol!==void 0?ol:js.reactiveElementVersions=[]).push("1.6.2");k();var ll,Ks=window,ri=Ks.trustedTypes,ep=ri?ri.createPolicy("lit-html",{createHTML:s=>s}):void 0,fl="$lit$",Zn=`lit$${(Math.random()+"").slice(9)}$`,up="?"+Zn,VT=`<${up}>`,gr=document,so=()=>gr.createComment(""),ao=s=>s===null||typeof s!="object"&&typeof s!="function",lp=Array.isArray,jT=s=>lp(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",cl=`[ 	
\f\r]`,oo=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,np=/-->/g,rp=/>/g,pr=RegExp(`>|${cl}(?:([^\\s"'>=/]+)(${cl}*=${cl}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ip=/'/g,op=/"/g,cp=/^(?:script|style|textarea|title)$/i,fp=s=>(t,...n)=>({_$litType$:s,strings:t,values:n}),yt=fp(1),$I=fp(2),Dn=Symbol.for("lit-noChange"),Oe=Symbol.for("lit-nothing"),sp=new WeakMap,mr=gr.createTreeWalker(gr,129,null,!1);function dp(s,t){if(!Array.isArray(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return ep!==void 0?ep.createHTML(t):t}var KT=(s,t)=>{let n=s.length-1,i=[],o,l=t===2?"<svg>":"",c=oo;for(let u=0;u<n;u++){let f=s[u],m,E,O=-1,d=0;for(;d<f.length&&(c.lastIndex=d,E=c.exec(f),E!==null);)d=c.lastIndex,c===oo?E[1]==="!--"?c=np:E[1]!==void 0?c=rp:E[2]!==void 0?(cp.test(E[2])&&(o=RegExp("</"+E[2],"g")),c=pr):E[3]!==void 0&&(c=pr):c===pr?E[0]===">"?(c=o!=null?o:oo,O=-1):E[1]===void 0?O=-2:(O=c.lastIndex-E[2].length,m=E[1],c=E[3]===void 0?pr:E[3]==='"'?op:ip):c===op||c===ip?c=pr:c===np||c===rp?c=oo:(c=pr,o=void 0);let A=c===pr&&s[u+1].startsWith("/>")?" ":"";l+=c===oo?f+VT:O>=0?(i.push(m),f.slice(0,O)+fl+f.slice(O)+Zn+A):f+Zn+(O===-2?(i.push(void 0),u):A)}return[dp(s,l+(s[n]||"<?>")+(t===2?"</svg>":"")),i]},vr=class{constructor({strings:t,_$litType$:n},i){let o;this.parts=[];let l=0,c=0,u=t.length-1,f=this.parts,[m,E]=KT(t,n);if(this.el=vr.createElement(m,i),mr.currentNode=this.el.content,n===2){let O=this.el.content,d=O.firstChild;d.remove(),O.append(...d.childNodes)}for(;(o=mr.nextNode())!==null&&f.length<u;){if(o.nodeType===1){if(o.hasAttributes()){let O=[];for(let d of o.getAttributeNames())if(d.endsWith(fl)||d.startsWith(Zn)){let A=E[c++];if(O.push(d),A!==void 0){let I=o.getAttribute(A.toLowerCase()+fl).split(Zn),M=/([.?@])?(.*)/.exec(A);f.push({type:1,index:l,name:M[2],strings:I,ctor:M[1]==="."?hl:M[1]==="?"?pl:M[1]==="@"?ml:oi})}else f.push({type:6,index:l})}for(let d of O)o.removeAttribute(d)}if(cp.test(o.tagName)){let O=o.textContent.split(Zn),d=O.length-1;if(d>0){o.textContent=ri?ri.emptyScript:"";for(let A=0;A<d;A++)o.append(O[A],so()),mr.nextNode(),f.push({type:2,index:++l});o.append(O[d],so())}}}else if(o.nodeType===8)if(o.data===up)f.push({type:2,index:l});else{let O=-1;for(;(O=o.data.indexOf(Zn,O+1))!==-1;)f.push({type:7,index:l}),O+=Zn.length-1}l++}}static createElement(t,n){let i=gr.createElement("template");return i.innerHTML=t,i}};function ii(s,t,n=s,i){var o,l,c,u;if(t===Dn)return t;let f=i!==void 0?(o=n._$Co)===null||o===void 0?void 0:o[i]:n._$Cl,m=ao(t)?void 0:t._$litDirective$;return(f==null?void 0:f.constructor)!==m&&((l=f==null?void 0:f._$AO)===null||l===void 0||l.call(f,!1),m===void 0?f=void 0:(f=new m(s),f._$AT(s,n,i)),i!==void 0?((c=(u=n)._$Co)!==null&&c!==void 0?c:u._$Co=[])[i]=f:n._$Cl=f),f!==void 0&&(t=ii(s,f._$AS(s,t.values),f,i)),t}var dl=class{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var n;let{el:{content:i},parts:o}=this._$AD,l=((n=t==null?void 0:t.creationScope)!==null&&n!==void 0?n:gr).importNode(i,!0);mr.currentNode=l;let c=mr.nextNode(),u=0,f=0,m=o[0];for(;m!==void 0;){if(u===m.index){let E;m.type===2?E=new yr(c,c.nextSibling,this,t):m.type===1?E=new m.ctor(c,m.name,m.strings,this,t):m.type===6&&(E=new gl(c,this,t)),this._$AV.push(E),m=o[++f]}u!==(m==null?void 0:m.index)&&(c=mr.nextNode(),u++)}return mr.currentNode=gr,l}v(t){let n=0;for(let i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,n),n+=i.strings.length-2):i._$AI(t[n])),n++}},yr=class{constructor(t,n,i,o){var l;this.type=2,this._$AH=Oe,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=i,this.options=o,this._$Cp=(l=o==null?void 0:o.isConnected)===null||l===void 0||l}get _$AU(){var t,n;return(n=(t=this._$AM)===null||t===void 0?void 0:t._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let t=this._$AA.parentNode,n=this._$AM;return n!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=ii(this,t,n),ao(t)?t===Oe||t==null||t===""?(this._$AH!==Oe&&this._$AR(),this._$AH=Oe):t!==this._$AH&&t!==Dn&&this._(t):t._$litType$!==void 0?this.g(t):t.nodeType!==void 0?this.$(t):jT(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==Oe&&ao(this._$AH)?this._$AA.nextSibling.data=t:this.$(gr.createTextNode(t)),this._$AH=t}g(t){var n;let{values:i,_$litType$:o}=t,l=typeof o=="number"?this._$AC(t):(o.el===void 0&&(o.el=vr.createElement(dp(o.h,o.h[0]),this.options)),o);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===l)this._$AH.v(i);else{let c=new dl(l,this),u=c.u(this.options);c.v(i),this.$(u),this._$AH=c}}_$AC(t){let n=sp.get(t.strings);return n===void 0&&sp.set(t.strings,n=new vr(t)),n}T(t){lp(this._$AH)||(this._$AH=[],this._$AR());let n=this._$AH,i,o=0;for(let l of t)o===n.length?n.push(i=new yr(this.k(so()),this.k(so()),this,this.options)):i=n[o],i._$AI(l),o++;o<n.length&&(this._$AR(i&&i._$AB.nextSibling,o),n.length=o)}_$AR(t=this._$AA.nextSibling,n){var i;for((i=this._$AP)===null||i===void 0||i.call(this,!1,!0,n);t&&t!==this._$AB;){let o=t.nextSibling;t.remove(),t=o}}setConnected(t){var n;this._$AM===void 0&&(this._$Cp=t,(n=this._$AP)===null||n===void 0||n.call(this,t))}},oi=class{constructor(t,n,i,o,l){this.type=1,this._$AH=Oe,this._$AN=void 0,this.element=t,this.name=n,this._$AM=o,this.options=l,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Oe}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,n=this,i,o){let l=this.strings,c=!1;if(l===void 0)t=ii(this,t,n,0),c=!ao(t)||t!==this._$AH&&t!==Dn,c&&(this._$AH=t);else{let u=t,f,m;for(t=l[0],f=0;f<l.length-1;f++)m=ii(this,u[i+f],n,f),m===Dn&&(m=this._$AH[f]),c||(c=!ao(m)||m!==this._$AH[f]),m===Oe?t=Oe:t!==Oe&&(t+=(m!=null?m:"")+l[f+1]),this._$AH[f]=m}c&&!o&&this.j(t)}j(t){t===Oe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t!=null?t:"")}},hl=class extends oi{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Oe?void 0:t}},JT=ri?ri.emptyScript:"",pl=class extends oi{constructor(){super(...arguments),this.type=4}j(t){t&&t!==Oe?this.element.setAttribute(this.name,JT):this.element.removeAttribute(this.name)}},ml=class extends oi{constructor(t,n,i,o,l){super(t,n,i,o,l),this.type=5}_$AI(t,n=this){var i;if((t=(i=ii(this,t,n,0))!==null&&i!==void 0?i:Oe)===Dn)return;let o=this._$AH,l=t===Oe&&o!==Oe||t.capture!==o.capture||t.once!==o.once||t.passive!==o.passive,c=t!==Oe&&(o===Oe||l);l&&this.element.removeEventListener(this.name,this,o),c&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var n,i;typeof this._$AH=="function"?this._$AH.call((i=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:this.element,t):this._$AH.handleEvent(t)}},gl=class{constructor(t,n,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){ii(this,t)}};var ap=Ks.litHtmlPolyfillSupport;ap==null||ap(vr,yr),((ll=Ks.litHtmlVersions)!==null&&ll!==void 0?ll:Ks.litHtmlVersions=[]).push("2.7.5");var hp=(s,t,n)=>{var i,o;let l=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:t,c=l._$litPart$;if(c===void 0){let u=(o=n==null?void 0:n.renderBefore)!==null&&o!==void 0?o:null;l._$litPart$=c=new yr(t.insertBefore(so(),u),u,void 0,n!=null?n:{})}return c._$AI(s),c};k();var vl,yl;var Mt=class extends Ln{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,n;let i=super.createRenderRoot();return(t=(n=this.renderOptions).renderBefore)!==null&&t!==void 0||(n.renderBefore=i.firstChild),i}update(t){let n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=hp(n,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!1)}render(){return Dn}};Mt.finalized=!0,Mt._$litElement$=!0,(vl=globalThis.litElementHydrateSupport)===null||vl===void 0||vl.call(globalThis,{LitElement:Mt});var pp=globalThis.litElementPolyfillSupport;pp==null||pp({LitElement:Mt});((yl=globalThis.litElementVersions)!==null&&yl!==void 0?yl:globalThis.litElementVersions=[]).push("3.3.2");k();k();k();var Wt=s=>t=>typeof t=="function"?((n,i)=>(customElements.define(n,i),i))(s,t):((n,i)=>{let{kind:o,elements:l}=i;return{kind:o,elements:l,finisher(c){customElements.define(n,c)}}})(s,t);k();k();k();k();k();k();k();k();var bl,yx=((bl=window.HTMLSlotElement)===null||bl===void 0?void 0:bl.prototype.assignedElements)!=null?(s,t)=>s.assignedElements(t):(s,t)=>s.assignedNodes(t).filter(n=>n.nodeType===Node.ELEMENT_NODE);k();var br=class extends Mt{render(){return yt` <div>Hello from SuperViz, ${this.name}</div> `}};br.properties={name:{type:String}},br.styles=Rt`
    div {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: black;
      color: white;
    }
  `,br=Ht([Wt("superviz-hello-world")],br);k();k();k();k();var El=Rt`
  * {
    --sv-primary: 98, 16, 204;
    --sv-primary-900: 56, 7, 136;
    --sv-primary-200: 193, 161, 234;
    --sv-secondary: 193, 251, 223;
    --sv-gray: 126, 122, 136;
    --sv-success: 12, 185, 71;
    --sv-danger: 229, 65, 30;
    --sv-black: 19, 18, 21;
    --sv-white: 255, 255, 255;
    --sv-gray-100: 250, 250, 252;
    --sv-gray-200: 233, 229, 239;
    --sv-gray-300: 201, 196, 209;
    --sv-gray-400: 174, 169, 184;
    --sv-gray-500: 126, 122, 136;
    --sv-gray-600: 87, 83, 95;
    --sv-gray-700: 57, 54, 62;
    --sv-gray-800: 38, 36, 42;
  }

  .sv-gray-200 {
    color: rgb(var(--sv-gray-200));
  }

  .sv-gray-400 {
    color: rgb(var(--sv-gray-400));
  }

  .sv-gray-500 {
    color: rgb(var(--sv-gray-500));
  }

  .sv-gray-600 {
    color: rgb(var(--sv-gray-600));
  }

  .sv-gray-700 {
    color: rgb(var(--sv-gray-700));
  }
`;k();var Al=Rt`
  .text {
    font-family: Roboto;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .text-bold {
    font-weight: 700;
  }

  .text-big {
    font-size: 14px;
  }

  .text-small {
    font-size: 10px;
  }
`;k();var Sl=Rt`
  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-200));
    padding: 0px;
    margin: 0px;
    position: relative;
  }
`;k();var Tl=Rt`
  .icon-button {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(0, 0, 0, 0);
    border: 0px;
    width: 32px;
    height: 32px;
  }

  .icon-button > superviz-icon {
    display: flex !important;
  }

  .icon-button--xsmall {
    width: 18px;
    height: 18px;
  }

  .icon-button--small {
    width: 24px;
    height: 24px;
  }

  .icon-button--medium {
    width: 32px;
    height: 32px;
  }

  .icon-button--large {
    width: 40px;
    height: 40px;
  }

  .icon-button--clickable {
    cursor: pointer;
    border-radius: 100%;
  }

  .icon-button--clickable:hover:not(.icon-button--no-hover) {
    background: rgb(var(--sv-gray-300));
  }

  .icon-button--clickable:focus:not(.icon-button--no-hover) {
    background: rgb(var(--sv-gray-300));
  }
`;var $t=s=>{var n;class t extends s{connectedCallback(){setTimeout(()=>{var c;let o=document.getElementById("superviz-style"),l=document.createElement("style");l.innerHTML=(o==null?void 0:o.innerHTML)||"",(c=this.shadowRoot)==null||c.appendChild(l)}),super.connectedCallback()}emitEvent(o,l,c={composed:!0,bubbles:!0}){let u=new CustomEvent(o,dt({detail:l},c));this.dispatchEvent(u)}}return t.styles=[El,Al,Sl,Tl,(n=s.styles)!=null?n:[]],t};var mp=$t(Mt),ZT=[mp.styles],Er=class extends mp{constructor(){super();this.name="",this.size="md"}render(){return yt` <i class="sv-icon sv-icon-${this.name}_${this.size}"></i> `}};Er.properties={name:{type:String},size:{type:String}},Er.styles=[ZT,Rt`
      div {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: black;
        color: white;
      }
    `],Er=Ht([Wt("superviz-icon")],Er);k();k();k();k();var gp={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},vp=s=>(...t)=>({_$litDirective$:s,values:t}),Js=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,i){this._$Ct=t,this._$AM=n,this._$Ci=i}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}};var Ee=vp(class extends Js{constructor(s){var t;if(super(s),s.type!==gp.ATTRIBUTE||s.name!=="class"||((t=s.strings)===null||t===void 0?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(s){return" "+Object.keys(s).filter(t=>s[t]).join(" ")+" "}update(s,[t]){var n,i;if(this.it===void 0){this.it=new Set,s.strings!==void 0&&(this.nt=new Set(s.strings.join(" ").split(/\s/).filter(l=>l!=="")));for(let l in t)t[l]&&!(!((n=this.nt)===null||n===void 0)&&n.has(l))&&this.it.add(l);return this.render(t)}let o=s.element.classList;this.it.forEach(l=>{l in t||(o.remove(l),this.it.delete(l))});for(let l in t){let c=!!t[l];c===this.it.has(l)||((i=this.nt)===null||i===void 0?void 0:i.has(l))||(c?(o.add(l),this.it.add(l)):(o.remove(l),this.it.delete(l)))}return Dn}});k();var yp=Rt`
  .dropdown {
    position: relative;
  }

  .dropdown-content {
    display: flex;
  }

  .select-clicked {
    border: 2px #26489a solid;
  }

  .dropdown-list {
    position: relative;
  }

  .dropdown-list * {
    box-sizing: border-box;
  }

  .menu {
    list-style: none;
    padding: 0;
    background: #fff;
    color: #9fa5b5;
    opacity: 0;
    display: none;
    transition: 0.2s;
    z-index: 1;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    top: -10px;
    border-radius: 3px;
  }

  .menu--bottom-left {
    min-width: 103px;
    position: absolute;
    left: 100%;
    transform: translateX(-100%);
  }

  .menu--bottom-center {
    min-width: 103px;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }

  .menu--bottom-right {
    min-width: 103px;
    position: absolute;
    left: 26px;
    transform: translateX(-100%);
  }

  .menu li {
    color: rgb(var(--sv-gray-600));
    text-transform: uppercase;
    padding: 10px;
    cursor: pointer;
    min-width: 103px;
    min-height: 32px;
  }

  .active {
    background: rgb(var(--sv-gray-200));
  }

  .menu li:hover {
    background: rgb(var(--sv-gray-200));
  }

  .menu-open {
    display: block;
    opacity: 1;
  }
`;var bp=$t(Mt),qT=[bp.styles,yp],Ar=class extends bp{constructor(){super(...arguments);this.onClickOutDropdown=n=>{if(n.stopPropagation(),!this.open)return;let i=n.composedPath(),o=this.shadowRoot.querySelector(".dropdown-content"),l=this.shadowRoot.querySelector(".dropdown-list"),u=this.shadowRoot.querySelector('slot[name="dropdown"]').assignedElements()[0],f=i.includes(o),m=i.includes(l),E=i.includes(u);f||m||E||(this.open=!1)};this.close=()=>{this.emitEvent("close",{bubbles:!1,composed:!1})};this.callbackSelected=n=>{this.open=!1;let i=this.returnTo?n[this.returnTo]:n;this.emitEvent("selected",i,{bubbles:!1,composed:!1})}}updated(n){n.has("open")&&(this.open&&document.addEventListener("click",this.onClickOutDropdown),this.open||(document.removeEventListener("click",this.onClickOutDropdown),this.close()))}render(){let n={menu:!0,"menu--bottom-left":this.position==="bottom-left","menu--bottom-center":this.position==="bottom-center","menu--bottom-right":this.position==="bottom-right","menu-open":this.open,"menu-left":this.align==="left","menu-right":this.align==="right"},i=this.options.map(l=>{let c={text:!0,"text-bold":!0,active:this.active===(l==null?void 0:l[this.returnTo])};return yt`<li @click=${()=>this.callbackSelected(l)} class=${Ee(c)}>${l[this.label]}</li>`}),o=()=>{this.open=!this.open};return yt`
      <div class="dropdown">
        <div class="dropdown-content" @click=${()=>o()}>
          <slot name="dropdown"></slot>
        </div>
      </div>
      <div class="dropdown-list">
        <ul class=${Ee(n)}>
          ${i}
        </ul>
      </div>
    `}};Ar.styles=qT,Ar.properties={open:{type:Boolean},disabled:{type:Boolean},align:{type:String},position:{type:String},options:{type:Array},label:{type:String},returnTo:{type:String},active:{type:[String,Object]}},Ar=Ht([Wt("superviz-dropdown")],Ar);k();k();var Ep=Rt`
#mouse-container {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
}

#mouse-sync {
  position: absolute;
}

.mouse-board {
  background: transparent;
  position: absolute;
  top: 0;
  cursor: none !important;
}

.mouse-follower {
  position: absolute;
  display: block;
  transition: all 0.4s;
}

.pointer-mouse {
  display: flex;
  height: 17px;
  width: 17px;
  background-image: url(https://production.cdn.superviz.com/static/pointers/0.svg);
}

.mouse-user-name {
  display: block;
  position: absolute;  
  border-radius: 30px;
  padding: 2px 8px;
  font-weight: 700;
  font-size: 14px;
  font-family: 'Open Sans, sans-serif';
  line-height: 22px;
  margin-left: 10px;
  margin-top: -6px;
  background: yellow;
  white-space: nowrap;
}
`;var si=class extends Mt{constructor(){super();this.updatePresenceMouseParticipant=n=>{if(!this.shadowRoot.getElementById(`mouse-${n.id}`)){let u=this.shadowRoot.getElementById("mouse-sync"),f=document.createElement("div");f.setAttribute("id",`mouse-${n.id}`),f.setAttribute("class","mouse-follower");let m=document.createElement("div");m.setAttribute("class","pointer-mouse");let E=document.createElement("div");E.setAttribute("class","mouse-user-name"),E.innerHTML=n.name,f.appendChild(m),f.appendChild(E),u&&u.appendChild(f)}let o=this.shadowRoot.getElementById(`mouse-${n.id}`);if(!o)return;let l=this.shadowRoot.getElementById(`mouse-${n.id}`),c=this.shadowRoot.getElementById(`mouse-${n.id}`);if(l&&c){let u=l.getElementsByClassName("mouse-user-name")[0],f=c.getElementsByClassName("pointer-mouse")[0];f&&(f.style.backgroundImage=`url(https://production.cdn.superviz.com/static/pointers/${n.slotIndex}.svg)`),u&&(u.style.color=this.textColorValues.includes(n.slotIndex)?"#FFFFFF":"#000000",u.style.backgroundColor=n.color,u.innerHTML=n.name);let{containerId:m}=n,E=document.getElementById(m),O=n.mousePositionX,d=n.mousePositionY;if(m){let A=(E==null?void 0:E.clientWidth)||1,I=(E==null?void 0:E.clientHeight)||1;O=n.mousePositionX/n.originalWidth*A,d=n.mousePositionY/n.originalHeight*I}o.style.left=`${O}px`,o.style.top=`${d}px`}};this.textColorValues=[2,4,5,7,8,16]}removePresenceMouseParticipant(n){let i=this.shadowRoot.getElementById(`mouse-${n}`);i&&i.remove()}render(){return yt`
      <div id="mouse-container" class="mouse-board">
        <div id="mouse-sync"></div>
      </div>
    `}};si.styles=[Ep],si=Ht([Wt("superviz-presence-mouse")],si);k();k();k();var Zs=Rt`  
  .modal--overlay {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 3;
    width: 100%;
    height: 100%;
    background: rgba(var(--sv-gray-400), 0.8);
  }

  .modal--container {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 4;
    width: 100%;
    height: 100%;
    background: transparent;
  }

  .modal--container > .modal {
    background: #fff;
    min-width: 370px;
    min-height: 150px;
    border-radius: 6px;
  }

  .modal--container > .modal > .modal--header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 16px;
    background: rgb(var(--sv-gray-200));
    border-radius: 6px 6px 0 0;
  }

  .modal--container > .modal > .modal--header > .text {
    display: flex;
    align-items: center;
  }

  .modal--container > .modal > .modal--header > .close {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: rgb(var(--sv-gray-600));
    cursor: pointer;
  }

  .modal--container > .modal > .modal--body {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px 24px 0 24px;
  }

  .modal--container > .modal > .modal--body > .modal--body-content {
    padding: 8px 0;
    text-align: center;
  }

  .modal--container > .modal > .modal--footer {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    padding: 24px;
  }

  .btn {
    width: 150px;
    height: 40px;
    text-transform: uppercase;
  }

  .btn--confirm {
    background: rgb(var(--sv-primary));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-primary));
    color: #fff;
    cursor: pointer;
  }

  .btn--cancel {
    background: transparent;
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-400));
    color: rgb(var(--sv-gray-400));
    cursor: pointer;
  }
`;var Ap=$t(Mt),YT=[Ap.styles,Zs],ai=class extends Ap{constructor(){super(...arguments);this.getContainer=()=>window.document.querySelector("superviz-modal-container");this.createContainer=n=>{this.modal=document.createElement("superviz-modal-container"),this.modal.setOptions(n)};this.createModal=({detail:n})=>{this.createContainer(n),window.document.body.appendChild(this.modal)};this.destroyModal=()=>{var n;this.modal=void 0,(n=this.getContainer())==null||n.remove()}}firstUpdated(){window.document.body.addEventListener("superviz-modal--open",this.createModal),window.document.body.addEventListener("superviz-modal--close",this.destroyModal)}disconnectedCallback(){this.destroyModal(),window.document.body.removeEventListener("superviz-modal--open",this.createModal),window.document.body.removeEventListener("superviz-modal--close",this.destroyModal)}};ai.styles=YT,ai=Ht([Wt("superviz-modal")],ai);k();var Sp=$t(Mt),QT=[Sp.styles,Zs],ui=class extends Sp{constructor(){super(...arguments);this.closeModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{bubbles:!0,composed:!0}))};this.confirmModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--confirm",{bubbles:!0,composed:!0}))}}setOptions(n){this.options=n}render(){let n=()=>yt`
        <div class="modal--header">
          <span class="text text-bold sv-gray-600">${this.options.title}</span>
          <div class="close" @click=${this.closeModal}>
            <superviz-icon name="close" size="md"></superviz-icon>
          </div>
        </div>
      `,i=()=>yt`
        <div class="modal--body">
          <div class="modal--body-content">
            ${this.options.body}
          </div>
        </div>
      `,o=()=>{if(this.options.footer)return yt`
          <div class="modal--footer">
            ${this.options.footer}
          </div>
        `;let l=this.options.confirmLabel||"OK",c=this.options.cancelLabel||"Cancel";return this.options.confirm&&this.options.cancel?yt`
          <div class="modal--footer">
            <button class="text text-bold btn btn--cancel" @click=${this.closeModal}>${c}</button>
            <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>${l}</button>
          </div>
        `:yt`
        <div class="modal--footer">
          <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>${l}</button>
        </div>
      `};return yt`
      <div class="modal--overlay"></div>
      <div class="modal--container">
        <div class="modal">
          ${n()}

          ${i()}

          ${o()}
        </div>
      </div>
    `}};ui.styles=QT,ui=Ht([Wt("superviz-modal-container")],ui);k();k();k();k();var Cl=Rt`
  .container {
    display: flex;
    flex-direction: column;
    width: 320px;
    position: fixed;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0;
    right: 0;
    bottom: 0;
    box-shadow: -2px 0 4px 0 rgba(0, 0, 0, 0.1);
  }

  .container-close {
    display: none;
  }

  .header {
    width: 100%;
  }

  .content {
    overflow-y: auto;
    overflow-x: hidden;
  }

  .toggle {
    display: flex;
    position: fixed;
    width: 100px;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0;
    right: 0;
    bottom: 0;
  }
`;k();var Ol=Rt`
  div.topbar {
    display: flex;
    justify-content: space-between;
    background-color: rgb(var(--sv-gray-200));
    height: 50px;
  }

  div.topbar span {
    margin: 16px;
    color: rgb(var(--sv-gray-600));
  }
`;k();var wl=Rt`
  .annotations {
    display: flex;
    flex-direction: column;
    background-color: rgb(var(--sv-gray-400));
    min-height: 10px;
    padding: 8px;
  }

  .annotations--add-comment-btn {
    color: rgb(var(--sv-white));
    text-align: center;
    padding: 8px;
  }

  .annotations--comments-input {
    width: 288px;
    padding: 8px;
  }

  .hidden {
    display: none;
  }
`;k();var Il=Rt`
  .reply {
    padding-left: 24px !important;
  }

  .comment-item {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    padding: 8px;
    gap: 4px;
  }

  .comment-item__user {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
    align-items: center;
    color: rgb(var(--sv-gray-500));
  }

  .comment-item__user-details {
    display: flex;
    width: 100%;
    gap: 8px;
    align-items: center;
  }

  .comment-item__avatar {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .comment-item__content {
    width: 100%;
  }

  .line-clamp {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .comment-item__content__body {
    color: rgb(var(--sv-gray-700));
  }

  .hidden {
    display: none;
  }
`;k();var xl=Rt`
  .comments {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 288px;
  }

  .hidden {
    display: none;
  }
`;k();var Rl=Rt`
  .comment-input {
    display: flex;
    flex-direction: column;
    width: 100%;
    background: rgb(var(--sv-white));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-300));
  }

  .comment-input:focus-within {
    border: 1px solid rgb(var(--sv-gray-500));
  }

  .comment-input:focus-within > .sv-hr {
    background: rgb(var(--sv-gray-500))
  }

  #comment-input--textarea {
    all: unset;
    border: 0px;
    border-radius: 4px;
    outline: none;
    height: 13px;
    font-size: 14px;
    color: rgb(var(--sv-gray-700));
    padding: 12px 11px !important;
    font-family: Roboto;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow: hidden;
    resize: none;
    appearance: none;
    width: 90%;
  }

  #comment-input--textarea::placeholder {
    color: rgb(var(--sv-gray-400));
    font-size: 14px;
  }

  .comment-input--options {
    display: flex;
    justify-content: space-between;
    padding: 4px 8px;
  }

  .mention {
    display: none;
  }

  .comment-input--send-btn {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgb(var(--sv-primary));
    border-radius: 100%;
    width: 32px;
    height: 32px;
    color: rgba(var(--sv-white), 1);
    border: 0px;
    cursor: pointer;
  }

  .align-send-btn > superviz-icon {
    margin-right: 2px;
    margin-top: 4px;
  }

  .comment-input--send-btn:disabled {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgb(var(--sv-gray-200));
    border-radius: 100%;
    width: 32px;
    height: 32px;
    color: rgb(var(--sv-gray-400));
    border: 0px;
  }

  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-300));
    padding: 0px;
    margin: 0px;
  }

  .comment-input-options {
    display: flex;
    gap: 4px;
  }
`;k();var Ml=Rt`
  .annotation-item--selected {
    background-color: rgba(var(--sv-gray-200), 0.5);
  }

  .annotation-item:hover:not(.annotation-item--selected) {
    background-color: rgba(var(--sv-gray-200), 0.3);
  }

  .avatars-comments {
    display: flex;
    padding: 8px;
  }

  .avatar-container {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
    height: 18px;
  }

  .avatar {
    position: absolute;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    overflow: hidden;
  }

  .avatar-divs-1 {
    z-index: 4;
    left: 0;
  }

  .avatar-divs-2 {
    z-index: 3;
    left: 16px;
  }

  .avatar-divs-3 {
    z-index: 2;
    left: 32px;
  }

  .avatar-divs-4 {
    z-index: 1;
    left: 48px;
  }

  .avatar-divs-5 {
    z-index: 1;
    left: 60px;
  }

  .replies {
    display: flex;
    justify-content: center;
    align-items: center;
    position: absolute;
    padding-left: 8px;
  }

  .last-reply {
    padding-left: 14px;
  }

  .avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .comments-container {
    display: flex;
    flex-direction: column;
  }

  .comments--expand {
    display: flex;
  }

  .comment-avatar--expand {
    display: block;
  }

  .hidden {
    display: none;
  }

  .annotation-item {
    padding: 8px;
    cursor: pointer;
  }
`;k();var _l=Rt`
  .annotation-resolved {
    background: rgba(var(--sv-gray-200), 0.5);
    height: 26px;
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid rgb(var(--sv-gray-200));
  }
`;k();var Pl=Rt`
  .annotation-pin,
  .annotation-pin__avatar {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .annotation-pin {
    position: absolute;

    width: 32px;
    height: 32px;

    background-color: white;
    border-radius: 50%;
    border-bottom-left-radius: 2px;

    border: 2px solid white;
    box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.25);
    transition: border-color 0.2s ease-in-out;
    padding: 2px;
    cursor: pointer;
  }

  .annotation-pin:hover,
  .annotation-pin:focus,
  .annotation-pin--active {
    border-color: rgb(var(--sv-primary));
  }

  .annotation-pin__avatar {
    width: 100%;
    height: 100%;

    background-color: rgb(var(--sv-gray-400));
    border-radius: 50%;

    color: white;
  }

  .annotation-pin__avatar--add {
    font-size: 24px;
    color: rgb(var(--sv-gray-700));
    background-color: white;
  }

  .annotation-pin__avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;

    object-fit: cover;
  }
`;k();var Ll=Rt`
  .select {
    display: flex;
    width: 100%;
    justify-content: flex-end;
    align-items: center;
  }

  .select-container {
    text-wrap: nowrap;
    padding: 12px;
    cursor: pointer;
    color: rgb(var(--sv-gray-500));
  }

  .content {
    display: flex;
    justify-content: space-between;
    flex-direction: row;
    align-items: center;
    gap: 6px;
  }
`;k();var Dl=Rt`
  button.float-button {
    position: fixed;
    top: 20px;
    left: 20px;

    border-radius: 50%;
    width: 38px;
    height: 38px;

    display: flex;
    justify-content: center;
    align-items: center;
    gap: 4px;
    border: none;

    background-color: white;
    box-shadow: 2px 2px 15px 0px rgba(0, 0, 0, 0.2);
    color: rgb(var(--sv-gray-600));
    transition: all 300ms;
    cursor: pointer;
  }

  button.float-button p {
    display: none;
  }

  button.float-button:hover {
    width: 110px;
    border-radius: 30px;
  }

  button.float-button:hover p {
    display: block;
  }
`;k();var Nl=Rt`
.footer {
  bottom: 5px;
  position: absolute;
  right: 5px;
  font-family: Roboto,sans-serif;
  font-size: 10px;
  line-height: 15px;
  letter-spacing: normal;
}

.link {
  text-decoration: none;
  color: rgb(var(--sv-gray-500));
}

.powered-by {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  width: 140px;
  &--vertical {
    justify-content: flex-end;
  }
  &--horizontal {
    justify-content: center;
  }
}
`;k();function Fl(s){let t=s.querySelector("#superviz-comments");if(t){let n={childList:!0,attributes:!0,characterData:!0,subtree:!0};new MutationObserver((o,l)=>{o.forEach(c=>{let u=s.querySelector("#superviz-comments");u&&u.contains(c.target)&&(l.disconnect(),XT(s))})}).observe(t,n)}}function XT(s){let t=s.querySelector("#poweredby-footer");t&&t.remove();let n=document.createElement("div");n.id="poweredby-footer",n.className="footer";let i=document.createElement("div");i.className="powered-by powered-by--horizontal";let o=document.createElement("a");o.href="https://superviz.com/",o.target="_blank",o.className="link";let l=document.createElement("div");l.textContent="Powered by";let c=document.createElement("img");c.width=48,c.height=8.86,c.src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg",i.appendChild(o),o.appendChild(l),l.appendChild(c),n.appendChild(i);let u=s.getElementById("superviz-comments");u&&u.appendChild(n),Fl(s)}var Tp=$t(Mt),tC=[Tp.styles,Cl,Nl],Sr=class extends Tp{constructor(){super();this.annotations=[],this.annotationFilter="all",this.waterMarkState=!1}updateAnnotations(n){this.annotations=n}toggle(){this.emitEvent("toggle",{})}waterMarkStatus(n){this.waterMarkState=n}setFilter({detail:n}){let{filter:i}=n;this.annotationFilter=i}updated(n){super.updated(n),this.updateComplete.then(()=>{this.shadowRoot.querySelector("#superviz-comments")&&this.waterMarkState&&Fl(this.shadowRoot)})}render(){let n=[this.open?"container":"container-close"].join(" "),i=yt`
    <div id="poweredby-footer" class="footer">
    <div class="powered-by powered-by--horizontal">
      <a href="https://superviz.com/" target="_blank" class="link">
        <div class="">
          Powered by
          <img
            width="48px"
            height="8.86px"
            src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg"
          />
        </div>
      </a>
    </div>
  </div>`,o=this.waterMarkState?i:"";return yt`
      <div id="superviz-comments" class=${n}>
        <div class="header">
          <superviz-comments-topbar @close=${this.toggle}></superviz-comments-topbar>
          <superviz-comments-annotations id="annotations" open=${this.open}>
          </superviz-comments-annotations>
        </div>
        <superviz-comments-annotation-filter
          filter=${this.annotationFilter}
          @select=${this.setFilter}
        >
        </superviz-comments-annotation-filter>
        <superviz-comments-content
          annotations=${JSON.stringify(this.annotations)}
          annotationFilter=${this.annotationFilter}
          class="content"
        ></superviz-comments-content>
      ${o}
      </div>
    `}};Sr.styles=tC,Sr.properties={open:{type:Boolean},annotations:{type:Object},annotationFilter:{type:String},waterMarkState:{type:Boolean}},Sr=Ht([Wt("superviz-comments")],Sr);k();k();var eC=$t(Mt),nC=[eC.styles,Ol],li=class extends $t(Mt){close(){this.dispatchEvent(new CustomEvent("close"))}render(){return yt`
      <div class="topbar">
        <span class="text text-bold">COMMENTS</span>
        <span @click=${this.close}>
          <superviz-icon name="right" size="lg"></superviz-icon>
        </span>
      </div>
    `}};li.styles=nC,li=Ht([Wt("superviz-comments-topbar")],li);k();var Cp=$t(Mt),rC=[Cp.styles,wl],Tr=class extends Cp{constructor(){super(...arguments);this.prepareToCreateAnnotation=i=>Lt(this,[i],function*({detail:n}){this.annotation=n,yield this.updateComplete,this.emitEvent("comment-input-focus",n)})}createComment({detail:n}){this.emitEvent("create-annotation",n),this.annotation=null}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("prepare-to-create-annotation",this.prepareToCreateAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("prepare-to-create-annotation",this.prepareToCreateAnnotation)}render(){let n={"annotations--comments-input":!0,hidden:!this.annotation};return yt`
      <div class="annotations">
        <span class="text text-big text-bold annotations--add-comment-btn"
          >Click anywhere to add a comment</span
        >
        <div class=${Ee(n)}>
          <superviz-comments-comment-input
            @create-annotation=${this.createComment}
            eventType="create-annotation"
          >
          </superviz-comments-comment-input>
        </div>
      </div>
    `}};Tr.styles=rC,Tr.properties={annotation:{type:Object}},Tr=Ht([Wt("superviz-comments-annotations")],Tr);k();var Op=$t(Mt),iC=[Op.styles,xl],Cr=class extends Op{constructor(){super();this.selectAnnotation=({detail:n})=>{let{uuid:i}=n;this.selectedAnnotation=i};this.annotations=[]}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation)}render(){var f,m;let n=(f=this.annotations)==null?void 0:f.filter(E=>E.resolved===!1),i=(m=this.annotations)==null?void 0:m.filter(E=>E.resolved===!0),o=(E,O)=>O?(i==null?void 0:i.length)===E+1:(n==null?void 0:n.length)===E+1,l=(E,O,d)=>{let I=E.comments.length>0?yt`
            <superviz-comments-annotation-item
              annotation=${JSON.stringify(E)}
              selected="${this.selectedAnnotation}"
              ?isLastAnnotation=${o(O,d)}
              annotationFilter=${this.annotationFilter}
            >
            </superviz-comments-annotation-item>
          `:yt``;return yt` ${I} `},c=n==null?void 0:n.map((E,O)=>l(E,O,!1)),u=i==null?void 0:i.map((E,O)=>l(E,O,!0));return yt` ${c} ${u} `}};Cr.styles=iC,Cr.properties={annotations:{type:Object},selectedAnnotation:{type:String},annotationFilter:{type:String}},Cr=Ht([Wt("superviz-comments-content")],Cr);k();k();k();k();k();var Nn=class extends Error{},qs=class extends Nn{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}},Ys=class extends Nn{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}},Qs=class extends Nn{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}},Fn=class extends Nn{},ci=class extends Nn{constructor(t){super(`Invalid unit ${t}`)}},we=class extends Nn{},fn=class extends Nn{constructor(){super("Zone is an abstract class")}};k();k();k();var ht="numeric",dn="short",Je="long",qn={year:ht,month:ht,day:ht},lo={year:ht,month:dn,day:ht},Bl={year:ht,month:dn,day:ht,weekday:dn},co={year:ht,month:Je,day:ht},fo={year:ht,month:Je,day:ht,weekday:Je},ho={hour:ht,minute:ht},po={hour:ht,minute:ht,second:ht},mo={hour:ht,minute:ht,second:ht,timeZoneName:dn},go={hour:ht,minute:ht,second:ht,timeZoneName:Je},vo={hour:ht,minute:ht,hourCycle:"h23"},yo={hour:ht,minute:ht,second:ht,hourCycle:"h23"},bo={hour:ht,minute:ht,second:ht,hourCycle:"h23",timeZoneName:dn},Eo={hour:ht,minute:ht,second:ht,hourCycle:"h23",timeZoneName:Je},Ao={year:ht,month:ht,day:ht,hour:ht,minute:ht},So={year:ht,month:ht,day:ht,hour:ht,minute:ht,second:ht},To={year:ht,month:dn,day:ht,hour:ht,minute:ht},Co={year:ht,month:dn,day:ht,hour:ht,minute:ht,second:ht},kl={year:ht,month:dn,day:ht,weekday:dn,hour:ht,minute:ht},Oo={year:ht,month:Je,day:ht,hour:ht,minute:ht,timeZoneName:dn},wo={year:ht,month:Je,day:ht,hour:ht,minute:ht,second:ht,timeZoneName:dn},Io={year:ht,month:Je,day:ht,weekday:Je,hour:ht,minute:ht,timeZoneName:Je},xo={year:ht,month:Je,day:ht,weekday:Je,hour:ht,minute:ht,second:ht,timeZoneName:Je};k();k();k();k();var Ge=class{get type(){throw new fn}get name(){throw new fn}get ianaName(){return this.name}get isUniversal(){throw new fn}offsetName(t,n){throw new fn}formatOffset(t,n){throw new fn}offset(t){throw new fn}equals(t){throw new fn}get isValid(){throw new fn}};var Gl=null,En=class extends Ge{static get instance(){return Gl===null&&(Gl=new En),Gl}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:n,locale:i}){return ta(t,n,i)}formatOffset(t,n){return Yn(this.offset(t),n)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}};k();var na={};function oC(s){return na[s]||(na[s]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:s,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),na[s]}var sC={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function aC(s,t){let n=s.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,o,l,c,u,f,m,E]=i;return[c,o,l,u,f,m,E]}function uC(s,t){let n=s.formatToParts(t),i=[];for(let o=0;o<n.length;o++){let{type:l,value:c}=n[o],u=sC[l];l==="era"?i[u]=c:Ft(u)||(i[u]=parseInt(c,10))}return i}var ea={},Ae=class extends Ge{static create(t){return ea[t]||(ea[t]=new Ae(t)),ea[t]}static resetCache(){ea={},na={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(n){return!1}}constructor(t){super(),this.zoneName=t,this.valid=Ae.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:n,locale:i}){return ta(t,n,i,this.name)}formatOffset(t,n){return Yn(this.offset(t),n)}offset(t){let n=new Date(t);if(isNaN(n))return NaN;let i=oC(this.name),[o,l,c,u,f,m,E]=i.formatToParts?uC(i,n):aC(i,n);u==="BC"&&(o=-Math.abs(o)+1);let d=fi({year:o,month:l,day:c,hour:f===24?0:f,minute:m,second:E,millisecond:0}),A=+n,I=A%1e3;return A-=I>=0?I:1e3+I,(d-A)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}};k();var wp={};function lC(s,t={}){let n=JSON.stringify([s,t]),i=wp[n];return i||(i=new Intl.ListFormat(s,t),wp[n]=i),i}var Hl={};function Wl(s,t={}){let n=JSON.stringify([s,t]),i=Hl[n];return i||(i=new Intl.DateTimeFormat(s,t),Hl[n]=i),i}var zl={};function cC(s,t={}){let n=JSON.stringify([s,t]),i=zl[n];return i||(i=new Intl.NumberFormat(s,t),zl[n]=i),i}var $l={};function fC(s,t={}){let c=t,{base:n}=c,i=Du(c,["base"]),o=JSON.stringify([s,i]),l=$l[o];return l||(l=new Intl.RelativeTimeFormat(s,t),$l[o]=l),l}var Ro=null;function dC(){return Ro||(Ro=new Intl.DateTimeFormat().resolvedOptions().locale,Ro)}function hC(s){let t=s.indexOf("-x-");t!==-1&&(s=s.substring(0,t));let n=s.indexOf("-u-");if(n===-1)return[s];{let i,o;try{i=Wl(s).resolvedOptions(),o=s}catch(u){let f=s.substring(0,n);i=Wl(f).resolvedOptions(),o=f}let{numberingSystem:l,calendar:c}=i;return[o,l,c]}}function pC(s,t,n){return(n||t)&&(s.includes("-u-")||(s+="-u"),n&&(s+=`-ca-${n}`),t&&(s+=`-nu-${t}`)),s}function mC(s){let t=[];for(let n=1;n<=12;n++){let i=At.utc(2009,n,1);t.push(s(i))}return t}function gC(s){let t=[];for(let n=1;n<=7;n++){let i=At.utc(2016,11,13+n);t.push(s(i))}return t}function ra(s,t,n,i){let o=s.listingMode();return o==="error"?null:o==="en"?n(t):i(t)}function vC(s){return s.numberingSystem&&s.numberingSystem!=="latn"?!1:s.numberingSystem==="latn"||!s.locale||s.locale.startsWith("en")||new Intl.DateTimeFormat(s.intl).resolvedOptions().numberingSystem==="latn"}var Vl=class{constructor(t,n,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;let u=i,{padTo:o,floor:l}=u,c=Du(u,["padTo","floor"]);if(!n||Object.keys(c).length>0){let f=dt({useGrouping:!1},i);i.padTo>0&&(f.minimumIntegerDigits=i.padTo),this.inf=cC(t,f)}}format(t){if(this.inf){let n=this.floor?Math.floor(t):t;return this.inf.format(n)}else{let n=this.floor?Math.floor(t):di(t,3);return le(n,this.padTo)}}},jl=class{constructor(t,n,i){this.opts=i,this.originalZone=void 0;let o;if(this.opts.timeZone)this.dt=t;else if(t.zone.type==="fixed"){let c=-1*(t.offset/60),u=c>=0?`Etc/GMT+${c}`:`Etc/GMT${c}`;t.offset!==0&&Ae.create(u).valid?(o=u,this.dt=t):(o="UTC",this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone)}else t.zone.type==="system"?this.dt=t:t.zone.type==="iana"?(this.dt=t,o=t.zone.name):(o="UTC",this.dt=t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone);let l=dt({},this.opts);l.timeZone=l.timeZone||o,this.dtf=Wl(n,l)}format(){return this.originalZone?this.formatToParts().map(({value:t})=>t).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let t=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?t.map(n=>{if(n.type==="timeZoneName"){let i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return oe(dt({},n),{value:i})}else return n}):t}resolvedOptions(){return this.dtf.resolvedOptions()}},Kl=class{constructor(t,n,i){this.opts=dt({style:"long"},i),!n&&ia()&&(this.rtf=fC(t,i))}format(t,n){return this.rtf?this.rtf.format(t,n):Ip(n,t,this.opts.numeric,this.opts.style!=="long")}formatToParts(t,n){return this.rtf?this.rtf.formatToParts(t,n):[]}},jt=class{static fromOpts(t){return jt.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)}static create(t,n,i,o=!1){let l=t||Yt.defaultLocale,c=l||(o?"en-US":dC()),u=n||Yt.defaultNumberingSystem,f=i||Yt.defaultOutputCalendar;return new jt(c,u,f,l)}static resetCache(){Ro=null,Hl={},zl={},$l={}}static fromObject({locale:t,numberingSystem:n,outputCalendar:i}={}){return jt.create(t,n,i)}constructor(t,n,i,o){let[l,c,u]=hC(t);this.locale=l,this.numberingSystem=n||c||null,this.outputCalendar=i||u||null,this.intl=pC(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=o,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=vC(this)),this.fastNumbersCached}listingMode(){let t=this.isEnglish(),n=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&n?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:jt.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone(oe(dt({},t),{defaultToEN:!0}))}redefaultToSystem(t={}){return this.clone(oe(dt({},t),{defaultToEN:!1}))}months(t,n=!1){return ra(this,t,Jl,()=>{let i=n?{month:t,day:"numeric"}:{month:t},o=n?"format":"standalone";return this.monthsCache[o][t]||(this.monthsCache[o][t]=mC(l=>this.extract(l,i,"month"))),this.monthsCache[o][t]})}weekdays(t,n=!1){return ra(this,t,Zl,()=>{let i=n?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},o=n?"format":"standalone";return this.weekdaysCache[o][t]||(this.weekdaysCache[o][t]=gC(l=>this.extract(l,i,"weekday"))),this.weekdaysCache[o][t]})}meridiems(){return ra(this,void 0,()=>ql,()=>{if(!this.meridiemCache){let t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[At.utc(2016,11,13,9),At.utc(2016,11,13,19)].map(n=>this.extract(n,t,"dayperiod"))}return this.meridiemCache})}eras(t){return ra(this,t,Yl,()=>{let n={era:t};return this.eraCache[t]||(this.eraCache[t]=[At.utc(-40,1,1),At.utc(2017,1,1)].map(i=>this.extract(i,n,"era"))),this.eraCache[t]})}extract(t,n,i){let o=this.dtFormatter(t,n),l=o.formatToParts(),c=l.find(u=>u.type.toLowerCase()===i);return c?c.value:null}numberFormatter(t={}){return new Vl(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,n={}){return new jl(t,this.intl,n)}relFormatter(t={}){return new Kl(this.intl,this.isEnglish(),t)}listFormatter(t={}){return lC(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}};k();k();var Xl=null,ce=class extends Ge{static get utcInstance(){return Xl===null&&(Xl=new ce(0)),Xl}static instance(t){return t===0?ce.utcInstance:new ce(t)}static parseSpecifier(t){if(t){let n=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new ce(Or(n[1],n[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Yn(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Yn(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,n){return Yn(this.fixed,n)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}};k();var hi=class extends Ge{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function hn(s,t){let n;if(Ft(s)||s===null)return t;if(s instanceof Ge)return s;if(xp(s)){let i=s.toLowerCase();return i==="default"?t:i==="local"||i==="system"?En.instance:i==="utc"||i==="gmt"?ce.utcInstance:ce.parseSpecifier(i)||Ae.create(s)}else return An(s)?ce.instance(s):typeof s=="object"&&"offset"in s&&typeof s.offset=="function"?s:new hi(s)}var Rp=()=>Date.now(),Mp="system",_p=null,Pp=null,Lp=null,Dp=60,Np,Yt=class{static get now(){return Rp}static set now(t){Rp=t}static set defaultZone(t){Mp=t}static get defaultZone(){return hn(Mp,En.instance)}static get defaultLocale(){return _p}static set defaultLocale(t){_p=t}static get defaultNumberingSystem(){return Pp}static set defaultNumberingSystem(t){Pp=t}static get defaultOutputCalendar(){return Lp}static set defaultOutputCalendar(t){Lp=t}static get twoDigitCutoffYear(){return Dp}static set twoDigitCutoffYear(t){Dp=t%100}static get throwOnInvalid(){return Np}static set throwOnInvalid(t){Np=t}static resetCaches(){jt.resetCache(),Ae.resetCache()}};function Ft(s){return typeof s=="undefined"}function An(s){return typeof s=="number"}function Mo(s){return typeof s=="number"&&s%1===0}function xp(s){return typeof s=="string"}function Fp(s){return Object.prototype.toString.call(s)==="[object Date]"}function ia(){try{return typeof Intl!="undefined"&&!!Intl.RelativeTimeFormat}catch(s){return!1}}function Up(s){return Array.isArray(s)?s:[s]}function tc(s,t,n){if(s.length!==0)return s.reduce((i,o)=>{let l=[t(o),o];return i&&n(i[0],l[0])===i[0]?i:l},null)[1]}function Bp(s,t){return t.reduce((n,i)=>(n[i]=s[i],n),{})}function Qn(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function Sn(s,t,n){return Mo(s)&&s>=t&&s<=n}function yC(s,t){return s-t*Math.floor(s/t)}function le(s,t=2){let n=s<0,i;return n?i="-"+(""+-s).padStart(t,"0"):i=(""+s).padStart(t,"0"),i}function Un(s){if(!(Ft(s)||s===null||s===""))return parseInt(s,10)}function Xn(s){if(!(Ft(s)||s===null||s===""))return parseFloat(s)}function _o(s){if(!(Ft(s)||s===null||s==="")){let t=parseFloat("0."+s)*1e3;return Math.floor(t)}}function di(s,t,n=!1){let i=Xd(10,t);return(n?Math.trunc:Math.round)(s*i)/i}function wr(s){return s%4===0&&(s%100!==0||s%400===0)}function Ir(s){return wr(s)?366:365}function pi(s,t){let n=yC(t-1,12)+1,i=s+(t-n)/12;return n===2?wr(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function fi(s){let t=Date.UTC(s.year,s.month-1,s.day,s.hour,s.minute,s.second,s.millisecond);return s.year<100&&s.year>=0&&(t=new Date(t),t.setUTCFullYear(s.year,s.month-1,s.day)),+t}function mi(s){let t=(s+Math.floor(s/4)-Math.floor(s/100)+Math.floor(s/400))%7,n=s-1,i=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return t===4||i===3?53:52}function Po(s){return s>99?s:s>Yt.twoDigitCutoffYear?1900+s:2e3+s}function ta(s,t,n,i=null){let o=new Date(s),l={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(l.timeZone=i);let c=dt({timeZoneName:t},l),u=new Intl.DateTimeFormat(n,c).formatToParts(o).find(f=>f.type.toLowerCase()==="timezonename");return u?u.value:null}function Or(s,t){let n=parseInt(s,10);Number.isNaN(n)&&(n=0);let i=parseInt(t,10)||0,o=n<0||Object.is(n,-0)?-i:i;return n*60+o}function ec(s){let t=Number(s);if(typeof s=="boolean"||s===""||Number.isNaN(t))throw new we(`Invalid unit value ${s}`);return t}function gi(s,t){let n={};for(let i in s)if(Qn(s,i)){let o=s[i];if(o==null)continue;n[t(i)]=ec(o)}return n}function Yn(s,t){let n=Math.trunc(Math.abs(s/60)),i=Math.trunc(Math.abs(s%60)),o=s>=0?"+":"-";switch(t){case"short":return`${o}${le(n,2)}:${le(i,2)}`;case"narrow":return`${o}${n}${i>0?`:${i}`:""}`;case"techie":return`${o}${le(n,2)}${le(i,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function Lo(s){return Bp(s,["hour","minute","second","millisecond"])}var bC=["January","February","March","April","May","June","July","August","September","October","November","December"],nc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],EC=["J","F","M","A","M","J","J","A","S","O","N","D"];function Jl(s){switch(s){case"narrow":return[...EC];case"short":return[...nc];case"long":return[...bC];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var rc=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ic=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],AC=["M","T","W","T","F","S","S"];function Zl(s){switch(s){case"narrow":return[...AC];case"short":return[...ic];case"long":return[...rc];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var ql=["AM","PM"],SC=["Before Christ","Anno Domini"],TC=["BC","AD"],CC=["B","A"];function Yl(s){switch(s){case"narrow":return[...CC];case"short":return[...TC];case"long":return[...SC];default:return null}}function kp(s){return ql[s.hour<12?0:1]}function Gp(s,t){return Zl(t)[s.weekday-1]}function Hp(s,t){return Jl(t)[s.month-1]}function Wp(s,t){return Yl(t)[s.year<0?0:1]}function Ip(s,t,n="always",i=!1){let o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},l=["hours","minutes","seconds"].indexOf(s)===-1;if(n==="auto"&&l){let O=s==="days";switch(t){case 1:return O?"tomorrow":`next ${o[s][0]}`;case-1:return O?"yesterday":`last ${o[s][0]}`;case 0:return O?"today":`this ${o[s][0]}`;default:}}let c=Object.is(t,-0)||t<0,u=Math.abs(t),f=u===1,m=o[s],E=i?f?m[1]:m[2]||m[1]:f?o[s][0]:s;return c?`${u} ${E} ago`:`in ${u} ${E}`}function zp(s,t){let n="";for(let i of s)i.literal?n+=i.val:n+=t(i.val);return n}var OC={D:qn,DD:lo,DDD:co,DDDD:fo,t:ho,tt:po,ttt:mo,tttt:go,T:vo,TT:yo,TTT:bo,TTTT:Eo,f:Ao,ff:To,fff:Oo,ffff:Io,F:So,FF:Co,FFF:wo,FFFF:xo},fe=class{static create(t,n={}){return new fe(t,n)}static parseFormat(t){let n=null,i="",o=!1,l=[];for(let c=0;c<t.length;c++){let u=t.charAt(c);u==="'"?(i.length>0&&l.push({literal:o||/^\s+$/.test(i),val:i}),n=null,i="",o=!o):o||u===n?i+=u:(i.length>0&&l.push({literal:/^\s+$/.test(i),val:i}),i=u,n=u)}return i.length>0&&l.push({literal:o||/^\s+$/.test(i),val:i}),l}static macroTokenToFormatOpts(t){return OC[t]}constructor(t,n){this.opts=n,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,n){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,dt(dt({},this.opts),n)).format()}dtFormatter(t,n={}){return this.loc.dtFormatter(t,dt(dt({},this.opts),n))}formatDateTime(t,n){return this.dtFormatter(t,n).format()}formatDateTimeParts(t,n){return this.dtFormatter(t,n).formatToParts()}formatInterval(t,n){return this.dtFormatter(t.start,n).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,n){return this.dtFormatter(t,n).resolvedOptions()}num(t,n=0){if(this.opts.forceSimple)return le(t,n);let i=dt({},this.opts);return n>0&&(i.padTo=n),this.loc.numberFormatter(i).format(t)}formatDateTimeFromString(t,n){let i=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",l=(A,I)=>this.loc.extract(t,A,I),c=A=>t.isOffsetFixed&&t.offset===0&&A.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,A.format):"",u=()=>i?kp(t):l({hour:"numeric",hourCycle:"h12"},"dayperiod"),f=(A,I)=>i?Hp(t,A):l(I?{month:A}:{month:A,day:"numeric"},"month"),m=(A,I)=>i?Gp(t,A):l(I?{weekday:A}:{weekday:A,month:"long",day:"numeric"},"weekday"),E=A=>{let I=fe.macroTokenToFormatOpts(A);return I?this.formatWithSystemDefault(t,I):A},O=A=>i?Wp(t,A):l({era:A},"era"),d=A=>{switch(A){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return c({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return c({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return c({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return u();case"d":return o?l({day:"numeric"},"day"):this.num(t.day);case"dd":return o?l({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return m("short",!0);case"cccc":return m("long",!0);case"ccccc":return m("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return m("short",!1);case"EEEE":return m("long",!1);case"EEEEE":return m("narrow",!1);case"L":return o?l({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return o?l({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return f("short",!0);case"LLLL":return f("long",!0);case"LLLLL":return f("narrow",!0);case"M":return o?l({month:"numeric"},"month"):this.num(t.month);case"MM":return o?l({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return f("short",!1);case"MMMM":return f("long",!1);case"MMMMM":return f("narrow",!1);case"y":return o?l({year:"numeric"},"year"):this.num(t.year);case"yy":return o?l({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return o?l({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return o?l({year:"numeric"},"year"):this.num(t.year,6);case"G":return O("short");case"GG":return O("long");case"GGGGG":return O("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return E(A)}};return zp(fe.parseFormat(n),d)}formatDurationFromString(t,n){let i=f=>{switch(f[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=f=>m=>{let E=i(m);return E?this.num(f.get(E),m.length):m},l=fe.parseFormat(n),c=l.reduce((f,{literal:m,val:E})=>m?f:f.concat(E),[]),u=t.shiftTo(...c.map(i).filter(f=>f));return zp(l,o(u))}};k();var Ie=class{constructor(t,n){this.reason=t,this.explanation=n}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}};k();var Vp=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function yi(...s){let t=s.reduce((n,i)=>n+i.source,"");return RegExp(`^${t}$`)}function bi(...s){return t=>s.reduce(([n,i,o],l)=>{let[c,u,f]=l(t,o);return[dt(dt({},n),c),u||i,f]},[{},null,1]).slice(0,2)}function Ei(s,...t){if(s==null)return[null,null];for(let[n,i]of t){let o=n.exec(s);if(o)return i(o)}return[null,null]}function jp(...s){return(t,n)=>{let i={},o;for(o=0;o<s.length;o++)i[s[o]]=Un(t[n+o]);return[i,null,n+o]}}var Kp=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,wC=`(?:${Kp.source}?(?:\\[(${Vp.source})\\])?)?`,oc=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Jp=RegExp(`${oc.source}${wC}`),sc=RegExp(`(?:T${Jp.source})?`),IC=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,xC=/(\d{4})-?W(\d\d)(?:-?(\d))?/,RC=/(\d{4})-?(\d{3})/,MC=jp("weekYear","weekNumber","weekDay"),_C=jp("year","ordinal"),PC=/(\d{4})-(\d\d)-(\d\d)/,Zp=RegExp(`${oc.source} ?(?:${Kp.source}|(${Vp.source}))?`),LC=RegExp(`(?: ${Zp.source})?`);function vi(s,t,n){let i=s[t];return Ft(i)?n:Un(i)}function DC(s,t){return[{year:vi(s,t),month:vi(s,t+1,1),day:vi(s,t+2,1)},null,t+3]}function Ai(s,t){return[{hours:vi(s,t,0),minutes:vi(s,t+1,0),seconds:vi(s,t+2,0),milliseconds:_o(s[t+3])},null,t+4]}function Do(s,t){let n=!s[t]&&!s[t+1],i=Or(s[t+1],s[t+2]),o=n?null:ce.instance(i);return[{},o,t+3]}function No(s,t){let n=s[t]?Ae.create(s[t]):null;return[{},n,t+1]}var NC=RegExp(`^T?${oc.source}$`),FC=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function UC(s){let[t,n,i,o,l,c,u,f,m]=s,E=t[0]==="-",O=f&&f[0]==="-",d=(A,I=!1)=>A!==void 0&&(I||A&&E)?-A:A;return[{years:d(Xn(n)),months:d(Xn(i)),weeks:d(Xn(o)),days:d(Xn(l)),hours:d(Xn(c)),minutes:d(Xn(u)),seconds:d(Xn(f),f==="-0"),milliseconds:d(_o(m),O)}]}var BC={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ac(s,t,n,i,o,l,c){let u={year:t.length===2?Po(Un(t)):Un(t),month:nc.indexOf(n)+1,day:Un(i),hour:Un(o),minute:Un(l)};return c&&(u.second=Un(c)),s&&(u.weekday=s.length>3?rc.indexOf(s)+1:ic.indexOf(s)+1),u}var kC=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function GC(s){let[,t,n,i,o,l,c,u,f,m,E,O]=s,d=ac(t,o,i,n,l,c,u),A;return f?A=BC[f]:m?A=0:A=Or(E,O),[d,new ce(A)]}function HC(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var WC=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,zC=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,$C=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function $p(s){let[,t,n,i,o,l,c,u]=s;return[ac(t,o,i,n,l,c,u),ce.utcInstance]}function VC(s){let[,t,n,i,o,l,c,u]=s;return[ac(t,u,n,i,o,l,c),ce.utcInstance]}var jC=yi(IC,sc),KC=yi(xC,sc),JC=yi(RC,sc),ZC=yi(Jp),qp=bi(DC,Ai,Do,No),qC=bi(MC,Ai,Do,No),YC=bi(_C,Ai,Do,No),QC=bi(Ai,Do,No);function Yp(s){return Ei(s,[jC,qp],[KC,qC],[JC,YC],[ZC,QC])}function Qp(s){return Ei(HC(s),[kC,GC])}function Xp(s){return Ei(s,[WC,$p],[zC,$p],[$C,VC])}function tm(s){return Ei(s,[FC,UC])}var XC=bi(Ai);function em(s){return Ei(s,[NC,XC])}var tO=yi(PC,LC),eO=yi(Zp),nO=bi(Ai,Do,No);function nm(s){return Ei(s,[tO,qp],[eO,nO])}var rO="Invalid Duration",im={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},iO=dt({years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3}},im),rn=146097/400,Si=146097/4800,oO=dt({years:{quarters:4,months:12,weeks:rn/7,days:rn,hours:rn*24,minutes:rn*24*60,seconds:rn*24*60*60,milliseconds:rn*24*60*60*1e3},quarters:{months:3,weeks:rn/28,days:rn/4,hours:rn*24/4,minutes:rn*24*60/4,seconds:rn*24*60*60/4,milliseconds:rn*24*60*60*1e3/4},months:{weeks:Si/7,days:Si,hours:Si*24,minutes:Si*24*60,seconds:Si*24*60*60,milliseconds:Si*24*60*60*1e3}},im),xr=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],om=xr.slice(0).reverse();function tr(s,t,n=!1){let i={values:n?t.values:dt(dt({},s.values),t.values||{}),loc:s.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||s.conversionAccuracy,matrix:t.matrix||s.matrix};return new Ut(i)}function rm(s){return Math.trunc(s*1e3)/1e3}function sm(s,t,n,i,o){let l=s[o][n],c=t[n]/l,u=Math.floor(c);i[o]=rm(i[o]+u),t[n]=rm(t[n]-u*l)}function sO(s,t){om.reduce((n,i)=>Ft(t[i])?n:(n&&sm(s,t,n,t,i),i),null)}function aO(s){let t={};for(let[n,i]of Object.entries(s))i!==0&&(t[n]=i);return t}var Ut=class{constructor(t){let n=t.conversionAccuracy==="longterm"||!1,i=n?oO:iO;t.matrix&&(i=t.matrix),this.values=t.values,this.loc=t.loc||jt.create(),this.conversionAccuracy=n?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(t,n){return Ut.fromObject({milliseconds:t},n)}static fromObject(t,n={}){if(t==null||typeof t!="object")throw new we(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ut({values:gi(t,Ut.normalizeUnit),loc:jt.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})}static fromDurationLike(t){if(An(t))return Ut.fromMillis(t);if(Ut.isDuration(t))return t;if(typeof t=="object")return Ut.fromObject(t);throw new we(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,n){let[i]=tm(t);return i?Ut.fromObject(i,n):Ut.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,n){let[i]=em(t);return i?Ut.fromObject(i,n):Ut.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,n=null){if(!t)throw new we("need to specify a reason the Duration is invalid");let i=t instanceof Ie?t:new Ie(t,n);if(Yt.throwOnInvalid)throw new Qs(i);return new Ut({invalid:i})}static normalizeUnit(t){let n={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!n)throw new ci(t);return n}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,n={}){let i=oe(dt({},n),{floor:n.round!==!1&&n.floor!==!1});return this.isValid?fe.create(this.loc,i).formatDurationFromString(this,t):rO}toHuman(t={}){let n=xr.map(i=>{let o=this.values[i];return Ft(o)?null:this.loc.numberFormatter(oe(dt({style:"unit",unitDisplay:"long"},t),{unit:i.slice(0,-1)})).format(o)}).filter(i=>i);return this.loc.listFormatter(dt({type:"conjunction",style:t.listStyle||"narrow"},t)).format(n)}toObject(){return this.isValid?dt({},this.values):{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=di(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;let n=this.toMillis();return n<0||n>=864e5?null:(t=oe(dt({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},t),{includeOffset:!1}),At.fromMillis(n,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){var n,i;let t=(n=this.values.milliseconds)!=null?n:0;for(let o of om.slice(1))(i=this.values)!=null&&i[o]&&(t+=this.values[o]*this.matrix[o].milliseconds);return t}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;let n=Ut.fromDurationLike(t),i={};for(let o of xr)(Qn(n.values,o)||Qn(this.values,o))&&(i[o]=n.get(o)+this.get(o));return tr(this,{values:i},!0)}minus(t){if(!this.isValid)return this;let n=Ut.fromDurationLike(t);return this.plus(n.negate())}mapUnits(t){if(!this.isValid)return this;let n={};for(let i of Object.keys(this.values))n[i]=ec(t(this.values[i],i));return tr(this,{values:n},!0)}get(t){return this[Ut.normalizeUnit(t)]}set(t){if(!this.isValid)return this;let n=dt(dt({},this.values),gi(t,Ut.normalizeUnit));return tr(this,{values:n})}reconfigure({locale:t,numberingSystem:n,conversionAccuracy:i,matrix:o}={}){let c={loc:this.loc.clone({locale:t,numberingSystem:n}),matrix:o,conversionAccuracy:i};return tr(this,c)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;let t=this.toObject();return this.valueOf()>=0?(sO(this.matrix,t),tr(this,{values:t},!0)):this.negate().normalize().negate()}rescale(){if(!this.isValid)return this;let t=aO(this.normalize().shiftToAll().toObject());return tr(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(c=>Ut.normalizeUnit(c));let n={},i={},o=this.toObject(),l;for(let c of xr)if(t.indexOf(c)>=0){l=c;let u=0;for(let m in i)u+=this.matrix[m][c]*i[m],i[m]=0;An(o[c])&&(u+=o[c]);let f=Math.trunc(u);n[c]=f,i[c]=(u*1e3-f*1e3)/1e3;for(let m in o)xr.indexOf(m)>xr.indexOf(c)&&sm(this.matrix,o,m,n,c)}else An(o[c])&&(i[c]=o[c]);for(let c in i)i[c]!==0&&(n[l]+=c===l?i[c]:i[c]/this.matrix[l][c]);return tr(this,{values:n},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let t={};for(let n of Object.keys(this.values))t[n]=this.values[n]===0?0:-this.values[n];return tr(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function n(i,o){return i===void 0||i===0?o===void 0||o===0:i===o}for(let i of xr)if(!n(this.values[i],t.values[i]))return!1;return!0}};k();var Ti="Invalid Interval";function uO(s,t){return!s||!s.isValid?ee.invalid("missing or invalid start"):!t||!t.isValid?ee.invalid("missing or invalid end"):t<s?ee.invalid("end before start",`The end of an interval must be after its start, but you had start=${s.toISO()} and end=${t.toISO()}`):null}var ee=class{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,n=null){if(!t)throw new we("need to specify a reason the Interval is invalid");let i=t instanceof Ie?t:new Ie(t,n);if(Yt.throwOnInvalid)throw new Ys(i);return new ee({invalid:i})}static fromDateTimes(t,n){let i=Ci(t),o=Ci(n),l=uO(i,o);return l==null?new ee({start:i,end:o}):l}static after(t,n){let i=Ut.fromDurationLike(n),o=Ci(t);return ee.fromDateTimes(o,o.plus(i))}static before(t,n){let i=Ut.fromDurationLike(n),o=Ci(t);return ee.fromDateTimes(o.minus(i),o)}static fromISO(t,n){let[i,o]=(t||"").split("/",2);if(i&&o){let l,c;try{l=At.fromISO(i,n),c=l.isValid}catch(m){c=!1}let u,f;try{u=At.fromISO(o,n),f=u.isValid}catch(m){f=!1}if(c&&f)return ee.fromDateTimes(l,u);if(c){let m=Ut.fromISO(o,n);if(m.isValid)return ee.after(l,m)}else if(f){let m=Ut.fromISO(i,n);if(m.isValid)return ee.before(u,m)}}return ee.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds"){if(!this.isValid)return NaN;let n=this.start.startOf(t),i=this.end.startOf(t);return Math.floor(i.diff(n,t).get(t))+(i.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:n}={}){return this.isValid?ee.fromDateTimes(t||this.s,n||this.e):this}splitAt(...t){if(!this.isValid)return[];let n=t.map(Ci).filter(c=>this.contains(c)).sort(),i=[],{s:o}=this,l=0;for(;o<this.e;){let c=n[l]||this.e,u=+c>+this.e?this.e:c;i.push(ee.fromDateTimes(o,u)),o=u,l+=1}return i}splitBy(t){let n=Ut.fromDurationLike(t);if(!this.isValid||!n.isValid||n.as("milliseconds")===0)return[];let{s:i}=this,o=1,l,c=[];for(;i<this.e;){let u=this.start.plus(n.mapUnits(f=>f*o));l=+u>+this.e?this.e:u,c.push(ee.fromDateTimes(i,l)),i=l,o+=1}return c}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;let n=this.s>t.s?this.s:t.s,i=this.e<t.e?this.e:t.e;return n>=i?null:ee.fromDateTimes(n,i)}union(t){if(!this.isValid)return this;let n=this.s<t.s?this.s:t.s,i=this.e>t.e?this.e:t.e;return ee.fromDateTimes(n,i)}static merge(t){let[n,i]=t.sort((o,l)=>o.s-l.s).reduce(([o,l],c)=>l?l.overlaps(c)||l.abutsStart(c)?[o,l.union(c)]:[o.concat([l]),c]:[o,c],[[],null]);return i&&n.push(i),n}static xor(t){let n=null,i=0,o=[],l=t.map(f=>[{time:f.s,type:"s"},{time:f.e,type:"e"}]),c=Array.prototype.concat(...l),u=c.sort((f,m)=>f.time-m.time);for(let f of u)i+=f.type==="s"?1:-1,i===1?n=f.time:(n&&+n!=+f.time&&o.push(ee.fromDateTimes(n,f.time)),n=null);return ee.merge(o)}difference(...t){return ee.xor([this].concat(t)).map(n=>this.intersection(n)).filter(n=>n&&!n.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:Ti}toLocaleString(t=qn,n={}){return this.isValid?fe.create(this.s.loc.clone(n),t).formatInterval(this):Ti}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:Ti}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Ti}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:Ti}toFormat(t,{separator:n=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(t)}${n}${this.e.toFormat(t)}`:Ti}toDuration(t,n){return this.isValid?this.e.diff(this.s,t,n):Ut.invalid(this.invalidReason)}mapEndpoints(t){return ee.fromDateTimes(t(this.s),t(this.e))}};k();var Bn=class{static hasDST(t=Yt.defaultZone){let n=At.now().setZone(t).set({month:12});return!t.isUniversal&&n.offset!==n.set({month:6}).offset}static isValidIANAZone(t){return Ae.isValidZone(t)}static normalizeZone(t){return hn(t,Yt.defaultZone)}static months(t="long",{locale:n=null,numberingSystem:i=null,locObj:o=null,outputCalendar:l="gregory"}={}){return(o||jt.create(n,i,l)).months(t)}static monthsFormat(t="long",{locale:n=null,numberingSystem:i=null,locObj:o=null,outputCalendar:l="gregory"}={}){return(o||jt.create(n,i,l)).months(t,!0)}static weekdays(t="long",{locale:n=null,numberingSystem:i=null,locObj:o=null}={}){return(o||jt.create(n,i,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:n=null,numberingSystem:i=null,locObj:o=null}={}){return(o||jt.create(n,i,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return jt.create(t).meridiems()}static eras(t="short",{locale:n=null}={}){return jt.create(n,null,"gregory").eras(t)}static features(){return{relative:ia()}}};k();function am(s,t){let n=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=n(t)-n(s);return Math.floor(Ut.fromMillis(i).as("days"))}function lO(s,t,n){let i=[["years",(f,m)=>m.year-f.year],["quarters",(f,m)=>m.quarter-f.quarter+(m.year-f.year)*4],["months",(f,m)=>m.month-f.month+(m.year-f.year)*12],["weeks",(f,m)=>{let E=am(f,m);return(E-E%7)/7}],["days",am]],o={},l=s,c,u;for(let[f,m]of i)n.indexOf(f)>=0&&(c=f,o[f]=m(s,t),u=l.plus(o),u>t?(o[f]--,s=l.plus(o),s>t&&(u=s,o[f]--,s=l.plus(o))):s=u);return[s,o,u,c]}function um(s,t,n,i){let[o,l,c,u]=lO(s,t,n),f=t-o,m=n.filter(O=>["hours","minutes","seconds","milliseconds"].indexOf(O)>=0);m.length===0&&(c<t&&(c=o.plus({[u]:1})),c!==o&&(l[u]=(l[u]||0)+f/(c-o)));let E=Ut.fromObject(l,i);return m.length>0?Ut.fromMillis(f,i).shiftTo(...m).plus(E):E}k();k();var uc={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},lm={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},cO=uc.hanidec.replace(/[\[|\]]/g,"").split("");function cm(s){let t=parseInt(s,10);if(isNaN(t)){t="";for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);if(s[n].search(uc.hanidec)!==-1)t+=cO.indexOf(s[n]);else for(let o in lm){let[l,c]=lm[o];i>=l&&i<=c&&(t+=i-l)}}return parseInt(t,10)}else return t}function on({numberingSystem:s},t=""){return new RegExp(`${uc[s||"latn"]}${t}`)}var fO="missing Intl.DateTimeFormat.formatToParts support";function Zt(s,t=n=>n){return{regex:s,deser:([n])=>t(cm(n))}}var dO=String.fromCharCode(160),hm=`[ ${dO}]`,pm=new RegExp(hm,"g");function hO(s){return s.replace(/\./g,"\\.?").replace(pm,hm)}function fm(s){return s.replace(/\./g,"").replace(pm," ").toLowerCase()}function pn(s,t){return s===null?null:{regex:RegExp(s.map(hO).join("|")),deser:([n])=>s.findIndex(i=>fm(n)===fm(i))+t}}function dm(s,t){return{regex:s,deser:([,n,i])=>Or(n,i),groups:t}}function oa(s){return{regex:s,deser:([t])=>t}}function pO(s){return s.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function mO(s,t){let n=on(t),i=on(t,"{2}"),o=on(t,"{3}"),l=on(t,"{4}"),c=on(t,"{6}"),u=on(t,"{1,2}"),f=on(t,"{1,3}"),m=on(t,"{1,6}"),E=on(t,"{1,9}"),O=on(t,"{2,4}"),d=on(t,"{4,6}"),A=C=>({regex:RegExp(pO(C.val)),deser:([S])=>S,literal:!0}),M=(C=>{if(s.literal)return A(C);switch(C.val){case"G":return pn(t.eras("short"),0);case"GG":return pn(t.eras("long"),0);case"y":return Zt(m);case"yy":return Zt(O,Po);case"yyyy":return Zt(l);case"yyyyy":return Zt(d);case"yyyyyy":return Zt(c);case"M":return Zt(u);case"MM":return Zt(i);case"MMM":return pn(t.months("short",!0),1);case"MMMM":return pn(t.months("long",!0),1);case"L":return Zt(u);case"LL":return Zt(i);case"LLL":return pn(t.months("short",!1),1);case"LLLL":return pn(t.months("long",!1),1);case"d":return Zt(u);case"dd":return Zt(i);case"o":return Zt(f);case"ooo":return Zt(o);case"HH":return Zt(i);case"H":return Zt(u);case"hh":return Zt(i);case"h":return Zt(u);case"mm":return Zt(i);case"m":return Zt(u);case"q":return Zt(u);case"qq":return Zt(i);case"s":return Zt(u);case"ss":return Zt(i);case"S":return Zt(f);case"SSS":return Zt(o);case"u":return oa(E);case"uu":return oa(u);case"uuu":return Zt(n);case"a":return pn(t.meridiems(),0);case"kkkk":return Zt(l);case"kk":return Zt(O,Po);case"W":return Zt(u);case"WW":return Zt(i);case"E":case"c":return Zt(n);case"EEE":return pn(t.weekdays("short",!1),1);case"EEEE":return pn(t.weekdays("long",!1),1);case"ccc":return pn(t.weekdays("short",!0),1);case"cccc":return pn(t.weekdays("long",!0),1);case"Z":case"ZZ":return dm(new RegExp(`([+-]${u.source})(?::(${i.source}))?`),2);case"ZZZ":return dm(new RegExp(`([+-]${u.source})(${i.source})?`),2);case"z":return oa(/[a-z_+-/]{1,256}?/i);case" ":return oa(/[^\S\n\r]/);default:return A(C)}})(s)||{invalidReason:fO};return M.token=s,M}var gO={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function vO(s,t,n){let{type:i,value:o}=s;if(i==="literal"){let f=/^\s+$/.test(o);return{literal:!f,val:f?" ":o}}let l=t[i],c=i;i==="hour"&&(t.hour12!=null?c=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?c="hour12":c="hour24":c=n.hour12?"hour12":"hour24");let u=gO[c];if(typeof u=="object"&&(u=u[l]),u)return{literal:!1,val:u}}function yO(s){return[`^${s.map(n=>n.regex).reduce((n,i)=>`${n}(${i.source})`,"")}$`,s]}function bO(s,t,n){let i=s.match(t);if(i){let o={},l=1;for(let c in n)if(Qn(n,c)){let u=n[c],f=u.groups?u.groups+1:1;!u.literal&&u.token&&(o[u.token.val[0]]=u.deser(i.slice(l,l+f))),l+=f}return[i,o]}else return[i,{}]}function EO(s){let t=l=>{switch(l){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},n=null,i;return Ft(s.z)||(n=Ae.create(s.z)),Ft(s.Z)||(n||(n=new ce(s.Z)),i=s.Z),Ft(s.q)||(s.M=(s.q-1)*3+1),Ft(s.h)||(s.h<12&&s.a===1?s.h+=12:s.h===12&&s.a===0&&(s.h=0)),s.G===0&&s.y&&(s.y=-s.y),Ft(s.u)||(s.S=_o(s.u)),[Object.keys(s).reduce((l,c)=>{let u=t(c);return u&&(l[u]=s[c]),l},{}),n,i]}var lc=null;function AO(){return lc||(lc=At.fromMillis(1555555555555)),lc}function SO(s,t){if(s.literal)return s;let n=fe.macroTokenToFormatOpts(s.val),i=dc(n,t);return i==null||i.includes(void 0)?s:i}function cc(s,t){return Array.prototype.concat(...s.map(n=>SO(n,t)))}function fc(s,t,n){let i=cc(fe.parseFormat(n),s),o=i.map(c=>mO(c,s)),l=o.find(c=>c.invalidReason);if(l)return{input:t,tokens:i,invalidReason:l.invalidReason};{let[c,u]=yO(o),f=RegExp(c,"i"),[m,E]=bO(t,f,u),[O,d,A]=E?EO(E):[null,null,void 0];if(Qn(E,"a")&&Qn(E,"H"))throw new Fn("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:i,regex:f,rawMatches:m,matches:E,result:O,zone:d,specificOffset:A}}}function mm(s,t,n){let{result:i,zone:o,specificOffset:l,invalidReason:c}=fc(s,t,n);return[i,o,l,c]}function dc(s,t){if(!s)return null;let i=fe.create(t,s).dtFormatter(AO()),o=i.formatToParts(),l=i.resolvedOptions();return o.map(c=>vO(c,s,l))}k();var gm=[0,31,59,90,120,151,181,212,243,273,304,334],vm=[0,31,60,91,121,152,182,213,244,274,305,335];function sn(s,t){return new Ie("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${s}, which is invalid`)}function ym(s,t,n){let i=new Date(Date.UTC(s,t-1,n));s<100&&s>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);let o=i.getUTCDay();return o===0?7:o}function bm(s,t,n){return n+(wr(s)?vm:gm)[t-1]}function Em(s,t){let n=wr(s)?vm:gm,i=n.findIndex(l=>l<t),o=t-n[i];return{month:i+1,day:o}}function sa(s){let{year:t,month:n,day:i}=s,o=bm(t,n,i),l=ym(t,n,i),c=Math.floor((o-l+10)/7),u;return c<1?(u=t-1,c=mi(u)):c>mi(t)?(u=t+1,c=1):u=t,dt({weekYear:u,weekNumber:c,weekday:l},Lo(s))}function hc(s){let{weekYear:t,weekNumber:n,weekday:i}=s,o=ym(t,1,4),l=Ir(t),c=n*7+i-o-3,u;c<1?(u=t-1,c+=Ir(u)):c>l?(u=t+1,c-=Ir(t)):u=t;let{month:f,day:m}=Em(u,c);return dt({year:u,month:f,day:m},Lo(s))}function aa(s){let{year:t,month:n,day:i}=s,o=bm(t,n,i);return dt({year:t,ordinal:o},Lo(s))}function pc(s){let{year:t,ordinal:n}=s,{month:i,day:o}=Em(t,n);return dt({year:t,month:i,day:o},Lo(s))}function Am(s){let t=Mo(s.weekYear),n=Sn(s.weekNumber,1,mi(s.weekYear)),i=Sn(s.weekday,1,7);return t?n?i?!1:sn("weekday",s.weekday):sn("week",s.week):sn("weekYear",s.weekYear)}function Sm(s){let t=Mo(s.year),n=Sn(s.ordinal,1,Ir(s.year));return t?n?!1:sn("ordinal",s.ordinal):sn("year",s.year)}function mc(s){let t=Mo(s.year),n=Sn(s.month,1,12),i=Sn(s.day,1,pi(s.year,s.month));return t?n?i?!1:sn("day",s.day):sn("month",s.month):sn("year",s.year)}function gc(s){let{hour:t,minute:n,second:i,millisecond:o}=s,l=Sn(t,0,23)||t===24&&n===0&&i===0&&o===0,c=Sn(n,0,59),u=Sn(i,0,59),f=Sn(o,0,999);return l?c?u?f?!1:sn("millisecond",o):sn("second",i):sn("minute",n):sn("hour",t)}var vc="Invalid DateTime",Tm=864e13;function ua(s){return new Ie("unsupported zone",`the zone "${s.name}" is not supported`)}function yc(s){return s.weekData===null&&(s.weekData=sa(s.c)),s.weekData}function Rr(s,t){let n={ts:s.ts,zone:s.zone,c:s.c,o:s.o,loc:s.loc,invalid:s.invalid};return new At(oe(dt(dt({},n),t),{old:n}))}function Mm(s,t,n){let i=s-t*60*1e3,o=n.offset(i);if(t===o)return[i,t];i-=(o-t)*60*1e3;let l=n.offset(i);return o===l?[i,o]:[s-Math.min(o,l)*60*1e3,Math.max(o,l)]}function la(s,t){s+=t*60*1e3;let n=new Date(s);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function fa(s,t,n){return Mm(fi(s),t,n)}function Cm(s,t){let n=s.o,i=s.c.year+Math.trunc(t.years),o=s.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,l=oe(dt({},s.c),{year:i,month:o,day:Math.min(s.c.day,pi(i,o))+Math.trunc(t.days)+Math.trunc(t.weeks)*7}),c=Ut.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),u=fi(l),[f,m]=Mm(u,n,s.zone);return c!==0&&(f+=c,m=s.zone.offset(f)),{ts:f,o:m}}function Fo(s,t,n,i,o,l){let{setZone:c,zone:u}=n;if(s&&Object.keys(s).length!==0||t){let f=t||u,m=At.fromObject(s,oe(dt({},n),{zone:f,specificOffset:l}));return c?m:m.setZone(u)}else return At.invalid(new Ie("unparsable",`the input "${o}" can't be parsed as ${i}`))}function ca(s,t,n=!0){return s.isValid?fe.create(jt.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(s,t):null}function bc(s,t){let n=s.c.year>9999||s.c.year<0,i="";return n&&s.c.year>=0&&(i+="+"),i+=le(s.c.year,n?6:4),t?(i+="-",i+=le(s.c.month),i+="-",i+=le(s.c.day)):(i+=le(s.c.month),i+=le(s.c.day)),i}function Om(s,t,n,i,o,l){let c=le(s.c.hour);return t?(c+=":",c+=le(s.c.minute),(s.c.millisecond!==0||s.c.second!==0||!n)&&(c+=":")):c+=le(s.c.minute),(s.c.millisecond!==0||s.c.second!==0||!n)&&(c+=le(s.c.second),(s.c.millisecond!==0||!i)&&(c+=".",c+=le(s.c.millisecond,3))),o&&(s.isOffsetFixed&&s.offset===0&&!l?c+="Z":s.o<0?(c+="-",c+=le(Math.trunc(-s.o/60)),c+=":",c+=le(Math.trunc(-s.o%60))):(c+="+",c+=le(Math.trunc(s.o/60)),c+=":",c+=le(Math.trunc(s.o%60)))),l&&(c+="["+s.zone.ianaName+"]"),c}var _m={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},TO={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},CO={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Pm=["year","month","day","hour","minute","second","millisecond"],OO=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],wO=["year","ordinal","hour","minute","second","millisecond"];function wm(s){let t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[s.toLowerCase()];if(!t)throw new ci(s);return t}function Im(s,t){let n=hn(t.zone,Yt.defaultZone),i=jt.fromObject(t),o=Yt.now(),l,c;if(Ft(s.year))l=o;else{for(let m of Pm)Ft(s[m])&&(s[m]=_m[m]);let u=mc(s)||gc(s);if(u)return At.invalid(u);let f=n.offset(o);[l,c]=fa(s,f,n)}return new At({ts:l,zone:n,loc:i,o:c})}function xm(s,t,n){let i=Ft(n.round)?!0:n.round,o=(c,u)=>(c=di(c,i||n.calendary?0:2,!0),t.loc.clone(n).relFormatter(n).format(c,u)),l=c=>n.calendary?t.hasSame(s,c)?0:t.startOf(c).diff(s.startOf(c),c).get(c):t.diff(s,c).get(c);if(n.unit)return o(l(n.unit),n.unit);for(let c of n.units){let u=l(c);if(Math.abs(u)>=1)return o(u,c)}return o(s>t?-0:0,n.units[n.units.length-1])}function Rm(s){let t={},n;return s.length>0&&typeof s[s.length-1]=="object"?(t=s[s.length-1],n=Array.from(s).slice(0,s.length-1)):n=Array.from(s),[t,n]}var At=class{constructor(t){let n=t.zone||Yt.defaultZone,i=t.invalid||(Number.isNaN(t.ts)?new Ie("invalid input"):null)||(n.isValid?null:ua(n));this.ts=Ft(t.ts)?Yt.now():t.ts;let o=null,l=null;if(!i)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(n))[o,l]=[t.old.c,t.old.o];else{let u=n.offset(this.ts);o=la(this.ts,u),i=Number.isNaN(o.year)?new Ie("invalid input"):null,o=i?null:o,l=i?null:u}this._zone=n,this.loc=t.loc||jt.create(),this.invalid=i,this.weekData=null,this.c=o,this.o=l,this.isLuxonDateTime=!0}static now(){return new At({})}static local(){let[t,n]=Rm(arguments),[i,o,l,c,u,f,m]=n;return Im({year:i,month:o,day:l,hour:c,minute:u,second:f,millisecond:m},t)}static utc(){let[t,n]=Rm(arguments),[i,o,l,c,u,f,m]=n;return t.zone=ce.utcInstance,Im({year:i,month:o,day:l,hour:c,minute:u,second:f,millisecond:m},t)}static fromJSDate(t,n={}){let i=Fp(t)?t.valueOf():NaN;if(Number.isNaN(i))return At.invalid("invalid input");let o=hn(n.zone,Yt.defaultZone);return o.isValid?new At({ts:i,zone:o,loc:jt.fromObject(n)}):At.invalid(ua(o))}static fromMillis(t,n={}){if(An(t))return t<-Tm||t>Tm?At.invalid("Timestamp out of range"):new At({ts:t,zone:hn(n.zone,Yt.defaultZone),loc:jt.fromObject(n)});throw new we(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,n={}){if(An(t))return new At({ts:t*1e3,zone:hn(n.zone,Yt.defaultZone),loc:jt.fromObject(n)});throw new we("fromSeconds requires a numerical input")}static fromObject(t,n={}){t=t||{};let i=hn(n.zone,Yt.defaultZone);if(!i.isValid)return At.invalid(ua(i));let o=Yt.now(),l=Ft(n.specificOffset)?i.offset(o):n.specificOffset,c=gi(t,wm),u=!Ft(c.ordinal),f=!Ft(c.year),m=!Ft(c.month)||!Ft(c.day),E=f||m,O=c.weekYear||c.weekNumber,d=jt.fromObject(n);if((E||u)&&O)throw new Fn("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&u)throw new Fn("Can't mix ordinal dates with month/day");let A=O||c.weekday&&!E,I,M,C=la(o,l);A?(I=OO,M=TO,C=sa(C)):u?(I=wO,M=CO,C=aa(C)):(I=Pm,M=_m);let S=!1;for(let T of I){let x=c[T];Ft(x)?S?c[T]=M[T]:c[T]=C[T]:S=!0}let w=A?Am(c):u?Sm(c):mc(c),p=w||gc(c);if(p)return At.invalid(p);let y=A?hc(c):u?pc(c):c,[g,v]=fa(y,l,i),h=new At({ts:g,zone:i,o:v,loc:d});return c.weekday&&E&&t.weekday!==h.weekday?At.invalid("mismatched weekday",`you can't specify both a weekday of ${c.weekday} and a date of ${h.toISO()}`):h}static fromISO(t,n={}){let[i,o]=Yp(t);return Fo(i,o,n,"ISO 8601",t)}static fromRFC2822(t,n={}){let[i,o]=Qp(t);return Fo(i,o,n,"RFC 2822",t)}static fromHTTP(t,n={}){let[i,o]=Xp(t);return Fo(i,o,n,"HTTP",n)}static fromFormat(t,n,i={}){if(Ft(t)||Ft(n))throw new we("fromFormat requires an input string and a format");let{locale:o=null,numberingSystem:l=null}=i,c=jt.fromOpts({locale:o,numberingSystem:l,defaultToEN:!0}),[u,f,m,E]=mm(c,t,n);return E?At.invalid(E):Fo(u,f,i,`format ${n}`,t,m)}static fromString(t,n,i={}){return At.fromFormat(t,n,i)}static fromSQL(t,n={}){let[i,o]=nm(t);return Fo(i,o,n,"SQL",t)}static invalid(t,n=null){if(!t)throw new we("need to specify a reason the DateTime is invalid");let i=t instanceof Ie?t:new Ie(t,n);if(Yt.throwOnInvalid)throw new qs(i);return new At({invalid:i})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,n={}){let i=dc(t,jt.fromObject(n));return i?i.map(o=>o?o.val:null).join(""):null}static expandFormat(t,n={}){return cc(fe.parseFormat(t),jt.fromObject(n)).map(o=>o.val).join("")}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?yc(this).weekYear:NaN}get weekNumber(){return this.isValid?yc(this).weekNumber:NaN}get weekday(){return this.isValid?yc(this).weekday:NaN}get ordinal(){return this.isValid?aa(this.c).ordinal:NaN}get monthShort(){return this.isValid?Bn.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Bn.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Bn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Bn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let t=864e5,n=6e4,i=fi(this.c),o=this.zone.offset(i-t),l=this.zone.offset(i+t),c=this.zone.offset(i-o*n),u=this.zone.offset(i-l*n);if(c===u)return[this];let f=i-c*n,m=i-u*n,E=la(f,c),O=la(m,u);return E.hour===O.hour&&E.minute===O.minute&&E.second===O.second&&E.millisecond===O.millisecond?[Rr(this,{ts:f}),Rr(this,{ts:m})]:[this]}get isInLeapYear(){return wr(this.year)}get daysInMonth(){return pi(this.year,this.month)}get daysInYear(){return this.isValid?Ir(this.year):NaN}get weeksInWeekYear(){return this.isValid?mi(this.weekYear):NaN}resolvedLocaleOptions(t={}){let{locale:n,numberingSystem:i,calendar:o}=fe.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:n,numberingSystem:i,outputCalendar:o}}toUTC(t=0,n={}){return this.setZone(ce.instance(t),n)}toLocal(){return this.setZone(Yt.defaultZone)}setZone(t,{keepLocalTime:n=!1,keepCalendarTime:i=!1}={}){if(t=hn(t,Yt.defaultZone),t.equals(this.zone))return this;if(t.isValid){let o=this.ts;if(n||i){let l=t.offset(this.ts),c=this.toObject();[o]=fa(c,l,t)}return Rr(this,{ts:o,zone:t})}else return At.invalid(ua(t))}reconfigure({locale:t,numberingSystem:n,outputCalendar:i}={}){let o=this.loc.clone({locale:t,numberingSystem:n,outputCalendar:i});return Rr(this,{loc:o})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;let n=gi(t,wm),i=!Ft(n.weekYear)||!Ft(n.weekNumber)||!Ft(n.weekday),o=!Ft(n.ordinal),l=!Ft(n.year),c=!Ft(n.month)||!Ft(n.day),u=l||c,f=n.weekYear||n.weekNumber;if((u||o)&&f)throw new Fn("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&o)throw new Fn("Can't mix ordinal dates with month/day");let m;i?m=hc(dt(dt({},sa(this.c)),n)):Ft(n.ordinal)?(m=dt(dt({},this.toObject()),n),Ft(n.day)&&(m.day=Math.min(pi(m.year,m.month),m.day))):m=pc(dt(dt({},aa(this.c)),n));let[E,O]=fa(m,this.o,this.zone);return Rr(this,{ts:E,o:O})}plus(t){if(!this.isValid)return this;let n=Ut.fromDurationLike(t);return Rr(this,Cm(this,n))}minus(t){if(!this.isValid)return this;let n=Ut.fromDurationLike(t).negate();return Rr(this,Cm(this,n))}startOf(t){if(!this.isValid)return this;let n={},i=Ut.normalizeUnit(t);switch(i){case"years":n.month=1;case"quarters":case"months":n.day=1;case"weeks":case"days":n.hour=0;case"hours":n.minute=0;case"minutes":n.second=0;case"seconds":n.millisecond=0;break;case"milliseconds":break}if(i==="weeks"&&(n.weekday=1),i==="quarters"){let o=Math.ceil(this.month/3);n.month=(o-1)*3+1}return this.set(n)}endOf(t){return this.isValid?this.plus({[t]:1}).startOf(t).minus(1):this}toFormat(t,n={}){return this.isValid?fe.create(this.loc.redefaultToEN(n)).formatDateTimeFromString(this,t):vc}toLocaleString(t=qn,n={}){return this.isValid?fe.create(this.loc.clone(n),t).formatDateTime(this):vc}toLocaleParts(t={}){return this.isValid?fe.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:n=!1,suppressMilliseconds:i=!1,includeOffset:o=!0,extendedZone:l=!1}={}){if(!this.isValid)return null;let c=t==="extended",u=bc(this,c);return u+="T",u+=Om(this,c,n,i,o,l),u}toISODate({format:t="extended"}={}){return this.isValid?bc(this,t==="extended"):null}toISOWeekDate(){return ca(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:n=!1,includeOffset:i=!0,includePrefix:o=!1,extendedZone:l=!1,format:c="extended"}={}){return this.isValid?(o?"T":"")+Om(this,c==="extended",n,t,i,l):null}toRFC2822(){return ca(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ca(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?bc(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:n=!1,includeOffsetSpace:i=!0}={}){let o="HH:mm:ss.SSS";return(n||t)&&(i&&(o+=" "),n?o+="z":t&&(o+="ZZ")),ca(this,o,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():vc}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};let n=dt({},this.c);return t.includeConfig&&(n.outputCalendar=this.outputCalendar,n.numberingSystem=this.loc.numberingSystem,n.locale=this.loc.locale),n}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,n="milliseconds",i={}){if(!this.isValid||!t.isValid)return Ut.invalid("created by diffing an invalid DateTime");let o=dt({locale:this.locale,numberingSystem:this.numberingSystem},i),l=Up(n).map(Ut.normalizeUnit),c=t.valueOf()>this.valueOf(),u=c?this:t,f=c?t:this,m=um(u,f,l,o);return c?m.negate():m}diffNow(t="milliseconds",n={}){return this.diff(At.now(),t,n)}until(t){return this.isValid?ee.fromDateTimes(this,t):this}hasSame(t,n){if(!this.isValid)return!1;let i=t.valueOf(),o=this.setZone(t.zone,{keepLocalTime:!0});return o.startOf(n)<=i&&i<=o.endOf(n)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;let n=t.base||At.fromObject({},{zone:this.zone}),i=t.padding?this<n?-t.padding:t.padding:0,o=["years","months","days","hours","minutes","seconds"],l=t.unit;return Array.isArray(t.unit)&&(o=t.unit,l=void 0),xm(n,this.plus(i),oe(dt({},t),{numeric:"always",units:o,unit:l}))}toRelativeCalendar(t={}){return this.isValid?xm(t.base||At.fromObject({},{zone:this.zone}),this,oe(dt({},t),{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...t){if(!t.every(At.isDateTime))throw new we("min requires all arguments be DateTimes");return tc(t,n=>n.valueOf(),Math.min)}static max(...t){if(!t.every(At.isDateTime))throw new we("max requires all arguments be DateTimes");return tc(t,n=>n.valueOf(),Math.max)}static fromFormatExplain(t,n,i={}){let{locale:o=null,numberingSystem:l=null}=i,c=jt.fromOpts({locale:o,numberingSystem:l,defaultToEN:!0});return fc(c,t,n)}static fromStringExplain(t,n,i={}){return At.fromFormatExplain(t,n,i)}static get DATE_SHORT(){return qn}static get DATE_MED(){return lo}static get DATE_MED_WITH_WEEKDAY(){return Bl}static get DATE_FULL(){return co}static get DATE_HUGE(){return fo}static get TIME_SIMPLE(){return ho}static get TIME_WITH_SECONDS(){return po}static get TIME_WITH_SHORT_OFFSET(){return mo}static get TIME_WITH_LONG_OFFSET(){return go}static get TIME_24_SIMPLE(){return vo}static get TIME_24_WITH_SECONDS(){return yo}static get TIME_24_WITH_SHORT_OFFSET(){return bo}static get TIME_24_WITH_LONG_OFFSET(){return Eo}static get DATETIME_SHORT(){return Ao}static get DATETIME_SHORT_WITH_SECONDS(){return So}static get DATETIME_MED(){return To}static get DATETIME_MED_WITH_SECONDS(){return Co}static get DATETIME_MED_WITH_WEEKDAY(){return kl}static get DATETIME_FULL(){return Oo}static get DATETIME_FULL_WITH_SECONDS(){return wo}static get DATETIME_HUGE(){return Io}static get DATETIME_HUGE_WITH_SECONDS(){return xo}};function Ci(s){if(At.isDateTime(s))return s;if(s&&s.valueOf&&An(s.valueOf()))return At.fromJSDate(s);if(s&&typeof s=="object")return At.fromObject(s);throw new we(`Unknown datetime argument: ${s}, of type ${typeof s}`)}var Lm=$t(Mt),IO=[Lm.styles,Il],Mr=class extends Lm{constructor(){super();this.updateComment=({detail:n})=>{let{text:i}=n;this.text=i,this.closeEditMode(),this.emitEvent("update-comment",{uuid:this.uuid,text:i})};this.resolveAnnotation=()=>{this.emitEvent("resolve-annotation",{type:"resolve-annotation",resolved:!this.resolved},{composed:!1,bubbles:!1})};this.confirmDelete=()=>{if(this.deleteCommentModalOpen=!1,this.primaryComment)return this.emitEvent("delete-annotation",{uuid:this.annotationId});this.emitEvent("delete-comment",{uuid:this.uuid})};this.closeEditMode=()=>{this.mode="readonly"};this.resolved=!1}render(){var A;let n=this.annotationFilter==="all"?"resolve":"undo",i=I=>At.fromISO(I).toFormat("yyyy-dd-MM"),o=this.resolvable?"comment-item__resolve":"hidden",l=[{label:"EDIT"},{label:"DELETE"}],c=({detail:I})=>{I==="EDIT"&&(this.mode="editable"),I==="DELETE"&&(this.deleteCommentModalOpen=!0)},u=()=>{this.text.length<120||(this.expandElipsis=!0)},f=()=>{if(this.mode==="editable")return yt`
        <superviz-comments-comment-input
          class="comment-item--editable"
          editable
          text=${this.text}
          eventType="update-comment"
          @update-comment=${this.updateComment}
          @close-edit-mode=${this.closeEditMode}
        ></superviz-comments-comment-input>
      `},m=()=>{if(this.mode!=="editable")return yt`
        <span
          id="comment-text"
          @click=${u}
          class="text text-big sv-gray-700 ${d}"
          >${this.text}</span
        >
      `},E=()=>{this.deleteCommentModalOpen=!1},O={"comment-item":!0,reply:!this.primaryComment},d=!this.expandElipsis&&this.text.length>120?"line-clamp":"";return yt`
      <div class=${Ee(O)}>
        <div class="comment-item__user">
          <div class="comment-item__user-details">
            <div class="comment-item__avatar">
              <p class="text text-bold">${((A=this.username[0])==null?void 0:A.toUpperCase())||"A"}</p>
            </div>
            <span class="text text-bold sv-gray-600">${this.username}</span>
            <span class="text text-small sv-gray-500">${i(this.createdAt)}</span>
          </div>
          <button
            @click=${this.resolveAnnotation}
            class="icon-button icon-button--clickable icon-button--xsmall ${o}"
          >
            <superviz-icon name=${n} size="md"></superviz-icon>
          </button>
          <superviz-dropdown
            options=${JSON.stringify(l)}
            label="label"
            returnTo="label"
            position="bottom-right"
            @selected=${c}
          >
            <button slot="dropdown" class="icon-button icon-button--clickable icon-button--small">
              <superviz-icon name="more" size="sm"></superviz-icon>
            </button>
          </superviz-dropdown>
        </div>

        <div class="comment-item__content">
          <div class="comment-item__content__body">${f()} ${m()}</div>
        </div>
      </div>
      <superviz-comments-delete-comments-modal
        ?open=${this.deleteCommentModalOpen}
        @close=${E}
        @confirm=${this.confirmDelete}
      >
      </superviz-comments-delete-comments-modal>
    `}};Mr.styles=IO,Mr.properties={uuid:{type:String},annotationId:{type:String},avatar:{type:String},username:{type:String},text:{type:String},resolved:{type:Boolean},resolvable:{type:Boolean},createdAt:{type:String},mode:{type:String},deleteCommentModalOpen:{type:Boolean},primaryComment:{type:Boolean},expandElipsis:{type:Boolean},annotationFilter:{type:String}},Mr=Ht([Wt("superviz-comments-comment-item")],Mr);k();var Dm=$t(Mt),xO=[Dm.styles,Rl],_r=class extends Dm{constructor(){super();this.pinCoordinates=null;this.getCommentInput=()=>this.shadowRoot.getElementById("comment-input--textarea");this.getCommentInputContainer=()=>this.shadowRoot.getElementById("comment-input--container");this.getSendBtn=()=>this.shadowRoot.querySelector(".comment-input--send-btn");this.commentInputFocus=({detail:n})=>{this.pinCoordinates=n,this.getCommentInput().focus()};this.closeEditMode=()=>{this.emitEvent("close-edit-mode",{},{composed:!1,bubbles:!1})};this.btnActive=!1,this.text=""}connectedCallback(){super.connectedCallback(),this.eventType==="create-annotation"&&window.document.body.addEventListener("comment-input-focus",this.commentInputFocus)}disconnectedCallback(){super.disconnectedCallback(),this.eventType==="create-annotation"&&window.document.body.removeEventListener("comment-input-focus",this.commentInputFocus)}updated(n){if(n.has("text")&&this.text.length>0){let i=this.getCommentInput();i.value=this.text,this.updateHeight()}if(n.has("btnActive")){let i=this.getSendBtn();i.disabled=!this.btnActive}}updateHeight(){let n=this.getCommentInput(),i=this.getCommentInputContainer();n.style.height="0px",i.style.height="0px";let o=n.scrollHeight+4,l=n.scrollHeight;n.style.height=`${o}px`,i.style.height=`${l}px`;let c=this.getSendBtn();c.disabled=!(n.value.length>0)}send(n){var c,u,f,m,E,O,d,A;n.preventDefault();let i=this.getCommentInput(),o=this.getSendBtn(),l=i.value;this.emitEvent(this.eventType,{text:l,position:{x:(u=(c=this.pinCoordinates)==null?void 0:c.x)!=null?u:null,y:(m=(f=this.pinCoordinates)==null?void 0:f.y)!=null?m:null,z:(O=(E=this.pinCoordinates)==null?void 0:E.z)!=null?O:null,type:(A=(d=this.pinCoordinates)==null?void 0:d.type)!=null?A:null}},{composed:!1,bubbles:!1}),this.pinCoordinates=null,i.value="",o.disabled=!0,this.updateHeight()}render(){let n=()=>{if(!!this.editable)return yt`
        <button
          id="close"
          @click=${()=>this.closeEditMode()}
          class="icon-button icon-button--medium icon-button--clickable"
          @click=${this.send}
        >
          <superviz-icon name="close" size="md"></superviz-icon>
        </button>
        <button id="confirm" class="comment-input--send-btn" disabled @click=${this.send}>
          <superviz-icon name="check" size="md"></superviz-icon>
        </button>
      `},i=()=>{if(!this.editable)return yt`
        <button class="comment-input--send-btn align-send-btn" disabled @click=${this.send}>
          <superviz-icon name="send" size="sm"></superviz-icon>
        </button>
      `};return yt`
      <div class="comment-input">
        <div id="comment-input--container">
          <textarea
            id="comment-input--textarea"
            placeholder="Add comment..."
            @input=${this.updateHeight}
          ></textarea>
        </div>
        <div class="sv-hr"></div>
        <div class="comment-input--options">
          <div>
            <button class="icon-button mention">
              <superviz-icon name="mention" size="sm"></superviz-icon>
            </button>
          </div>
          <div class="comment-input-options">
            ${i()} ${n()}
          </div>
        </div>
      </div>
    `}};_r.styles=xO,_r.properties={eventType:{type:String},text:{type:String},btnActive:{type:Boolean},editable:{type:Boolean}},_r=Ht([Wt("superviz-comments-comment-input")],_r);k();var Nm=$t(Mt),RO=[Nm.styles,Pl],Pr=class extends Nm{constructor(){super();this.position={x:0,y:0}}get userInitial(){var i,o,l;return(((l=(o=(i=this.annotation)==null?void 0:i.comments[0])==null?void 0:o.participant)==null?void 0:l.name)||"Anonymous")[0].toUpperCase()}emitClick(){document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:this.annotation.uuid}}))}render(){var i,o;let n={"annotation-pin":!0,"annotation-pin--active":this.active};return this.type==="add"?yt`
        <div
          class=${Ee(n)}
          style=${`top: ${this.position.y}px; left: ${this.position.x}px;`}
        >
          <div class="annotation-pin__avatar annotation-pin__avatar--add">
            <superviz-icon name="add"></superviz-icon>
          </div>
        </div>
      `:yt`
      <div
        @click=${this.emitClick}
        class=${Ee(n)}
        style=${`top: ${(i=this.position)==null?void 0:i.y}px; left: ${(o=this.position)==null?void 0:o.x}px;`}
      >
        <div class="annotation-pin__avatar">
          <p class="text text-bold text-big">${this.userInitial}</p>
          <!-- <img src="https://picsum.photos/200/300" alt="" /> -->
        </div>
      </div>
    `}};Pr.styles=RO,Pr.properties={type:{type:String},annotation:{type:Object},position:{type:Object},active:{type:Boolean}},Pr=Ht([Wt("superviz-comments-annotation-pin")],Pr);k();var Fm=$t(Mt),MO=[Fm.styles,Ml],Lr=class extends Fm{constructor(){super(...arguments);this.selectAnnotation=()=>{let{uuid:n}=this.annotation;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:n}}))}}firstUpdated(){this.resolved=this.annotation.resolved}updated(n){if(n.has("selected")){let i=this.selected===this.annotation.uuid;this.expandComments=i}}createComment({detail:n}){let{text:i}=n;this.emitEvent("create-comment",{uuid:this.annotation.uuid,text:i})}render(){var C,S,w,p,y,g,v;let n=this.annotationFilter==="all",i=this.annotationFilter==="resolved",o=(C=this.annotation.comments)==null?void 0:C.length,l=this.selected===this.annotation.uuid,c={"annotation-item":!0,"annotation-item--selected":l},u={hidden:this.resolved&&n||!this.resolved&&i},f={"sv-hr":!0,hidden:this.isLastAnnotation},m={"avatars-comments":!0,"comment-avatar--expand":!this.expandComments&&o>1,hidden:!(!this.expandComments&&o>1)},E={"comments-container":!0,"comment-item--expand":l&&this.expandComments,hidden:!(l&&this.expandComments)},O=({detail:h})=>{let{uuid:T}=this.annotation,{resolved:x,type:L}=h,z=L==="resolve-annotation"&&this.annotationFilter==="all";this.resolved=x,this.emitEvent("resolve-annotation",{uuid:T,resolved:x}),z&&(this.shouldShowUndoResolved=!0)},d=()=>{this.shouldShowUndoResolved=!1},A=()=>{let h=o>=5?5:o,T=o-1>5?"last-reply":"",x=o-1>1?"replies":"reply",L=[];for(let z=0;z<h;z++)L.push(yt`
          <div class="avatar avatar-divs-${z}">
            <img src="https://picsum.photos/200/300" />
          </div>
        `);return yt`
        ${L}
        <div class="avatar-divs-${h} replies ${T} text text-big sv-gray-500">
          ${o-1} ${x}
        </div>
      `},I=(h,T)=>T===0?yt``:yt`
        <superviz-comments-comment-item
          uuid=${h.uuid}
          avatar="https://picsum.photos/200/300"
          username=${h.participant.name||"Anonymous"}
          text=${h.text}
          createdAt=${h.createdAt}
        ></superviz-comments-comment-item>
      `;return yt`
      ${(()=>this.shouldShowUndoResolved?yt`
        <superviz-comments-annotation-resolved
          @undo-resolve=${O}
          @hide=${d}
          class=${Ee({hidden:i})}
        >
        </superviz-comments-annotation-resolved>
      `:yt``)()}

      <div class=${Ee(u)}>
        <div class=${Ee(c)} @click=${this.selectAnnotation}>
          <div>
            <superviz-comments-comment-item
              uuid=${(S=this.annotation.comments)==null?void 0:S[0].uuid}
              annotationId=${this.annotation.uuid}
              username=${((p=(w=this.annotation.comments)==null?void 0:w[0].participant)==null?void 0:p.name)||"Anonymous"}
              text=${(y=this.annotation.comments)==null?void 0:y[0].text}
              createdAt=${(g=this.annotation.comments)==null?void 0:g[0].createdAt}
              primaryComment
              resolvable
              ?resolved=${this.resolved}
              annotationFilter=${this.annotationFilter}
              @resolve-annotation=${O}
            ></superviz-comments-comment-item>

            <div class=${Ee(m)}>
              <div class="avatar-container">${A()}</div>
            </div>
          </div>

          <div class=${Ee(E)}>
            ${(v=this.annotation.comments)==null?void 0:v.map(I)}
            <superviz-comments-comment-input
              @create-comment=${this.createComment}
              eventType="create-comment"
            ></superviz-comments-comment-input>
          </div>
        </div>
        <div class=${Ee(f)}></div>
      </div>
    `}};Lr.styles=MO,Lr.properties={annotation:{type:Object},expandComments:{type:Boolean},selected:{type:String,reflect:!0},resolved:{type:Boolean},shouldShowUndoResolved:{type:Boolean},isLastAnnotation:{type:Boolean},annotationFilter:{type:String}},Lr=Ht([Wt("superviz-comments-annotation-item")],Lr);k();var Um=$t(Mt),_O=[Um.styles],Dr=class extends Um{constructor(){super(...arguments);this.emitEventOpenModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--open",{detail:{title:"DELETE COMMENT",body:yt`<span class="text text-big sv-gray-600">Are you sure you want to delete this comment? <br /> This action cannot be undone</span>`,confirmLabel:"DELETE",confirm:!0,cancel:!0},bubbles:!0,composed:!0}))};this.toggle=()=>{this.open=!this.open}}firstUpdated(){window.document.body.addEventListener("superviz-modal--close",()=>{!this.open||this.emitEvent("close",{},{bubbles:!1,composed:!1})}),window.document.body.addEventListener("superviz-modal--confirm",()=>{!this.open||(this.emitEvent("confirm",{},{bubbles:!1,composed:!1}),this.emitEventCloseModal())})}updated(n){n.has("open")&&(this.open&&setTimeout(()=>this.emitEventOpenModal()),this.open||setTimeout(()=>this.emitEventCloseModal()))}emitEventCloseModal(){!this.open||(window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{detail:{open:!0},bubbles:!0,composed:!0})),this.emitEvent("close",{},{bubbles:!1,composed:!1}))}render(){let n=()=>{if(!!this.useSlot)return yt`<slot name="modal-handler" @click=${this.toggle}></slot>`},i=()=>{if(!!this.open)return yt`
        <superviz-modal></superviz-modal>
      `};return yt`
      ${n()}
      ${i()}
    `}};Dr.styles=_O,Dr.properties={open:{type:Boolean},useSlot:{type:Boolean}},Dr=Ht([Wt("superviz-comments-delete-comments-modal")],Dr);k();var Bm=$t(Mt),PO=[Bm.styles,_l],LO=10*1e3,Nr=class extends Bm{constructor(){super();this.setTimer=()=>{clearTimeout(this.timeout),this.isCanceled=!1,this.timeout=setTimeout(()=>{this.isCanceled||(this.timeToHide=0,this.isCanceled=!1,this.hide())},this.timeToHide)};this.timeToHide=LO,this.isCanceled=!1}firstUpdated(){this.setTimer()}hide(){this.emitEvent("hide",{},{bubbles:!1,composed:!1})}undone(){this.isCanceled=!0,this.hide(),this.emitEvent("undo-resolve",{type:"undo-resolve",resolved:!1},{bubbles:!1,composed:!1}),clearTimeout(this.timeout)}render(){return this.timeToHide===0?yt``:this.isCanceled?yt``:yt`
      <div class="annotation-resolved">
        <span class="text text-big sv-gray-700">You resolve this comment</span>
        <button id="undone" @click=${this.undone} class="icon-button icon-button--clickable icon-button--medium">
          <superviz-icon name="undo" size="md"></superviz-icon>
        </button>
      </div>
    `}};Nr.styles=PO,Nr.properties={timeToHide:{type:Number},isCanceled:{type:Boolean}},Nr=Ht([Wt("superviz-comments-annotation-resolved")],Nr);k();var km=$t(Mt),DO=[km.styles,Ll],Uo=[{label:"All comments",code:"all"},{label:"Resolved comments",code:"resolved"}],Fr=class extends km{constructor(){super();this.caret="down"}render(){let n=this.filter==="all"?Uo[0].label:Uo[1].label,i=({detail:u})=>{this.emitEvent("select",{filter:u}),o()},o=()=>{this.caret=this.caret==="down"?"up":"down"},l=this.filter==="all"?Uo[0].code:Uo[1].code,c={text:!0,"text-bold":!0,"select-content":!0,"sv-gray-500":this.caret==="down","sv-gray-700":this.caret==="up"};return yt`
      <div class="select">
        <div class="select-container">
          <superviz-dropdown 
            options=${JSON.stringify(Uo)}
            active=${l}
            label="label"
            returnTo="code"
            position="bottom-left"
            right-offset="100px"
            @click=${o}
            @selected=${i}
            @close=${o}
          >
            <div class="content" slot="dropdown">
              <span class=${Ee(c)}>${n}</span>
              <superviz-icon name=${this.caret} size="md"></superviz-icon>
            </div>
          </superviz-dropdown>
        </div>
      </div>
    `}};Fr.styles=DO,Fr.properties={filter:{type:String},caret:{type:String}},Fr=Ht([Wt("superviz-comments-annotation-filter")],Fr);k();var Gm=$t(Mt),NO=[Gm.styles,Dl],Oi=class extends Gm{toggle(){this.emitEvent("toggle",{})}render(){return yt` <button @click=${this.toggle} class="float-button">
      <superviz-icon name="comment"></superviz-icon>

      <p class="text text-big text-bold">Comments</p>
    </button>`}};Oi.styles=NO,Oi=Ht([Wt("superviz-comments-button")],Oi);k();k();function Hm(s){if(typeof document!="undefined"){let t=document.createElement("style");t.id="superviz-style";let n=document.createTextNode(s);t.appendChild(n),document.head.appendChild(t)}}var Wm=`@import"https://unpkg.com/@superviz/sv-icons@0.8.7/css/style.css";html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:5}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}
`;Hm(Wm);k();k();k();k();window&&(window.SuperVizSdk={init:nl,MeetingEvent:zi,DeviceEvent:Fu,RealtimeEvent:fr,MeetingState:xs,MeetingConnectionStatus:Vi,MeetingControlsEvent:Is,ParticipantEvent:Rs,FrameEvent:$i,LayoutMode:Ds,VideoComponent:Qi,PresenceMouseComponent:Xi,Realtime:to,CommentsComponent:Ji});var kD=nl;export{qi as BrowserService,Fu as DeviceEvent,$i as FrameEvent,Ds as LayoutMode,Vi as MeetingConnectionStatus,Is as MeetingControlsEvent,zi as MeetingEvent,xs as MeetingState,xt as Observer,Rs as ParticipantEvent,Gs as ParticipantType,Ns as PinMode,fr as RealtimeEvent,kD as default};
/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.29
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2022 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
